"use strict";(self.webpackChunkspine=self.webpackChunkspine||[]).push([[3],{181:(t,e,i)=>{i.d(e,{v:()=>Le});class s{_image;constructor(t){this._image=t}getImage(){return this._image}static filterFromString(t){switch(t.toLowerCase()){case"nearest":return n.Nearest;case"linear":return n.Linear;case"mipmap":return n.MipMap;case"mipmapnearestnearest":return n.MipMapNearestNearest;case"mipmaplinearnearest":return n.MipMapLinearNearest;case"mipmapnearestlinear":return n.MipMapNearestLinear;case"mipmaplinearlinear":return n.MipMapLinearLinear;default:throw new Error(`Unknown texture filter ${t}`)}}static wrapFromString(t){switch(t.toLowerCase()){case"mirroredtepeat":return a.MirroredRepeat;case"clamptoedge":return a.ClampToEdge;case"repeat":return a.Repeat;default:throw new Error(`Unknown texture wrap ${t}`)}}}var n,a,r,o,l,h,c,d,u,m;!function(t){t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear"}(n||(n={})),function(t){t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat"}(a||(a={}));class g{renderObject;u=0;v=0;u2=0;v2=0;width=0;height=0;rotate=!1;offsetX=0;offsetY=0;originalWidth=0;originalHeight=0}class p extends s{setFilters(t,e){}setWraps(t,e){}dispose(){}}class f{pages=new Array;regions=new Array;constructor(t,e){this.load(t,e)}load(t,e){if(null==e)throw new Error("textureLoader cannot be null.");let i=new w(t),n=new Array(4),r=null;for(;;){let t=i.readLine();if(null==t)break;if(t=t.trim(),0==t.length)r=null;else if(r){let e=new b;e.name=t,e.page=r;let s=i.readValue();"true"==s.toLocaleLowerCase()?e.degrees=90:"false"==s.toLocaleLowerCase()?e.degrees=0:e.degrees=parseFloat(s),e.rotate=90==e.degrees,i.readTuple(n);let a=parseInt(n[0]),o=parseInt(n[1]);i.readTuple(n);let l=parseInt(n[0]),h=parseInt(n[1]);e.u=a/r.width,e.v=o/r.height,e.rotate?(e.u2=(a+h)/r.width,e.v2=(o+l)/r.height):(e.u2=(a+l)/r.width,e.v2=(o+h)/r.height),e.x=a,e.y=o,e.width=Math.abs(l),e.height=Math.abs(h),4==i.readTuple(n)&&4==i.readTuple(n)&&i.readTuple(n),e.originalWidth=parseInt(n[0]),e.originalHeight=parseInt(n[1]),i.readTuple(n),e.offsetX=parseInt(n[0]),e.offsetY=parseInt(n[1]),e.index=parseInt(i.readValue()),e.texture=r.texture,this.regions.push(e)}else{r=new x,r.name=t,2==i.readTuple(n)&&(r.width=parseInt(n[0]),r.height=parseInt(n[1]),i.readTuple(n)),i.readTuple(n),r.minFilter=s.filterFromString(n[0]),r.magFilter=s.filterFromString(n[1]);let o=i.readValue();r.uWrap=a.ClampToEdge,r.vWrap=a.ClampToEdge,"x"==o?r.uWrap=a.Repeat:"y"==o?r.vWrap=a.Repeat:"xy"==o&&(r.uWrap=r.vWrap=a.Repeat),r.texture=e(t),r.texture.setFilters(r.minFilter,r.magFilter),r.texture.setWraps(r.uWrap,r.vWrap),r.width=r.texture.getImage().width,r.height=r.texture.getImage().height,this.pages.push(r)}}}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}dispose(){for(let t=0;t<this.pages.length;t++)this.pages[t].texture.dispose()}}class w{lines;index=0;constructor(t){this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readValue(){let t=this.readLine(),e=t.indexOf(":");if(-1==e)throw new Error("Invalid line: "+t);return t.substring(e+1).trim()}readTuple(t){let e=this.readLine(),i=e.indexOf(":");if(-1==i)throw new Error("Invalid line: "+e);let s=0,n=i+1;for(;s<3;s++){let i=e.indexOf(",",n);if(-1==i)break;t[s]=e.substr(n,i-n).trim(),n=i+1}return t[s]=e.substring(n).trim(),s+1}}class x{name;minFilter;magFilter;uWrap;vWrap;texture;width;height}class b extends g{page;name;x;y;index;degrees;texture}class y{pathPrefix;textureLoader;assets={};errors={};toLoad=0;loaded=0;rawDataUris={};constructor(t,e=""){this.textureLoader=t,this.pathPrefix=e}encodePath(t){let e=t.split("/");for(let t=0;t<e.length;t++)e[t]=encodeURIComponent(e[t]);return e.join("/")}downloadText(t,e,i){if(this.rawDataUris[t]){let i=this.rawDataUris[t],s=atob(i);return void e(s)}let s=new XMLHttpRequest;s.overrideMimeType("text/html"),s.open("GET",this.encodePath(t),!0),s.onload=()=>{200==s.status?0==s.responseText.length?i(s.status,s.responseText):e(s.responseText):i(s.status,s.responseText)},s.onerror=()=>{i(s.status,s.responseText)},s.send()}base64ToArrayBuffer(t){for(var e=atob(t),i=new Uint8Array(e.length),s=0;s<e.length;s++)i[s]=e.charCodeAt(s);return i}downloadBinary(t,e,i){if(this.rawDataUris[t]){let i=this.rawDataUris[t],s=this.base64ToArrayBuffer(i);return console.log(t,i),void e(s)}let s=new XMLHttpRequest;s.open("GET",this.encodePath(t),!0),s.responseType="arraybuffer",s.onload=()=>{200==s.status?null==s.response?i(s.status,s.responseText):e(new Uint8Array(s.response)):i(s.status,s.response)},s.onerror=()=>{i(s.status,s.response)},s.send()}setRawDataURI(t,e){this.rawDataUris[this.pathPrefix+t]=e}loadBinary(t,e=null,i=null){t=this.pathPrefix+t,this.toLoad++,this.downloadBinary(t,(i=>{this.assets[t]=i,e&&e(t,i),this.toLoad--,this.loaded++}),((e,s)=>{this.errors[t]=`Couldn't load binary ${t}: status ${status}, ${s}`,i&&i(t,`Couldn't load binary ${t}: status ${status}, ${s}`),this.toLoad--,this.loaded++}))}loadText(t,e=null,i=null){t=this.pathPrefix+t,this.toLoad++,this.downloadText(t,(i=>{this.assets[t]=i,e&&e(t,i),this.toLoad--,this.loaded++}),((e,s)=>{this.errors[t]=`Couldn't load text ${t}: status ${status}, ${s}`,i&&i(t,`Couldn't load text ${t}: status ${status}, ${s}`),this.toLoad--,this.loaded++}))}loadTexture(t,e=null,i=null){let s=t=this.pathPrefix+t;this.toLoad++;let n=new Image;if(n.crossOrigin="anonymous",n.onload=i=>{let a=this.textureLoader(n);this.assets[s]=a,this.toLoad--,this.loaded++,e&&e(t,n)},n.onerror=e=>{this.errors[t]=`Couldn't load image ${t}`,this.toLoad--,this.loaded++,i&&i(t,`Couldn't load image ${t}`)},this.rawDataUris[t]){let e=this.rawDataUris[t];n.src="data:image/png;base64,"+e}else n.src=this.encodePath(t)}loadTextureAtlas(t,e=null,i=null){let s=t.lastIndexOf("/")>=0?t.substring(0,t.lastIndexOf("/")):"";t=this.pathPrefix+t,this.toLoad++,this.downloadText(t,(n=>{let a={count:0},r=new Array;try{new f(n,(t=>{r.push(""==s?t:s+"/"+t);let e=document.createElement("img");return e.width=16,e.height=16,new p(e)}))}catch(e){let s=e;return this.errors[t]=`Couldn't load texture atlas ${t}: ${s.message}`,i&&i(t,`Couldn't load texture atlas ${t}: ${s.message}`),this.toLoad--,void this.loaded++}for(let o of r){let l=!1;this.loadTexture(o,((o,h)=>{if(a.count++,a.count==r.length)if(l)this.errors[t]=`Couldn't load texture atlas page ${o}} of atlas ${t}`,i&&i(t,`Couldn't load texture atlas page ${o} of atlas ${t}`),this.toLoad--,this.loaded++;else try{let i=new f(n,(t=>this.get(""==s?t:s+"/"+t)));this.assets[t]=i,e&&e(t,i),this.toLoad--,this.loaded++}catch(e){let s=e;this.errors[t]=`Couldn't load texture atlas ${t}: ${s.message}`,i&&i(t,`Couldn't load texture atlas ${t}: ${s.message}`),this.toLoad--,this.loaded++}}),((e,s)=>{l=!0,a.count++,a.count==r.length&&(this.errors[t]=`Couldn't load texture atlas page ${e}} of atlas ${t}`,i&&i(t,`Couldn't load texture atlas page ${e} of atlas ${t}`),this.toLoad--,this.loaded++)}))}}),((e,s)=>{this.errors[t]=`Couldn't load texture atlas ${t}: status ${status}, ${s}`,i&&i(t,`Couldn't load texture atlas ${t}: status ${status}, ${s}`),this.toLoad--,this.loaded++}))}get(t){return t=this.pathPrefix+t,this.assets[t]}remove(t){t=this.pathPrefix+t;let e=this.assets[t];e.dispose&&e.dispose(),this.assets[t]=null}removeAll(){for(let t in this.assets){let e=this.assets[t];e.dispose&&e.dispose()}this.assets={}}isLoadingComplete(){return 0==this.toLoad}getToLoad(){return this.toLoad}getLoaded(){return this.loaded}dispose(){this.removeAll()}hasErrors(){return Object.keys(this.errors).length>0}getErrors(){return this.errors}clearErrors(){this.errors={}}}!function(t){t[t.Normal=0]="Normal",t[t.Additive=1]="Additive",t[t.Multiply=2]="Multiply",t[t.Screen=3]="Screen"}(r||(r={}));class v{canvas;gl;restorables=new Array;constructor(t,e={alpha:"true"}){if(t instanceof HTMLCanvasElement){let i=t;this.gl=i.getContext("webgl2",e)||i.getContext("webgl",e),this.canvas=i,i.addEventListener("webglcontextlost",(t=>{t&&t.preventDefault()})),i.addEventListener("webglcontextrestored",(t=>{for(let t=0,e=this.restorables.length;t<e;t++)this.restorables[t].restore()}))}else this.gl=t,this.canvas=this.gl.canvas}addRestorable(t){this.restorables.push(t)}removeRestorable(t){let e=this.restorables.indexOf(t);e>-1&&this.restorables.splice(e,1)}}class A{static ZERO=0;static ONE=1;static SRC_COLOR=768;static ONE_MINUS_SRC_COLOR=769;static SRC_ALPHA=770;static ONE_MINUS_SRC_ALPHA=771;static DST_ALPHA=772;static ONE_MINUS_DST_ALPHA=773;static DST_COLOR=774;static getDestGLBlendMode(t){switch(t){case r.Normal:return A.ONE_MINUS_SRC_ALPHA;case r.Additive:return A.ONE;case r.Multiply:case r.Screen:return A.ONE_MINUS_SRC_ALPHA;default:throw new Error("Unknown blend mode: "+t)}}static getSourceGLBlendMode(t,e=!1){switch(t){case r.Normal:case r.Additive:return e?A.ONE:A.SRC_ALPHA;case r.Multiply:return A.DST_COLOR;case r.Screen:return A.ONE;default:throw new Error("Unknown blend mode: "+t)}}}class E extends s{context;texture=null;boundUnit=0;useMipMaps=!1;static DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL=!1;constructor(t,e,i=!1){super(e),this.context=t instanceof v?t:new v(t),this.useMipMaps=i,this.restore(),this.context.addRestorable(this)}setFilters(t,e){let i=this.context.gl;this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,E.validateMagFilter(e))}static validateMagFilter(t){switch(t){case n.MipMap:case n.MipMapLinearLinear:case n.MipMapLinearNearest:case n.MipMapNearestLinear:case n.MipMapNearestNearest:return n.Linear;default:return t}}setWraps(t,e){let i=this.context.gl;this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e)}update(t){let e=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),E.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._image),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t&&e.generateMipmap(e.TEXTURE_2D)}restore(){this.texture=null,this.update(this.useMipMaps)}bind(t=0){let e=this.context.gl;this.boundUnit=t,e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)}unbind(){let t=this.context.gl;t.activeTexture(t.TEXTURE0+this.boundUnit),t.bindTexture(t.TEXTURE_2D,null)}dispose(){this.context.removeRestorable(this),this.context.gl.deleteTexture(this.texture)}}class M extends y{constructor(t,e=""){super((e=>new E(t,e)),e)}}class S{array=new Array;add(t){let e=this.contains(t);return this.array[0|t]=0|t,!e}contains(t){return null!=this.array[0|t]}remove(t){this.array[0|t]=void 0}clear(){this.array.length=0}}class R{r;g;b;a;static WHITE=new R(1,1,1,1);static RED=new R(1,0,0,1);static GREEN=new R(0,1,0,1);static BLUE=new R(0,0,1,1);static MAGENTA=new R(1,0,1,1);static ORANGE=new R(1,.5,.1,1);constructor(t=0,e=0,i=0,s=0){this.r=t,this.g=e,this.b=i,this.a=s}set(t,e,i,s){return this.r=t,this.g=e,this.b=i,this.a=s,this.clamp(),this}setFromColor(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}setFromString(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=(8!=t.length?255:parseInt(t.substr(6,2),16))/255,this}add(t,e,i,s){return this.r+=t,this.g+=e,this.b+=i,this.a+=s,this.clamp(),this}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}static rgb888ToColor(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}}class I{static PI=3.1415927;static PI2=2*I.PI;static radiansToDegrees=180/I.PI;static radDeg=I.radiansToDegrees;static degreesToRadians=I.PI/180;static degRad=I.degreesToRadians;static clamp(t,e,i){return t<e?e:t>i?i:t}static cosDeg(t){return Math.cos(t*I.degRad)}static sinDeg(t){return Math.sin(t*I.degRad)}static signum(t){return t>0?1:t<0?-1:0}static toInt(t){return t>0?Math.floor(t):Math.ceil(t)}static cbrt(t){let e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}static randomTriangular(t,e){return I.randomTriangularWith(t,e,.5*(t+e))}static randomTriangularWith(t,e,i){let s=Math.random(),n=e-t;return s<=(i-t)/n?t+Math.sqrt(s*n*(i-t)):e-Math.sqrt((1-s)*n*(e-i))}}class T{static SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array;static arrayCopy(t,e,i,s,n){for(let a=e,r=s;a<e+n;a++,r++)i[r]=t[a]}static setArraySize(t,e,i=0){let s=t.length;if(s==e)return t;if(t.length=e,s<e)for(let n=s;n<e;n++)t[n]=i;return t}static ensureArrayCapacity(t,e,i=0){return t.length>=e?t:T.setArraySize(t,e,i)}static newArray(t,e){let i=new Array(t);for(let s=0;s<t;s++)i[s]=e;return i}static newFloatArray(t){if(T.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);{let e=new Array(t);for(let t=0;t<e.length;t++)e[t]=0;return e}}static newShortArray(t){if(T.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);{let e=new Array(t);for(let t=0;t<e.length;t++)e[t]=0;return e}}static toFloatArray(t){return T.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t}static toSinglePrecision(t){return T.SUPPORTS_TYPED_ARRAYS?Math.fround(t):t}static webkit602BugfixHelper(t,e){}static contains(t,e,i=!0){for(var s=0;s<t.length;s++)if(t[s]==e)return!0;return!1}}class C{items=new Array;instantiator;constructor(t){this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)t[e].reset&&t[e].reset(),this.items[e]=t[e]}clear(){this.items.length=0}}class P{x;y;constructor(t=0,e=0){this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){let t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}subtract(t){return new P(this.x-t.x,this.y-t.y)}normalize(){let t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this}normalize_new(){let t=this.length();return new P(this.x/t,this.y/t)}angle(t){let e=this.x*t.x+this.y*t.y,i=Math.sqrt(this.x*this.x+this.y*this.y),s=Math.sqrt(t.x*t.x+t.y*t.y);return Math.acos(e/(i*s))}}class k{maxDelta=.064;framesPerSecond=0;delta=0;totalTime=0;lastTime=Date.now()/1e3;frameCount=0;frameTime=0;update(){let t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)}}class V{name;constructor(t){if(null==t)throw new Error("name cannot be null.");this.name=t}}class N extends V{static nextID=0;id=(65535&N.nextID++)<<11;bones;vertices;worldVerticesLength=0;deformAttachment=this;constructor(t){super(t)}computeWorldVertices(t,e,i,s,n,a){i=n+(i>>1)*a;let r=t.bone.skeleton,o=t.deform,l=this.vertices,h=this.bones;if(null==h){o.length>0&&(l=o);let r=t.bone,h=r.worldX,c=r.worldY,d=r.a,u=r.b,m=r.c,g=r.d;for(let t=e,r=n;r<i;t+=2,r+=a){let e=l[t],i=l[t+1];s[r]=e*d+i*u+h,s[r+1]=e*m+i*g+c}return}let c=0,d=0;for(let t=0;t<e;t+=2){let t=h[c];c+=t+1,d+=t}let u=r.bones;if(0==o.length)for(let t=n,e=3*d;t<i;t+=a){let i=0,n=0,a=h[c++];for(a+=c;c<a;c++,e+=3){let t=u[h[c]],s=l[e],a=l[e+1],r=l[e+2];i+=(s*t.a+a*t.b+t.worldX)*r,n+=(s*t.c+a*t.d+t.worldY)*r}s[t]=i,s[t+1]=n}else{let t=o;for(let e=n,r=3*d,o=d<<1;e<i;e+=a){let i=0,n=0,a=h[c++];for(a+=c;c<a;c++,r+=3,o+=2){let e=u[h[c]],s=l[r]+t[o],a=l[r+1]+t[o+1],d=l[r+2];i+=(s*e.a+a*e.b+e.worldX)*d,n+=(s*e.c+a*e.d+e.worldY)*d}s[e]=i,s[e+1]=n}}}copyTo(t){null!=this.bones?(t.bones=new Array(this.bones.length),T.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,null!=this.vertices?(t.vertices=T.newFloatArray(this.vertices.length),T.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)):t.vertices=null,t.worldVerticesLength=this.worldVerticesLength,t.deformAttachment=this.deformAttachment}}class L extends N{color=new R(1,1,1,1);constructor(t){super(t)}copy(){let t=new L(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}class O extends N{endSlot;color=new R(.2275,.2275,.8078,1);constructor(t){super(t)}copy(){let t=new O(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}class Y extends N{region;path;regionUVs;uvs;triangles;color=new R(1,1,1,1);width;height;hullLength;edges;parentMesh;tempColor=new R(0,0,0,0);constructor(t){super(t)}updateUVs(){let t=this.regionUVs;null!=this.uvs&&this.uvs.length==t.length||(this.uvs=T.newFloatArray(t.length));let e=this.uvs,i=this.uvs.length,s=this.region.u,n=this.region.v,a=0,r=0;if(this.region instanceof b){let o=this.region,l=o.texture.getImage().width,h=o.texture.getImage().height;switch(o.degrees){case 90:s-=(o.originalHeight-o.offsetY-o.height)/l,n-=(o.originalWidth-o.offsetX-o.width)/h,a=o.originalHeight/l,r=o.originalWidth/h;for(let o=0;o<i;o+=2)e[o]=s+t[o+1]*a,e[o+1]=n+(1-t[o])*r;return;case 180:s-=(o.originalWidth-o.offsetX-o.width)/l,n-=o.offsetY/h,a=o.originalWidth/l,r=o.originalHeight/h;for(let o=0;o<i;o+=2)e[o]=s+(1-t[o])*a,e[o+1]=n+(1-t[o+1])*r;return;case 270:s-=o.offsetY/l,n-=o.offsetX/h,a=o.originalHeight/l,r=o.originalWidth/h;for(let o=0;o<i;o+=2)e[o]=s+(1-t[o+1])*a,e[o+1]=n+t[o]*r;return}s-=o.offsetX/l,n-=(o.originalHeight-o.offsetY-o.height)/h,a=o.originalWidth/l,r=o.originalHeight/h}else null==this.region?(s=n=0,a=r=1):(a=this.region.u2-s,r=this.region.v2-n);for(let o=0;o<i;o+=2)e[o]=s+t[o]*a,e[o+1]=n+t[o+1]*r}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,null!=t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(null!=this.parentMesh)return this.newLinkedMesh();let t=new Y(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Array(this.regionUVs.length),T.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.uvs=new Array(this.uvs.length),T.arrayCopy(this.uvs,0,t.uvs,0,this.uvs.length),t.triangles=new Array(this.triangles.length),T.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,null!=this.edges&&(t.edges=new Array(this.edges.length),T.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}newLinkedMesh(){let t=new Y(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),t.deformAttachment=this.deformAttachment,t.setParentMesh(null!=this.parentMesh?this.parentMesh:this),t.updateUVs(),t}}class D extends N{lengths;closed=!1;constantSpeed=!1;color=new R(1,1,1,1);constructor(t){super(t)}copy(){let t=new D(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),T.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}class F extends N{x;y;rotation;color=new R(.38,.94,0,1);constructor(t){super(t)}computeWorldPosition(t,e){return e.x=this.x*t.a+this.y*t.b+t.worldX,e.y=this.x*t.c+this.y*t.d+t.worldY,e}computeWorldRotation(t){let e=I.cosDeg(this.rotation),i=I.sinDeg(this.rotation),s=e*t.a+i*t.b,n=e*t.c+i*t.d;return Math.atan2(n,s)*I.radDeg}copy(){let t=new F(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}class B extends V{static OX1=0;static OY1=1;static OX2=2;static OY2=3;static OX3=4;static OY3=5;static OX4=6;static OY4=7;static X1=0;static Y1=1;static C1R=2;static C1G=3;static C1B=4;static C1A=5;static U1=6;static V1=7;static X2=8;static Y2=9;static C2R=10;static C2G=11;static C2B=12;static C2A=13;static U2=14;static V2=15;static X3=16;static Y3=17;static C3R=18;static C3G=19;static C3B=20;static C3A=21;static U3=22;static V3=23;static X4=24;static Y4=25;static C4R=26;static C4G=27;static C4B=28;static C4A=29;static U4=30;static V4=31;x=0;y=0;scaleX=1;scaleY=1;rotation=0;width=0;height=0;color=new R(1,1,1,1);path;rendererObject;region;offset=T.newFloatArray(8);uvs=T.newFloatArray(8);tempColor=new R(1,1,1,1);constructor(t){super(t)}updateOffset(){let t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.region.offsetX*t,s=-this.height/2*this.scaleY+this.region.offsetY*e,n=i+this.region.width*t,a=s+this.region.height*e,r=this.rotation*Math.PI/180,o=Math.cos(r),l=Math.sin(r),h=i*o+this.x,c=i*l,d=s*o+this.y,u=s*l,m=n*o+this.x,g=n*l,p=a*o+this.y,f=a*l,w=this.offset;w[B.OX1]=h-u,w[B.OY1]=d+c,w[B.OX2]=h-f,w[B.OY2]=p+c,w[B.OX3]=m-f,w[B.OY3]=p+g,w[B.OX4]=m-u,w[B.OY4]=d+g}setRegion(t){this.region=t;let e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}computeWorldVertices(t,e,i,s){let n=this.offset,a=t.worldX,r=t.worldY,o=t.a,l=t.b,h=t.c,c=t.d,d=0,u=0;d=n[B.OX1],u=n[B.OY1],e[i]=d*o+u*l+a,e[i+1]=d*h+u*c+r,i+=s,d=n[B.OX2],u=n[B.OY2],e[i]=d*o+u*l+a,e[i+1]=d*h+u*c+r,i+=s,d=n[B.OX3],u=n[B.OY3],e[i]=d*o+u*l+a,e[i+1]=d*h+u*c+r,i+=s,d=n[B.OX4],u=n[B.OY4],e[i]=d*o+u*l+a,e[i+1]=d*h+u*c+r}copy(){let t=new B(this.name);return t.region=this.region,t.rendererObject=this.rendererObject,t.path=this.path,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,T.arrayCopy(this.uvs,0,t.uvs,0,8),T.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t}}class X{atlas;constructor(t){this.atlas=t}newRegionAttachment(t,e,i){let s=this.atlas.findRegion(i);if(null==s)throw new Error("Region not found in atlas: "+i+" (region attachment: "+e+")");s.renderObject=s;let n=new B(e);return n.setRegion(s),n}newMeshAttachment(t,e,i){let s=this.atlas.findRegion(i);if(null==s)throw new Error("Region not found in atlas: "+i+" (mesh attachment: "+e+")");s.renderObject=s;let n=new Y(e);return n.region=s,n}newBoundingBoxAttachment(t,e){return new L(e)}newPathAttachment(t,e){return new D(e)}newPointAttachment(t,e){return new F(e)}newClippingAttachment(t,e){return new O(e)}}class _{index;name;parent;length;x=0;y=0;rotation=0;scaleX=1;scaleY=1;shearX=0;shearY=0;transformMode=o.Normal;skinRequired=!1;color=new R;constructor(t,e,i){if(t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=i}}!function(t){t[t.Normal=0]="Normal",t[t.OnlyTranslation=1]="OnlyTranslation",t[t.NoRotationOrReflection=2]="NoRotationOrReflection",t[t.NoScale=3]="NoScale",t[t.NoScaleOrReflection=4]="NoScaleOrReflection"}(o||(o={}));class W{data;skeleton;parent;children=new Array;x=0;y=0;rotation=0;scaleX=0;scaleY=0;shearX=0;shearY=0;ax=0;ay=0;arotation=0;ascaleX=0;ascaleY=0;ashearX=0;ashearY=0;appliedValid=!1;a=0;b=0;c=0;d=0;worldY=0;worldX=0;sorted=!1;active=!1;constructor(t,e,i){if(null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()}isActive(){return this.active}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,i,s,n,a,r){this.ax=t,this.ay=e,this.arotation=i,this.ascaleX=s,this.ascaleY=n,this.ashearX=a,this.ashearY=r,this.appliedValid=!0;let l=this.parent;if(null==l){let o=this.skeleton,l=i+90+r,h=o.scaleX,c=o.scaleY;return this.a=I.cosDeg(i+a)*s*h,this.b=I.cosDeg(l)*n*h,this.c=I.sinDeg(i+a)*s*c,this.d=I.sinDeg(l)*n*c,this.worldX=t*h+o.x,void(this.worldY=e*c+o.y)}let h=l.a,c=l.b,d=l.c,u=l.d;switch(this.worldX=h*t+c*e+l.worldX,this.worldY=d*t+u*e+l.worldY,this.data.transformMode){case o.Normal:{let t=i+90+r,e=I.cosDeg(i+a)*s,o=I.cosDeg(t)*n,l=I.sinDeg(i+a)*s,m=I.sinDeg(t)*n;return this.a=h*e+c*l,this.b=h*o+c*m,this.c=d*e+u*l,void(this.d=d*o+u*m)}case o.OnlyTranslation:{let t=i+90+r;this.a=I.cosDeg(i+a)*s,this.b=I.cosDeg(t)*n,this.c=I.sinDeg(i+a)*s,this.d=I.sinDeg(t)*n;break}case o.NoRotationOrReflection:{let t=h*h+d*d,e=0;t>1e-4?(t=Math.abs(h*u-c*d)/t,c=d*t,u=h*t,e=Math.atan2(d,h)*I.radDeg):(h=0,d=0,e=90-Math.atan2(u,c)*I.radDeg);let o=i+a-e,l=i+r-e+90,m=I.cosDeg(o)*s,g=I.cosDeg(l)*n,p=I.sinDeg(o)*s,f=I.sinDeg(l)*n;return this.a=h*m-c*p,this.b=h*g-c*f,this.c=d*m+u*p,this.d=d*g+u*f,this.a*=Math.sign(this.skeleton.scaleX),this.b*=Math.sign(this.skeleton.scaleX),this.c*=Math.sign(this.skeleton.scaleY),void(this.d*=Math.sign(this.skeleton.scaleY))}case o.NoScale:case o.NoScaleOrReflection:{let t=I.cosDeg(i),e=I.sinDeg(i),l=(h*t+c*e)/this.skeleton.scaleX,m=(d*t+u*e)/this.skeleton.scaleY,g=Math.sqrt(l*l+m*m);g>1e-5&&(g=1/g),l*=g,m*=g,g=Math.sqrt(l*l+m*m),this.data.transformMode==o.NoScale&&h*u-c*d<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(g=-g);let p=Math.PI/2+Math.atan2(m,l),f=Math.cos(p)*g,w=Math.sin(p)*g,x=I.cosDeg(a)*s,b=I.cosDeg(90+r)*n,y=I.sinDeg(a)*s,v=I.sinDeg(90+r)*n;this.a=l*x+f*y,this.b=l*b+f*v,this.c=m*x+w*y,this.d=m*b+w*v;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.c,this.a)*I.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*I.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}updateAppliedTransform(){this.appliedValid=!0;let t=this.parent;if(null==t)return this.ax=this.worldX,this.ay=this.worldY,this.arotation=Math.atan2(this.c,this.a)*I.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*I.radDeg);let e=t.a,i=t.b,s=t.c,n=t.d,a=1/(e*n-i*s),r=this.worldX-t.worldX,o=this.worldY-t.worldY;this.ax=r*n*a-o*i*a,this.ay=o*e*a-r*s*a;let l=a*n,h=a*e,c=a*i,d=a*s,u=l*this.a-c*this.c,m=l*this.b-c*this.d,g=h*this.c-d*this.a,p=h*this.d-d*this.b;if(this.ashearX=0,this.ascaleX=Math.sqrt(u*u+g*g),this.ascaleX>1e-4){let t=u*p-m*g;this.ascaleY=t/this.ascaleX,this.ashearY=Math.atan2(u*m+g*p,t)*I.radDeg,this.arotation=Math.atan2(g,u)*I.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(m*m+p*p),this.ashearY=0,this.arotation=90-Math.atan2(p,m)*I.radDeg}worldToLocal(t){let e=this.a,i=this.b,s=this.c,n=this.d,a=1/(e*n-i*s),r=t.x-this.worldX,o=t.y-this.worldY;return t.x=r*n*a-o*i*a,t.y=o*e*a-r*s*a,t}localToWorld(t){let e=t.x,i=t.y;return t.x=e*this.a+i*this.b+this.worldX,t.y=e*this.c+i*this.d+this.worldY,t}worldToLocalRotation(t){let e=I.sinDeg(t),i=I.cosDeg(t);return Math.atan2(this.a*e-this.c*i,this.d*i-this.b*e)*I.radDeg+this.rotation-this.shearX}localToWorldRotation(t){t-=this.rotation-this.shearX;let e=I.sinDeg(t),i=I.cosDeg(t);return Math.atan2(i*this.c+e*this.d,i*this.a+e*this.b)*I.radDeg}rotateWorld(t){let e=this.a,i=this.b,s=this.c,n=this.d,a=I.cosDeg(t),r=I.sinDeg(t);this.a=a*e-r*s,this.b=a*i-r*n,this.c=r*e+a*s,this.d=r*i+a*n,this.appliedValid=!1}}class U{data;bones;target;bendDirection=0;compress=!1;stretch=!1;mix=1;softness=0;active=!1;constructor(t,e){if(null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){let t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix)}}apply1(t,e,i,s,n,a,r){t.appliedValid||t.updateAppliedTransform();let l=t.parent,h=l.a,c=l.b,d=l.c,u=l.d,m=-t.ashearX-t.arotation,g=0,p=0;switch(t.data.transformMode){case o.OnlyTranslation:g=e-t.worldX,p=i-t.worldY;break;case o.NoRotationOrReflection:m+=Math.atan2(d,h)*I.radDeg;let s=Math.abs(h*u-c*d)/(h*h+d*d);c=-d*s,u=h*s;default:let n=e-l.worldX,a=i-l.worldY,r=h*u-c*d;g=(n*u-a*c)/r-t.ax,p=(a*h-n*d)/r-t.ay}m+=Math.atan2(p,g)*I.radDeg,t.ascaleX<0&&(m+=180),m>180?m-=360:m<-180&&(m+=360);let f=t.ascaleX,w=t.ascaleY;if(s||n){switch(t.data.transformMode){case o.NoScale:case o.NoScaleOrReflection:g=e-t.worldX,p=i-t.worldY}let l=t.data.length*f,h=Math.sqrt(g*g+p*p);if(s&&h<l||n&&h>l&&l>1e-4){let t=(h/l-1)*r+1;f*=t,a&&(w*=t)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+m*r,f,w,t.ashearX,t.ashearY)}apply2(t,e,i,s,n,a,r,o){if(0==o)return void e.updateWorldTransform();t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();let l=t.ax,h=t.ay,c=t.ascaleX,d=c,u=t.ascaleY,m=e.ascaleX,g=0,p=0,f=0;c<0?(c=-c,g=180,f=-1):(g=0,f=1),u<0&&(u=-u,f=-f),m<0?(m=-m,p=180):p=0;let w=e.ax,x=0,b=0,y=0,v=t.a,A=t.b,E=t.c,M=t.d,S=Math.abs(c-u)<=1e-4;S?(x=e.ay,b=v*w+A*x+t.worldX,y=E*w+M*x+t.worldY):(x=0,b=v*w+t.worldX,y=E*w+t.worldY);let R=t.parent;v=R.a,A=R.b,E=R.c,M=R.d;let T,C,P=1/(v*M-A*E),k=b-R.worldX,V=y-R.worldY,N=(k*M-V*A)*P-l,L=(V*v-k*E)*P-h,O=Math.sqrt(N*N+L*L),Y=e.data.length*m;if(O<1e-4)return this.apply1(t,i,s,!1,a,!1,o),void e.updateWorldTransformWith(w,x,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);k=i-R.worldX,V=s-R.worldY;let D=(k*M-V*A)*P-l,F=(V*v-k*E)*P-h,B=D*D+F*F;if(0!=r){r*=c*(m+1)/2;let t=Math.sqrt(B),e=t-O-Y*c+r;if(e>0){let i=Math.min(1,e/(2*r))-1;i=(e-r*(1-i*i))/t,D-=i*D,F-=i*F,B=D*D+F*F}}t:if(S){Y*=c;let t=(B-O*O-Y*Y)/(2*O*Y);t<-1?t=-1:t>1&&(t=1,a&&(d*=(Math.sqrt(B)/(O+Y)-1)*o+1)),C=Math.acos(t)*n,v=O+Y*t,A=Y*Math.sin(C),T=Math.atan2(F*v-D*A,D*v+F*A)}else{v=c*Y,A=u*Y;let t=v*v,e=A*A,i=Math.atan2(F,D);E=e*O*O+t*B-t*e;let s=-2*e*O,a=e-t;if(M=s*s-4*a*E,M>=0){let t=Math.sqrt(M);s<0&&(t=-t),t=-(s+t)/2;let e=t/a,r=E/t,o=Math.abs(e)<Math.abs(r)?e:r;if(o*o<=B){V=Math.sqrt(B-o*o)*n,T=i-Math.atan2(V,o),C=Math.atan2(V/u,(o-O)/c);break t}}let r=I.PI,o=O-v,l=o*o,h=0,d=0,m=O+v,g=m*m,p=0;E=-v*O/(t-e),E>=-1&&E<=1&&(E=Math.acos(E),k=v*Math.cos(E)+O,V=A*Math.sin(E),M=k*k+V*V,M<l&&(r=E,l=M,o=k,h=V),M>g&&(d=E,g=M,m=k,p=V)),B<=(l+g)/2?(T=i-Math.atan2(h*n,o),C=r*n):(T=i-Math.atan2(p*n,m),C=d*n)}let X=Math.atan2(x,w)*f,_=t.arotation;T=(T-X)*I.radDeg+g-_,T>180?T-=360:T<-180&&(T+=360),t.updateWorldTransformWith(l,h,_+T*o,d,t.ascaleY,0,0),_=e.arotation,C=((C+X)*I.radDeg-e.ashearX)*f+p-_,C>180?C-=360:C<-180&&(C+=360),e.updateWorldTransformWith(w,x,_+C*o,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class G{name;order;skinRequired;constructor(t,e,i){this.name=t,this.order=e,this.skinRequired=i}}class Z extends G{bones=new Array;target;positionMode;spacingMode;rotateMode;offsetRotation;position;spacing;rotateMix;translateMix;constructor(t){super(t,0,!1)}}!function(t){t[t.Fixed=0]="Fixed",t[t.Percent=1]="Percent"}(l||(l={})),function(t){t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent"}(h||(h={})),function(t){t[t.Tangent=0]="Tangent",t[t.Chain=1]="Chain",t[t.ChainScale=2]="ChainScale"}(c||(c={}));class z{static NONE=-1;static BEFORE=-2;static AFTER=-3;static epsilon=1e-5;data;bones;target;position=0;spacing=0;rotateMix=0;translateMix=0;spaces=new Array;positions=new Array;world=new Array;curves=new Array;lengths=new Array;segments=new Array;active=!1;constructor(t,e){if(null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let i=0,s=t.bones.length;i<s;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}isActive(){return this.active}apply(){this.update()}update(){let t=this.target.getAttachment();if(!(t instanceof D))return;let e=this.rotateMix,i=this.translateMix,s=e>0;if(!(i>0||s))return;let n=this.data,a=n.spacingMode==h.Percent,r=n.rotateMode,o=r==c.Tangent,d=r==c.ChainScale,u=this.bones.length,m=o?u:u+1,g=this.bones,p=T.setArraySize(this.spaces,m),f=null,w=this.spacing;if(d||!a){d&&(f=T.setArraySize(this.lengths,u));let t=n.spacingMode==h.Length;for(let e=0,i=m-1;e<i;){let i=g[e],s=i.data.length;if(s<z.epsilon)d&&(f[e]=0),p[++e]=0;else if(a){if(d){let t=s*i.a,n=s*i.c,a=Math.sqrt(t*t+n*n);f[e]=a}p[++e]=w}else{let n=s*i.a,a=s*i.c,r=Math.sqrt(n*n+a*a);d&&(f[e]=r),p[++e]=(t?s+w:w)*r/s}}}else for(let t=1;t<m;t++)p[t]=w;let x=this.computeWorldPositions(t,m,o,n.positionMode==l.Percent,a),b=x[0],y=x[1],v=n.offsetRotation,A=!1;if(0==v)A=r==c.Chain;else{A=!1;let t=this.target.bone;v*=t.a*t.d-t.b*t.c>0?I.degRad:-I.degRad}for(let t=0,n=3;t<u;t++,n+=3){let a=g[t];a.worldX+=(b-a.worldX)*i,a.worldY+=(y-a.worldY)*i;let r=x[n],l=x[n+1],h=r-b,c=l-y;if(d){let i=f[t];if(0!=i){let t=(Math.sqrt(h*h+c*c)/i-1)*e+1;a.a*=t,a.c*=t}}if(b=r,y=l,s){let i=a.a,s=a.b,r=a.c,l=a.d,d=0,u=0,m=0;if(d=o?x[n-1]:0==p[t+1]?x[n+2]:Math.atan2(c,h),d-=Math.atan2(r,i),A){u=Math.cos(d),m=Math.sin(d);let t=a.data.length;b+=(t*(u*i-m*r)-h)*e,y+=(t*(m*i+u*r)-c)*e}else d+=v;d>I.PI?d-=I.PI2:d<-I.PI&&(d+=I.PI2),d*=e,u=Math.cos(d),m=Math.sin(d),a.a=u*i-m*r,a.b=u*s-m*l,a.c=m*i+u*r,a.d=m*s+u*l}a.appliedValid=!1}}computeWorldPositions(t,e,i,s,n){let a=this.target,r=this.position,o=this.spaces,l=T.setArraySize(this.positions,3*e+2),h=null,c=t.closed,d=t.worldVerticesLength,u=d/6,m=z.NONE;if(!t.constantSpeed){let g=t.lengths;u-=c?1:2;let p=g[u];if(s&&(r*=p),n)for(let t=1;t<e;t++)o[t]*=p;h=T.setArraySize(this.world,8);for(let s=0,n=0,f=0;s<e;s++,n+=3){let e=o[s];r+=e;let w=r;if(c)w%=p,w<0&&(w+=p),f=0;else{if(w<0){m!=z.BEFORE&&(m=z.BEFORE,t.computeWorldVertices(a,2,4,h,0,2)),this.addBeforePosition(w,h,0,l,n);continue}if(w>p){m!=z.AFTER&&(m=z.AFTER,t.computeWorldVertices(a,d-6,4,h,0,2)),this.addAfterPosition(w-p,h,0,l,n);continue}}for(;;f++){let t=g[f];if(!(w>t)){if(0==f)w/=t;else{let e=g[f-1];w=(w-e)/(t-e)}break}}f!=m&&(m=f,c&&f==u?(t.computeWorldVertices(a,d-4,4,h,0,2),t.computeWorldVertices(a,0,4,h,4,2)):t.computeWorldVertices(a,6*f+2,8,h,0,2)),this.addCurvePosition(w,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],l,n,i||s>0&&0==e)}return l}c?(d+=2,h=T.setArraySize(this.world,d),t.computeWorldVertices(a,2,d-4,h,0,2),t.computeWorldVertices(a,0,2,h,d-4,2),h[d-2]=h[0],h[d-1]=h[1]):(u--,d-=4,h=T.setArraySize(this.world,d),t.computeWorldVertices(a,2,d,h,0,2));let g=T.setArraySize(this.curves,u),p=0,f=h[0],w=h[1],x=0,b=0,y=0,v=0,A=0,E=0,M=0,S=0,R=0,I=0,C=0,P=0,k=0,V=0;for(let t=0,e=2;t<u;t++,e+=6)x=h[e],b=h[e+1],y=h[e+2],v=h[e+3],A=h[e+4],E=h[e+5],M=.1875*(f-2*x+y),S=.1875*(w-2*b+v),R=.09375*(3*(x-y)-f+A),I=.09375*(3*(b-v)-w+E),C=2*M+R,P=2*S+I,k=.75*(x-f)+M+.16666667*R,V=.75*(b-w)+S+.16666667*I,p+=Math.sqrt(k*k+V*V),k+=C,V+=P,C+=R,P+=I,p+=Math.sqrt(k*k+V*V),k+=C,V+=P,p+=Math.sqrt(k*k+V*V),k+=C+R,V+=P+I,p+=Math.sqrt(k*k+V*V),g[t]=p,f=A,w=E;if(r*=s?p:p/t.lengths[u-1],n)for(let t=1;t<e;t++)o[t]*=p;let N=this.segments,L=0;for(let t=0,s=0,n=0,a=0;t<e;t++,s+=3){let e=o[t];r+=e;let u=r;if(c)u%=p,u<0&&(u+=p),n=0;else{if(u<0){this.addBeforePosition(u,h,0,l,s);continue}if(u>p){this.addAfterPosition(u-p,h,d-4,l,s);continue}}for(;;n++){let t=g[n];if(!(u>t)){if(0==n)u/=t;else{let e=g[n-1];u=(u-e)/(t-e)}break}}if(n!=m){m=n;let t=6*n;for(f=h[t],w=h[t+1],x=h[t+2],b=h[t+3],y=h[t+4],v=h[t+5],A=h[t+6],E=h[t+7],M=.03*(f-2*x+y),S=.03*(w-2*b+v),R=.006*(3*(x-y)-f+A),I=.006*(3*(b-v)-w+E),C=2*M+R,P=2*S+I,k=.3*(x-f)+M+.16666667*R,V=.3*(b-w)+S+.16666667*I,L=Math.sqrt(k*k+V*V),N[0]=L,t=1;t<8;t++)k+=C,V+=P,C+=R,P+=I,L+=Math.sqrt(k*k+V*V),N[t]=L;k+=C,V+=P,L+=Math.sqrt(k*k+V*V),N[8]=L,k+=C+R,V+=P+I,L+=Math.sqrt(k*k+V*V),N[9]=L,a=0}for(u*=L;;a++){let t=N[a];if(!(u>t)){if(0==a)u/=t;else{let e=N[a-1];u=a+(u-e)/(t-e)}break}}this.addCurvePosition(.1*u,f,w,x,b,y,v,A,E,l,s,i||t>0&&0==e)}return l}addBeforePosition(t,e,i,s,n){let a=e[i],r=e[i+1],o=e[i+2]-a,l=e[i+3]-r,h=Math.atan2(l,o);s[n]=a+t*Math.cos(h),s[n+1]=r+t*Math.sin(h),s[n+2]=h}addAfterPosition(t,e,i,s,n){let a=e[i+2],r=e[i+3],o=a-e[i],l=r-e[i+1],h=Math.atan2(l,o);s[n]=a+t*Math.cos(h),s[n+1]=r+t*Math.sin(h),s[n+2]=h}addCurvePosition(t,e,i,s,n,a,r,o,l,h,c,d){if(0==t||isNaN(t))return h[c]=e,h[c+1]=i,void(h[c+2]=Math.atan2(n-i,s-e));let u=t*t,m=u*t,g=1-t,p=g*g,f=p*g,w=g*t,x=3*w,b=g*x,y=x*t,v=e*f+s*b+a*y+o*m,A=i*f+n*b+r*y+l*m;h[c]=v,h[c+1]=A,d&&(h[c+2]=t<.001?Math.atan2(n-i,s-e):Math.atan2(A-(i*p+n*w*2+r*u),v-(e*p+s*w*2+a*u)))}}class j{data;bone;color;darkColor;attachment;attachmentTime;attachmentState;deform=new Array;constructor(t,e){if(null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new R,this.darkColor=null==t.darkColor?null:new R,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)}setAttachmentTime(t){this.attachmentTime=this.bone.skeleton.time-t}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}}class H{data;bones;target;rotateMix=0;translateMix=0;scaleMix=0;shearMix=0;temp=new P;active=!1;constructor(t,e){if(null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(let i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){let t=this.rotateMix,e=this.translateMix,i=this.scaleMix,s=this.shearMix,n=this.target,a=n.a,r=n.b,o=n.c,l=n.d,h=a*l-r*o>0?I.degRad:-I.degRad,c=this.data.offsetRotation*h,d=this.data.offsetShearY*h,u=this.bones;for(let h=0,m=u.length;h<m;h++){let m=u[h],g=!1;if(0!=t){let e=m.a,i=m.b,s=m.c,n=m.d,r=Math.atan2(o,a)-Math.atan2(s,e)+c;r>I.PI?r-=I.PI2:r<-I.PI&&(r+=I.PI2),r*=t;let l=Math.cos(r),h=Math.sin(r);m.a=l*e-h*s,m.b=l*i-h*n,m.c=h*e+l*s,m.d=h*i+l*n,g=!0}if(0!=e){let t=this.temp;n.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),m.worldX+=(t.x-m.worldX)*e,m.worldY+=(t.y-m.worldY)*e,g=!0}if(i>0){let t=Math.sqrt(m.a*m.a+m.c*m.c),e=Math.sqrt(a*a+o*o);t>1e-5&&(t=(t+(e-t+this.data.offsetScaleX)*i)/t),m.a*=t,m.c*=t,t=Math.sqrt(m.b*m.b+m.d*m.d),e=Math.sqrt(r*r+l*l),t>1e-5&&(t=(t+(e-t+this.data.offsetScaleY)*i)/t),m.b*=t,m.d*=t,g=!0}if(s>0){let t=m.b,e=m.d,i=Math.atan2(e,t),n=Math.atan2(l,r)-Math.atan2(o,a)-(i-Math.atan2(m.c,m.a));n>I.PI?n-=I.PI2:n<-I.PI&&(n+=I.PI2),n=i+(n+d)*s;let h=Math.sqrt(t*t+e*e);m.b=Math.cos(n)*h,m.d=Math.sin(n)*h,g=!0}g&&(m.appliedValid=!1)}}applyRelativeWorld(){let t=this.rotateMix,e=this.translateMix,i=this.scaleMix,s=this.shearMix,n=this.target,a=n.a,r=n.b,o=n.c,l=n.d,h=a*l-r*o>0?I.degRad:-I.degRad,c=this.data.offsetRotation*h,d=this.data.offsetShearY*h,u=this.bones;for(let h=0,m=u.length;h<m;h++){let m=u[h],g=!1;if(0!=t){let e=m.a,i=m.b,s=m.c,n=m.d,r=Math.atan2(o,a)+c;r>I.PI?r-=I.PI2:r<-I.PI&&(r+=I.PI2),r*=t;let l=Math.cos(r),h=Math.sin(r);m.a=l*e-h*s,m.b=l*i-h*n,m.c=h*e+l*s,m.d=h*i+l*n,g=!0}if(0!=e){let t=this.temp;n.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),m.worldX+=t.x*e,m.worldY+=t.y*e,g=!0}if(i>0){let t=(Math.sqrt(a*a+o*o)-1+this.data.offsetScaleX)*i+1;m.a*=t,m.c*=t,t=(Math.sqrt(r*r+l*l)-1+this.data.offsetScaleY)*i+1,m.b*=t,m.d*=t,g=!0}if(s>0){let t=Math.atan2(l,r)-Math.atan2(o,a);t>I.PI?t-=I.PI2:t<-I.PI&&(t+=I.PI2);let e=m.b,i=m.d;t=Math.atan2(i,e)+(t-I.PI/2+d)*s;let n=Math.sqrt(e*e+i*i);m.b=Math.cos(t)*n,m.d=Math.sin(t)*n,g=!0}g&&(m.appliedValid=!1)}}applyAbsoluteLocal(){let t=this.rotateMix,e=this.translateMix,i=this.scaleMix,s=this.shearMix,n=this.target;n.appliedValid||n.updateAppliedTransform();let a=this.bones;for(let r=0,o=a.length;r<o;r++){let o=a[r];o.appliedValid||o.updateAppliedTransform();let l=o.arotation;if(0!=t){let e=n.arotation-l+this.data.offsetRotation;e-=360*(16384-(16384.499999999996-e/360|0)),l+=e*t}let h=o.ax,c=o.ay;0!=e&&(h+=(n.ax-h+this.data.offsetX)*e,c+=(n.ay-c+this.data.offsetY)*e);let d=o.ascaleX,u=o.ascaleY;0!=i&&(d>1e-5&&(d=(d+(n.ascaleX-d+this.data.offsetScaleX)*i)/d),u>1e-5&&(u=(u+(n.ascaleY-u+this.data.offsetScaleY)*i)/u));let m=o.ashearY;if(0!=s){let t=n.ashearY-m+this.data.offsetShearY;t-=360*(16384-(16384.499999999996-t/360|0)),o.shearY+=t*s}o.updateWorldTransformWith(h,c,l,d,u,o.ashearX,m)}}applyRelativeLocal(){let t=this.rotateMix,e=this.translateMix,i=this.scaleMix,s=this.shearMix,n=this.target;n.appliedValid||n.updateAppliedTransform();let a=this.bones;for(let r=0,o=a.length;r<o;r++){let o=a[r];o.appliedValid||o.updateAppliedTransform();let l=o.arotation;0!=t&&(l+=(n.arotation+this.data.offsetRotation)*t);let h=o.ax,c=o.ay;0!=e&&(h+=(n.ax+this.data.offsetX)*e,c+=(n.ay+this.data.offsetY)*e);let d=o.ascaleX,u=o.ascaleY;0!=i&&(d>1e-5&&(d*=(n.ascaleX-1+this.data.offsetScaleX)*i+1),u>1e-5&&(u*=(n.ascaleY-1+this.data.offsetScaleY)*i+1));let m=o.ashearY;0!=s&&(m+=(n.ashearY+this.data.offsetShearY)*s),o.updateWorldTransformWith(h,c,l,d,u,o.ashearX,m)}}}class J{data;bones;slots;drawOrder;ikConstraints;transformConstraints;pathConstraints;_updateCache=new Array;updateCacheReset=new Array;skin;color;time=0;scaleX=1;scaleY=1;x=0;y=0;constructor(t){if(null==t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){let i,s=t.bones[e];if(null==s.parent)i=new W(s,this,null);else{let t=this.bones[s.parent.index];i=new W(s,this,t),t.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){let i=t.slots[e],s=this.bones[i.boneData.index],n=new j(i,s);this.slots.push(n),this.drawOrder.push(n)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){let i=t.ikConstraints[e];this.ikConstraints.push(new U(i,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){let i=t.transformConstraints[e];this.transformConstraints.push(new H(i,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){let i=t.pathConstraints[e];this.pathConstraints.push(new z(i,this))}this.color=new R(1,1,1,1),this.updateCache()}updateCache(){this._updateCache.length=0,this.updateCacheReset.length=0;let t=this.bones;for(let e=0,i=t.length;e<i;e++){let i=t[e];i.sorted=i.data.skinRequired,i.active=!i.sorted}if(null!=this.skin){let t=this.skin.bones;for(let e=0,i=this.skin.bones.length;e<i;e++){let i=this.bones[t[e].index];do{i.sorted=!1,i.active=!0,i=i.parent}while(null!=i)}}let e=this.ikConstraints,i=this.transformConstraints,s=this.pathConstraints,n=e.length,a=i.length,r=s.length,o=n+a+r;t:for(let t=0;t<o;t++){for(let i=0;i<n;i++){let s=e[i];if(s.data.order==t){this.sortIkConstraint(s);continue t}}for(let e=0;e<a;e++){let s=i[e];if(s.data.order==t){this.sortTransformConstraint(s);continue t}}for(let e=0;e<r;e++){let i=s[e];if(i.data.order==t){this.sortPathConstraint(i);continue t}}}for(let e=0,i=t.length;e<i;e++)this.sortBone(t[e])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&T.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target;this.sortBone(e);let i=t.bones,s=i[0];if(this.sortBone(s),i.length>1){let t=i[i.length-1];this._updateCache.indexOf(t)>-1||this.updateCacheReset.push(t)}this._updateCache.push(t),this.sortReset(s.children),i[i.length-1].sorted=!0}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||null!=this.skin&&T.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target,i=e.data.index,s=e.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,i,s),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,i,s);for(let t=0,e=this.data.skins.length;t<e;t++)this.sortPathConstraintAttachment(this.data.skins[t],i,s);let n=e.getAttachment();n instanceof D&&this.sortPathConstraintAttachmentWith(n,s);let a=t.bones,r=a.length;for(let t=0;t<r;t++)this.sortBone(a[t]);this._updateCache.push(t);for(let t=0;t<r;t++)this.sortReset(a[t].children);for(let t=0;t<r;t++)a[t].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&T.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);let e=t.bones,i=e.length;if(t.data.local)for(let t=0;t<i;t++){let i=e[t];this.sortBone(i.parent),this._updateCache.indexOf(i)>-1||this.updateCacheReset.push(i)}else for(let t=0;t<i;t++)this.sortBone(e[t]);this._updateCache.push(t);for(let t=0;t<i;t++)this.sortReset(e[t].children);for(let t=0;t<i;t++)e[t].sorted=!0}sortPathConstraintAttachment(t,e,i){let s=t.attachments[e];if(s)for(let t in s)this.sortPathConstraintAttachmentWith(s[t],i)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof D))return;let i=t.bones;if(null==i)this.sortBone(e);else{let t=this.bones,e=0;for(;e<i.length;){let s=i[e++];for(let n=e+s;e<n;e++){let s=i[e];this.sortBone(t[s])}}}}sortBone(t){if(t.sorted)return;let e=t.parent;null!=e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,i=t.length;e<i;e++){let i=t[e];i.active&&(i.sorted&&this.sortReset(i.children),i.sorted=!1)}}updateWorldTransform(){let t=this.updateCacheReset;for(let e=0,i=t.length;e<i;e++){let i=t[e];i.ax=i.x,i.ay=i.y,i.arotation=i.rotation,i.ascaleX=i.scaleX,i.ascaleY=i.scaleY,i.ashearX=i.shearX,i.ashearY=i.shearY,i.appliedValid=!0}let e=this._updateCache;for(let t=0,i=e.length;t<i;t++)e[t].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){let t=this.bones;for(let e=0,i=t.length;e<i;e++)t[e].setToSetupPose();let e=this.ikConstraints;for(let t=0,i=e.length;t<i;t++){let i=e[t];i.mix=i.data.mix,i.softness=i.data.softness,i.bendDirection=i.data.bendDirection,i.compress=i.data.compress,i.stretch=i.data.stretch}let i=this.transformConstraints;for(let t=0,e=i.length;t<e;t++){let e=i[t],s=e.data;e.rotateMix=s.rotateMix,e.translateMix=s.translateMix,e.scaleMix=s.scaleMix,e.shearMix=s.shearMix}let s=this.pathConstraints;for(let t=0,e=s.length;t<e;t++){let e=s[t],i=e.data;e.position=i.position,e.spacing=i.spacing,e.rotateMix=i.rotateMix,e.translateMix=i.translateMix}}setSlotsToSetupPose(){let t=this.slots;T.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,i=t.length;e<i;e++)t[e].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(t){if(null==t)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.data.name==t)return s}return null}findBoneIndex(t){if(null==t)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,s=e.length;i<s;i++)if(e[i].data.name==t)return i;return-1}findSlot(t){if(null==t)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.data.name==t)return s}return null}findSlotIndex(t){if(null==t)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,s=e.length;i<s;i++)if(e[i].data.name==t)return i;return-1}setSkinByName(t){let e=this.data.findSkin(t);if(null==e)throw new Error("Skin not found: "+t);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else{let e=this.slots;for(let i=0,s=e.length;i<s;i++){let s=e[i],n=s.data.attachmentName;if(null!=n){let e=t.getAttachment(i,n);null!=e&&s.setAttachment(e)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)}getAttachment(t,e){if(null==e)throw new Error("attachmentName cannot be null.");if(null!=this.skin){let i=this.skin.getAttachment(t,e);if(null!=i)return i}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(null==t)throw new Error("slotName cannot be null.");let i=this.slots;for(let s=0,n=i.length;s<n;s++){let n=i[s];if(n.data.name==t){let i=null;if(null!=e&&(i=this.getAttachment(s,e),null==i))throw new Error("Attachment not found: "+e+", for slot: "+t);return void n.setAttachment(i)}}throw new Error("Slot not found: "+t)}findIkConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");let e=this.ikConstraints;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.data.name==t)return s}return null}findTransformConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");let e=this.transformConstraints;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.data.name==t)return s}return null}findPathConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");let e=this.pathConstraints;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.data.name==t)return s}return null}getBounds(t,e,i=new Array(2)){if(null==t)throw new Error("offset cannot be null.");if(null==e)throw new Error("size cannot be null.");let s=this.drawOrder,n=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let t=0,e=s.length;t<e;t++){let e=s[t];if(!e.bone.active)continue;let l=0,h=null,c=e.getAttachment();if(c instanceof B)l=8,h=T.setArraySize(i,l,0),c.computeWorldVertices(e.bone,h,0,2);else if(c instanceof Y){let t=c;l=t.worldVerticesLength,h=T.setArraySize(i,l,0),t.computeWorldVertices(e,0,l,h,0,2)}if(null!=h)for(let t=0,e=h.length;t<e;t+=2){let e=h[t],i=h[t+1];n=Math.min(n,e),a=Math.min(a,i),r=Math.max(r,e),o=Math.max(o,i)}}t.set(n,a),e.set(r-n,o-a)}update(t){this.time+=t}}class Q{name;timelines;timelineIds;duration;constructor(t,e,i){if(null==t)throw new Error("name cannot be null.");if(null==e)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.timelineIds=[];for(var s=0;s<e.length;s++)this.timelineIds[e[s].getPropertyId()]=!0;this.duration=i}hasTimeline(t){return 1==this.timelineIds[t]}apply(t,e,i,s,n,a,r,o){if(null==t)throw new Error("skeleton cannot be null.");s&&0!=this.duration&&(i%=this.duration,e>0&&(e%=this.duration));let l=this.timelines;for(let s=0,h=l.length;s<h;s++)l[s].apply(t,e,i,n,a,r,o)}static binarySearch(t,e,i=1){let s=0,n=t.length/i-2;if(0==n)return i;let a=n>>>1;for(;;){if(t[(a+1)*i]<=e?s=a+1:n=a,s==n)return(s+1)*i;a=s+n>>>1}}static linearSearch(t,e,i){for(let s=0,n=t.length-i;s<=n;s+=i)if(t[s]>e)return s;return-1}}!function(t){t[t.setup=0]="setup",t[t.first=1]="first",t[t.replace=2]="replace",t[t.add=3]="add"}(d||(d={})),function(t){t[t.mixIn=0]="mixIn",t[t.mixOut=1]="mixOut"}(u||(u={})),function(t){t[t.rotate=0]="rotate",t[t.translate=1]="translate",t[t.scale=2]="scale",t[t.shear=3]="shear",t[t.attachment=4]="attachment",t[t.color=5]="color",t[t.deform=6]="deform",t[t.event=7]="event",t[t.drawOrder=8]="drawOrder",t[t.ikConstraint=9]="ikConstraint",t[t.transformConstraint=10]="transformConstraint",t[t.pathConstraintPosition=11]="pathConstraintPosition",t[t.pathConstraintSpacing=12]="pathConstraintSpacing",t[t.pathConstraintMix=13]="pathConstraintMix",t[t.twoColor=14]="twoColor"}(m||(m={}));class q{static LINEAR=0;static STEPPED=1;static BEZIER=2;static BEZIER_SIZE=19;curves;constructor(t){if(t<=0)throw new Error("frameCount must be > 0: "+t);this.curves=T.newFloatArray((t-1)*q.BEZIER_SIZE)}getFrameCount(){return this.curves.length/q.BEZIER_SIZE+1}setLinear(t){this.curves[t*q.BEZIER_SIZE]=q.LINEAR}setStepped(t){this.curves[t*q.BEZIER_SIZE]=q.STEPPED}getCurveType(t){let e=t*q.BEZIER_SIZE;if(e==this.curves.length)return q.LINEAR;let i=this.curves[e];return i==q.LINEAR?q.LINEAR:i==q.STEPPED?q.STEPPED:q.BEZIER}setCurve(t,e,i,s,n){let a=.03*(2*-e+s),r=.03*(2*-i+n),o=.006*(3*(e-s)+1),l=.006*(3*(i-n)+1),h=2*a+o,c=2*r+l,d=.3*e+a+.16666667*o,u=.3*i+r+.16666667*l,m=t*q.BEZIER_SIZE,g=this.curves;g[m++]=q.BEZIER;let p=d,f=u;for(let t=m+q.BEZIER_SIZE-1;m<t;m+=2)g[m]=p,g[m+1]=f,d+=h,u+=c,h+=o,c+=l,p+=d,f+=u}getCurvePercent(t,e){e=I.clamp(e,0,1);let i=this.curves,s=t*q.BEZIER_SIZE,n=i[s];if(n==q.LINEAR)return e;if(n==q.STEPPED)return 0;s++;let a=0;for(let t=s,n=s+q.BEZIER_SIZE-1;s<n;s+=2)if(a=i[s],a>=e){let n,r;return s==t?(n=0,r=0):(n=i[s-2],r=i[s-1]),r+(i[s+1]-r)*(e-n)/(a-n)}let r=i[s-1];return r+(1-r)*(e-a)/(1-a)}}class K extends q{static ENTRIES=2;static PREV_TIME=-2;static PREV_ROTATION=-1;static ROTATION=1;boneIndex;frames;constructor(t){super(t),this.frames=T.newFloatArray(t<<1)}getPropertyId(){return(m.rotate<<24)+this.boneIndex}setFrame(t,e,i){t<<=1,this.frames[t]=e,this.frames[t+K.ROTATION]=i}apply(t,e,i,s,n,a,r){let o=this.frames,l=t.bones[this.boneIndex];if(!l.active)return;if(i<o[0]){switch(a){case d.setup:return void(l.rotation=l.data.rotation);case d.first:let t=l.data.rotation-l.rotation;l.rotation+=(t-360*(16384-(16384.499999999996-t/360|0)))*n}return}if(i>=o[o.length-K.ENTRIES]){let t=o[o.length+K.PREV_ROTATION];switch(a){case d.setup:l.rotation=l.data.rotation+t*n;break;case d.first:case d.replace:t+=l.data.rotation-l.rotation,t-=360*(16384-(16384.499999999996-t/360|0));case d.add:l.rotation+=t*n}return}let h=Q.binarySearch(o,i,K.ENTRIES),c=o[h+K.PREV_ROTATION],u=o[h],m=this.getCurvePercent((h>>1)-1,1-(i-u)/(o[h+K.PREV_TIME]-u)),g=o[h+K.ROTATION]-c;switch(g=c+(g-360*(16384-(16384.499999999996-g/360|0)))*m,a){case d.setup:l.rotation=l.data.rotation+(g-360*(16384-(16384.499999999996-g/360|0)))*n;break;case d.first:case d.replace:g+=l.data.rotation-l.rotation;case d.add:l.rotation+=(g-360*(16384-(16384.499999999996-g/360|0)))*n}}}class $ extends q{static ENTRIES=3;static PREV_TIME=-3;static PREV_X=-2;static PREV_Y=-1;static X=1;static Y=2;boneIndex;frames;constructor(t){super(t),this.frames=T.newFloatArray(t*$.ENTRIES)}getPropertyId(){return(m.translate<<24)+this.boneIndex}setFrame(t,e,i,s){t*=$.ENTRIES,this.frames[t]=e,this.frames[t+$.X]=i,this.frames[t+$.Y]=s}apply(t,e,i,s,n,a,r){let o=this.frames,l=t.bones[this.boneIndex];if(!l.active)return;if(i<o[0]){switch(a){case d.setup:return l.x=l.data.x,void(l.y=l.data.y);case d.first:l.x+=(l.data.x-l.x)*n,l.y+=(l.data.y-l.y)*n}return}let h=0,c=0;if(i>=o[o.length-$.ENTRIES])h=o[o.length+$.PREV_X],c=o[o.length+$.PREV_Y];else{let t=Q.binarySearch(o,i,$.ENTRIES);h=o[t+$.PREV_X],c=o[t+$.PREV_Y];let e=o[t],s=this.getCurvePercent(t/$.ENTRIES-1,1-(i-e)/(o[t+$.PREV_TIME]-e));h+=(o[t+$.X]-h)*s,c+=(o[t+$.Y]-c)*s}switch(a){case d.setup:l.x=l.data.x+h*n,l.y=l.data.y+c*n;break;case d.first:case d.replace:l.x+=(l.data.x+h-l.x)*n,l.y+=(l.data.y+c-l.y)*n;break;case d.add:l.x+=h*n,l.y+=c*n}}}class tt extends ${constructor(t){super(t)}getPropertyId(){return(m.scale<<24)+this.boneIndex}apply(t,e,i,s,n,a,r){let o=this.frames,l=t.bones[this.boneIndex];if(!l.active)return;if(i<o[0]){switch(a){case d.setup:return l.scaleX=l.data.scaleX,void(l.scaleY=l.data.scaleY);case d.first:l.scaleX+=(l.data.scaleX-l.scaleX)*n,l.scaleY+=(l.data.scaleY-l.scaleY)*n}return}let h=0,c=0;if(i>=o[o.length-tt.ENTRIES])h=o[o.length+tt.PREV_X]*l.data.scaleX,c=o[o.length+tt.PREV_Y]*l.data.scaleY;else{let t=Q.binarySearch(o,i,tt.ENTRIES);h=o[t+tt.PREV_X],c=o[t+tt.PREV_Y];let e=o[t],s=this.getCurvePercent(t/tt.ENTRIES-1,1-(i-e)/(o[t+tt.PREV_TIME]-e));h=(h+(o[t+tt.X]-h)*s)*l.data.scaleX,c=(c+(o[t+tt.Y]-c)*s)*l.data.scaleY}if(1==n)a==d.add?(l.scaleX+=h-l.data.scaleX,l.scaleY+=c-l.data.scaleY):(l.scaleX=h,l.scaleY=c);else{let t=0,e=0;if(r==u.mixOut)switch(a){case d.setup:t=l.data.scaleX,e=l.data.scaleY,l.scaleX=t+(Math.abs(h)*I.signum(t)-t)*n,l.scaleY=e+(Math.abs(c)*I.signum(e)-e)*n;break;case d.first:case d.replace:t=l.scaleX,e=l.scaleY,l.scaleX=t+(Math.abs(h)*I.signum(t)-t)*n,l.scaleY=e+(Math.abs(c)*I.signum(e)-e)*n;break;case d.add:t=l.scaleX,e=l.scaleY,l.scaleX=t+(Math.abs(h)*I.signum(t)-l.data.scaleX)*n,l.scaleY=e+(Math.abs(c)*I.signum(e)-l.data.scaleY)*n}else switch(a){case d.setup:t=Math.abs(l.data.scaleX)*I.signum(h),e=Math.abs(l.data.scaleY)*I.signum(c),l.scaleX=t+(h-t)*n,l.scaleY=e+(c-e)*n;break;case d.first:case d.replace:t=Math.abs(l.scaleX)*I.signum(h),e=Math.abs(l.scaleY)*I.signum(c),l.scaleX=t+(h-t)*n,l.scaleY=e+(c-e)*n;break;case d.add:t=I.signum(h),e=I.signum(c),l.scaleX=Math.abs(l.scaleX)*t+(h-Math.abs(l.data.scaleX)*t)*n,l.scaleY=Math.abs(l.scaleY)*e+(c-Math.abs(l.data.scaleY)*e)*n}}}}class et extends ${constructor(t){super(t)}getPropertyId(){return(m.shear<<24)+this.boneIndex}apply(t,e,i,s,n,a,r){let o=this.frames,l=t.bones[this.boneIndex];if(!l.active)return;if(i<o[0]){switch(a){case d.setup:return l.shearX=l.data.shearX,void(l.shearY=l.data.shearY);case d.first:l.shearX+=(l.data.shearX-l.shearX)*n,l.shearY+=(l.data.shearY-l.shearY)*n}return}let h=0,c=0;if(i>=o[o.length-et.ENTRIES])h=o[o.length+et.PREV_X],c=o[o.length+et.PREV_Y];else{let t=Q.binarySearch(o,i,et.ENTRIES);h=o[t+et.PREV_X],c=o[t+et.PREV_Y];let e=o[t],s=this.getCurvePercent(t/et.ENTRIES-1,1-(i-e)/(o[t+et.PREV_TIME]-e));h+=(o[t+et.X]-h)*s,c+=(o[t+et.Y]-c)*s}switch(a){case d.setup:l.shearX=l.data.shearX+h*n,l.shearY=l.data.shearY+c*n;break;case d.first:case d.replace:l.shearX+=(l.data.shearX+h-l.shearX)*n,l.shearY+=(l.data.shearY+c-l.shearY)*n;break;case d.add:l.shearX+=h*n,l.shearY+=c*n}}}class it extends q{static ENTRIES=5;static PREV_TIME=-5;static PREV_R=-4;static PREV_G=-3;static PREV_B=-2;static PREV_A=-1;static R=1;static G=2;static B=3;static A=4;slotIndex;frames;constructor(t){super(t),this.frames=T.newFloatArray(t*it.ENTRIES)}getPropertyId(){return(m.color<<24)+this.slotIndex}setFrame(t,e,i,s,n,a){t*=it.ENTRIES,this.frames[t]=e,this.frames[t+it.R]=i,this.frames[t+it.G]=s,this.frames[t+it.B]=n,this.frames[t+it.A]=a}apply(t,e,i,s,n,a,r){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let l=this.frames;if(i<l[0]){switch(a){case d.setup:return void o.color.setFromColor(o.data.color);case d.first:let t=o.color,e=o.data.color;t.add((e.r-t.r)*n,(e.g-t.g)*n,(e.b-t.b)*n,(e.a-t.a)*n)}return}let h=0,c=0,u=0,m=0;if(i>=l[l.length-it.ENTRIES]){let t=l.length;h=l[t+it.PREV_R],c=l[t+it.PREV_G],u=l[t+it.PREV_B],m=l[t+it.PREV_A]}else{let t=Q.binarySearch(l,i,it.ENTRIES);h=l[t+it.PREV_R],c=l[t+it.PREV_G],u=l[t+it.PREV_B],m=l[t+it.PREV_A];let e=l[t],s=this.getCurvePercent(t/it.ENTRIES-1,1-(i-e)/(l[t+it.PREV_TIME]-e));h+=(l[t+it.R]-h)*s,c+=(l[t+it.G]-c)*s,u+=(l[t+it.B]-u)*s,m+=(l[t+it.A]-m)*s}if(1==n)o.color.set(h,c,u,m);else{let t=o.color;a==d.setup&&t.setFromColor(o.data.color),t.add((h-t.r)*n,(c-t.g)*n,(u-t.b)*n,(m-t.a)*n)}}}class st extends q{static ENTRIES=8;static PREV_TIME=-8;static PREV_R=-7;static PREV_G=-6;static PREV_B=-5;static PREV_A=-4;static PREV_R2=-3;static PREV_G2=-2;static PREV_B2=-1;static R=1;static G=2;static B=3;static A=4;static R2=5;static G2=6;static B2=7;slotIndex;frames;constructor(t){super(t),this.frames=T.newFloatArray(t*st.ENTRIES)}getPropertyId(){return(m.twoColor<<24)+this.slotIndex}setFrame(t,e,i,s,n,a,r,o,l){t*=st.ENTRIES,this.frames[t]=e,this.frames[t+st.R]=i,this.frames[t+st.G]=s,this.frames[t+st.B]=n,this.frames[t+st.A]=a,this.frames[t+st.R2]=r,this.frames[t+st.G2]=o,this.frames[t+st.B2]=l}apply(t,e,i,s,n,a,r){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let l=this.frames;if(i<l[0]){switch(a){case d.setup:return o.color.setFromColor(o.data.color),void o.darkColor.setFromColor(o.data.darkColor);case d.first:let t=o.color,e=o.darkColor,i=o.data.color,s=o.data.darkColor;t.add((i.r-t.r)*n,(i.g-t.g)*n,(i.b-t.b)*n,(i.a-t.a)*n),e.add((s.r-e.r)*n,(s.g-e.g)*n,(s.b-e.b)*n,0)}return}let h=0,c=0,u=0,m=0,g=0,p=0,f=0;if(i>=l[l.length-st.ENTRIES]){let t=l.length;h=l[t+st.PREV_R],c=l[t+st.PREV_G],u=l[t+st.PREV_B],m=l[t+st.PREV_A],g=l[t+st.PREV_R2],p=l[t+st.PREV_G2],f=l[t+st.PREV_B2]}else{let t=Q.binarySearch(l,i,st.ENTRIES);h=l[t+st.PREV_R],c=l[t+st.PREV_G],u=l[t+st.PREV_B],m=l[t+st.PREV_A],g=l[t+st.PREV_R2],p=l[t+st.PREV_G2],f=l[t+st.PREV_B2];let e=l[t],s=this.getCurvePercent(t/st.ENTRIES-1,1-(i-e)/(l[t+st.PREV_TIME]-e));h+=(l[t+st.R]-h)*s,c+=(l[t+st.G]-c)*s,u+=(l[t+st.B]-u)*s,m+=(l[t+st.A]-m)*s,g+=(l[t+st.R2]-g)*s,p+=(l[t+st.G2]-p)*s,f+=(l[t+st.B2]-f)*s}if(1==n)o.color.set(h,c,u,m),o.darkColor.set(g,p,f,1);else{let t=o.color,e=o.darkColor;a==d.setup&&(t.setFromColor(o.data.color),e.setFromColor(o.data.darkColor)),t.add((h-t.r)*n,(c-t.g)*n,(u-t.b)*n,(m-t.a)*n),e.add((g-e.r)*n,(p-e.g)*n,(f-e.b)*n,0)}}}class nt{slotIndex;frames;attachmentNames;constructor(t){this.frames=T.newFloatArray(t),this.attachmentNames=new Array(t)}getPropertyId(){return(m.attachment<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i}apply(t,e,i,s,n,a,r){let o=t.slots[this.slotIndex];if(!o.bone.active)return;if(r==u.mixOut)return void(a==d.setup&&this.setAttachment(t,o,o.data.attachmentName));let l=this.frames;if(i<l[0])return void(a!=d.setup&&a!=d.first||this.setAttachment(t,o,o.data.attachmentName));let h=0;h=i>=l[l.length-1]?l.length-1:Q.binarySearch(l,i,1)-1;let c=this.attachmentNames[h];t.slots[this.slotIndex].setAttachment(null==c?null:t.getAttachment(this.slotIndex,c))}setAttachment(t,e,i){e.attachment=null==i?null:t.getAttachment(this.slotIndex,i)}}let at=null;class rt extends q{slotIndex;attachment;frames;frameVertices;constructor(t){super(t),this.frames=T.newFloatArray(t),this.frameVertices=new Array(t),null==at&&(at=T.newFloatArray(64))}getPropertyId(){return(m.deform<<27)+ +this.attachment.id+this.slotIndex}setFrame(t,e,i){this.frames[t]=e,this.frameVertices[t]=i}apply(t,e,i,s,n,a,r){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let l=o.getAttachment();if(!(l instanceof N)||l.deformAttachment!=this.attachment)return;let h=o.deform;0==h.length&&(a=d.setup);let c=this.frameVertices,u=c[0].length,m=this.frames;if(i<m[0]){let t=l;switch(a){case d.setup:return void(h.length=0);case d.first:if(1==n){h.length=0;break}let e=T.setArraySize(h,u);if(null==t.bones){let i=t.vertices;for(var g=0;g<u;g++)e[g]+=(i[g]-e[g])*n}else for(n=1-n,g=0;g<u;g++)e[g]*=n}return}let p=T.setArraySize(h,u);if(i>=m[m.length-1]){let t=c[m.length-1];if(1==n)if(a==d.add){let e=l;if(null==e.bones){let i=e.vertices;for(let e=0;e<u;e++)p[e]+=t[e]-i[e]}else for(let e=0;e<u;e++)p[e]+=t[e]}else T.arrayCopy(t,0,p,0,u);else switch(a){case d.setup:{let e=l;if(null==e.bones){let i=e.vertices;for(let e=0;e<u;e++){let s=i[e];p[e]=s+(t[e]-s)*n}}else for(let e=0;e<u;e++)p[e]=t[e]*n;break}case d.first:case d.replace:for(let e=0;e<u;e++)p[e]+=(t[e]-p[e])*n;break;case d.add:let e=l;if(null==e.bones){let i=e.vertices;for(let e=0;e<u;e++)p[e]+=(t[e]-i[e])*n}else for(let e=0;e<u;e++)p[e]+=t[e]*n}return}let f=Q.binarySearch(m,i),w=c[f-1],x=c[f],b=m[f],y=this.getCurvePercent(f-1,1-(i-b)/(m[f-1]-b));if(1==n)if(a==d.add){let t=l;if(null==t.bones){let e=t.vertices;for(let t=0;t<u;t++){let i=w[t];p[t]+=i+(x[t]-i)*y-e[t]}}else for(let t=0;t<u;t++){let e=w[t];p[t]+=e+(x[t]-e)*y}}else for(let t=0;t<u;t++){let e=w[t];p[t]=e+(x[t]-e)*y}else switch(a){case d.setup:{let t=l;if(null==t.bones){let e=t.vertices;for(let t=0;t<u;t++){let i=w[t],s=e[t];p[t]=s+(i+(x[t]-i)*y-s)*n}}else for(let t=0;t<u;t++){let e=w[t];p[t]=(e+(x[t]-e)*y)*n}break}case d.first:case d.replace:for(let t=0;t<u;t++){let e=w[t];p[t]+=(e+(x[t]-e)*y-p[t])*n}break;case d.add:let t=l;if(null==t.bones){let e=t.vertices;for(let t=0;t<u;t++){let i=w[t];p[t]+=(i+(x[t]-i)*y-e[t])*n}}else for(let t=0;t<u;t++){let e=w[t];p[t]+=(e+(x[t]-e)*y)*n}}}}class ot{frames;events;constructor(t){this.frames=T.newFloatArray(t),this.events=new Array(t)}getPropertyId(){return m.event<<24}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,i,s,n,a,r){if(null==s)return;let o=this.frames,l=this.frames.length;if(e>i)this.apply(t,e,Number.MAX_VALUE,s,n,a,r),e=-1;else if(e>=o[l-1])return;if(i<o[0])return;let h=0;if(e<o[0])h=0;else{h=Q.binarySearch(o,e);let t=o[h];for(;h>0&&o[h-1]==t;)h--}for(;h<l&&i>=o[h];h++)s.push(this.events[h])}}class lt{frames;drawOrders;constructor(t){this.frames=T.newFloatArray(t),this.drawOrders=new Array(t)}getPropertyId(){return m.drawOrder<<24}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.drawOrders[t]=i}apply(t,e,i,s,n,a,r){let o=t.drawOrder,l=t.slots;if(r==u.mixOut)return void(a==d.setup&&T.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));let h=this.frames;if(i<h[0])return void(a!=d.setup&&a!=d.first||T.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));let c=0;c=i>=h[h.length-1]?h.length-1:Q.binarySearch(h,i)-1;let m=this.drawOrders[c];if(null==m)T.arrayCopy(l,0,o,0,l.length);else for(let t=0,e=m.length;t<e;t++)o[t]=l[m[t]]}}class ht extends q{static ENTRIES=6;static PREV_TIME=-6;static PREV_MIX=-5;static PREV_SOFTNESS=-4;static PREV_BEND_DIRECTION=-3;static PREV_COMPRESS=-2;static PREV_STRETCH=-1;static MIX=1;static SOFTNESS=2;static BEND_DIRECTION=3;static COMPRESS=4;static STRETCH=5;ikConstraintIndex;frames;constructor(t){super(t),this.frames=T.newFloatArray(t*ht.ENTRIES)}getPropertyId(){return(m.ikConstraint<<24)+this.ikConstraintIndex}setFrame(t,e,i,s,n,a,r){t*=ht.ENTRIES,this.frames[t]=e,this.frames[t+ht.MIX]=i,this.frames[t+ht.SOFTNESS]=s,this.frames[t+ht.BEND_DIRECTION]=n,this.frames[t+ht.COMPRESS]=a?1:0,this.frames[t+ht.STRETCH]=r?1:0}apply(t,e,i,s,n,a,r){let o=this.frames,l=t.ikConstraints[this.ikConstraintIndex];if(!l.active)return;if(i<o[0]){switch(a){case d.setup:return l.mix=l.data.mix,l.softness=l.data.softness,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,void(l.stretch=l.data.stretch);case d.first:l.mix+=(l.data.mix-l.mix)*n,l.softness+=(l.data.softness-l.softness)*n,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch}return}if(i>=o[o.length-ht.ENTRIES])return void(a==d.setup?(l.mix=l.data.mix+(o[o.length+ht.PREV_MIX]-l.data.mix)*n,l.softness=l.data.softness+(o[o.length+ht.PREV_SOFTNESS]-l.data.softness)*n,r==u.mixOut?(l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch):(l.bendDirection=o[o.length+ht.PREV_BEND_DIRECTION],l.compress=0!=o[o.length+ht.PREV_COMPRESS],l.stretch=0!=o[o.length+ht.PREV_STRETCH])):(l.mix+=(o[o.length+ht.PREV_MIX]-l.mix)*n,l.softness+=(o[o.length+ht.PREV_SOFTNESS]-l.softness)*n,r==u.mixIn&&(l.bendDirection=o[o.length+ht.PREV_BEND_DIRECTION],l.compress=0!=o[o.length+ht.PREV_COMPRESS],l.stretch=0!=o[o.length+ht.PREV_STRETCH])));let h=Q.binarySearch(o,i,ht.ENTRIES),c=o[h+ht.PREV_MIX],m=o[h+ht.PREV_SOFTNESS],g=o[h],p=this.getCurvePercent(h/ht.ENTRIES-1,1-(i-g)/(o[h+ht.PREV_TIME]-g));a==d.setup?(l.mix=l.data.mix+(c+(o[h+ht.MIX]-c)*p-l.data.mix)*n,l.softness=l.data.softness+(m+(o[h+ht.SOFTNESS]-m)*p-l.data.softness)*n,r==u.mixOut?(l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch):(l.bendDirection=o[h+ht.PREV_BEND_DIRECTION],l.compress=0!=o[h+ht.PREV_COMPRESS],l.stretch=0!=o[h+ht.PREV_STRETCH])):(l.mix+=(c+(o[h+ht.MIX]-c)*p-l.mix)*n,l.softness+=(m+(o[h+ht.SOFTNESS]-m)*p-l.softness)*n,r==u.mixIn&&(l.bendDirection=o[h+ht.PREV_BEND_DIRECTION],l.compress=0!=o[h+ht.PREV_COMPRESS],l.stretch=0!=o[h+ht.PREV_STRETCH]))}}class ct extends q{static ENTRIES=5;static PREV_TIME=-5;static PREV_ROTATE=-4;static PREV_TRANSLATE=-3;static PREV_SCALE=-2;static PREV_SHEAR=-1;static ROTATE=1;static TRANSLATE=2;static SCALE=3;static SHEAR=4;transformConstraintIndex;frames;constructor(t){super(t),this.frames=T.newFloatArray(t*ct.ENTRIES)}getPropertyId(){return(m.transformConstraint<<24)+this.transformConstraintIndex}setFrame(t,e,i,s,n,a){t*=ct.ENTRIES,this.frames[t]=e,this.frames[t+ct.ROTATE]=i,this.frames[t+ct.TRANSLATE]=s,this.frames[t+ct.SCALE]=n,this.frames[t+ct.SHEAR]=a}apply(t,e,i,s,n,a,r){let o=this.frames,l=t.transformConstraints[this.transformConstraintIndex];if(!l.active)return;if(i<o[0]){let t=l.data;switch(a){case d.setup:return l.rotateMix=t.rotateMix,l.translateMix=t.translateMix,l.scaleMix=t.scaleMix,void(l.shearMix=t.shearMix);case d.first:l.rotateMix+=(t.rotateMix-l.rotateMix)*n,l.translateMix+=(t.translateMix-l.translateMix)*n,l.scaleMix+=(t.scaleMix-l.scaleMix)*n,l.shearMix+=(t.shearMix-l.shearMix)*n}return}let h=0,c=0,u=0,m=0;if(i>=o[o.length-ct.ENTRIES]){let t=o.length;h=o[t+ct.PREV_ROTATE],c=o[t+ct.PREV_TRANSLATE],u=o[t+ct.PREV_SCALE],m=o[t+ct.PREV_SHEAR]}else{let t=Q.binarySearch(o,i,ct.ENTRIES);h=o[t+ct.PREV_ROTATE],c=o[t+ct.PREV_TRANSLATE],u=o[t+ct.PREV_SCALE],m=o[t+ct.PREV_SHEAR];let e=o[t],s=this.getCurvePercent(t/ct.ENTRIES-1,1-(i-e)/(o[t+ct.PREV_TIME]-e));h+=(o[t+ct.ROTATE]-h)*s,c+=(o[t+ct.TRANSLATE]-c)*s,u+=(o[t+ct.SCALE]-u)*s,m+=(o[t+ct.SHEAR]-m)*s}if(a==d.setup){let t=l.data;l.rotateMix=t.rotateMix+(h-t.rotateMix)*n,l.translateMix=t.translateMix+(c-t.translateMix)*n,l.scaleMix=t.scaleMix+(u-t.scaleMix)*n,l.shearMix=t.shearMix+(m-t.shearMix)*n}else l.rotateMix+=(h-l.rotateMix)*n,l.translateMix+=(c-l.translateMix)*n,l.scaleMix+=(u-l.scaleMix)*n,l.shearMix+=(m-l.shearMix)*n}}class dt extends q{static ENTRIES=2;static PREV_TIME=-2;static PREV_VALUE=-1;static VALUE=1;pathConstraintIndex;frames;constructor(t){super(t),this.frames=T.newFloatArray(t*dt.ENTRIES)}getPropertyId(){return(m.pathConstraintPosition<<24)+this.pathConstraintIndex}setFrame(t,e,i){t*=dt.ENTRIES,this.frames[t]=e,this.frames[t+dt.VALUE]=i}apply(t,e,i,s,n,a,r){let o=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(!l.active)return;if(i<o[0]){switch(a){case d.setup:return void(l.position=l.data.position);case d.first:l.position+=(l.data.position-l.position)*n}return}let h=0;if(i>=o[o.length-dt.ENTRIES])h=o[o.length+dt.PREV_VALUE];else{let t=Q.binarySearch(o,i,dt.ENTRIES);h=o[t+dt.PREV_VALUE];let e=o[t],s=this.getCurvePercent(t/dt.ENTRIES-1,1-(i-e)/(o[t+dt.PREV_TIME]-e));h+=(o[t+dt.VALUE]-h)*s}a==d.setup?l.position=l.data.position+(h-l.data.position)*n:l.position+=(h-l.position)*n}}class ut extends dt{constructor(t){super(t)}getPropertyId(){return(m.pathConstraintSpacing<<24)+this.pathConstraintIndex}apply(t,e,i,s,n,a,r){let o=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(!l.active)return;if(i<o[0]){switch(a){case d.setup:return void(l.spacing=l.data.spacing);case d.first:l.spacing+=(l.data.spacing-l.spacing)*n}return}let h=0;if(i>=o[o.length-ut.ENTRIES])h=o[o.length+ut.PREV_VALUE];else{let t=Q.binarySearch(o,i,ut.ENTRIES);h=o[t+ut.PREV_VALUE];let e=o[t],s=this.getCurvePercent(t/ut.ENTRIES-1,1-(i-e)/(o[t+ut.PREV_TIME]-e));h+=(o[t+ut.VALUE]-h)*s}a==d.setup?l.spacing=l.data.spacing+(h-l.data.spacing)*n:l.spacing+=(h-l.spacing)*n}}class mt extends q{static ENTRIES=3;static PREV_TIME=-3;static PREV_ROTATE=-2;static PREV_TRANSLATE=-1;static ROTATE=1;static TRANSLATE=2;pathConstraintIndex;frames;constructor(t){super(t),this.frames=T.newFloatArray(t*mt.ENTRIES)}getPropertyId(){return(m.pathConstraintMix<<24)+this.pathConstraintIndex}setFrame(t,e,i,s){t*=mt.ENTRIES,this.frames[t]=e,this.frames[t+mt.ROTATE]=i,this.frames[t+mt.TRANSLATE]=s}apply(t,e,i,s,n,a,r){let o=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(!l.active)return;if(i<o[0]){switch(a){case d.setup:return l.rotateMix=l.data.rotateMix,void(l.translateMix=l.data.translateMix);case d.first:l.rotateMix+=(l.data.rotateMix-l.rotateMix)*n,l.translateMix+=(l.data.translateMix-l.translateMix)*n}return}let h=0,c=0;if(i>=o[o.length-mt.ENTRIES])h=o[o.length+mt.PREV_ROTATE],c=o[o.length+mt.PREV_TRANSLATE];else{let t=Q.binarySearch(o,i,mt.ENTRIES);h=o[t+mt.PREV_ROTATE],c=o[t+mt.PREV_TRANSLATE];let e=o[t],s=this.getCurvePercent(t/mt.ENTRIES-1,1-(i-e)/(o[t+mt.PREV_TIME]-e));h+=(o[t+mt.ROTATE]-h)*s,c+=(o[t+mt.TRANSLATE]-c)*s}a==d.setup?(l.rotateMix=l.data.rotateMix+(h-l.data.rotateMix)*n,l.translateMix=l.data.translateMix+(c-l.data.translateMix)*n):(l.rotateMix+=(h-l.rotateMix)*n,l.translateMix+=(c-l.translateMix)*n)}}var gt;!function(t){t[t.Region=0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path",t[t.Point=5]="Point",t[t.Clipping=6]="Clipping"}(gt||(gt={}));class pt{data;intValue;floatValue;stringValue;time;volume;balance;constructor(t,e){if(null==e)throw new Error("data cannot be null.");this.time=t,this.data=e}}class ft{name;intValue;floatValue;stringValue;audioPath;volume;balance;constructor(t){this.name=t}}class wt extends G{bones=new Array;target;bendDirection=1;compress=!1;stretch=!1;uniform=!1;mix=1;softness=0;constructor(t){super(t,0,!1)}}class xt{name;bones=new Array;slots=new Array;skins=new Array;defaultSkin;events=new Array;animations=new Array;ikConstraints=new Array;transformConstraints=new Array;pathConstraints=new Array;x;y;width;height;version;hash;fps=0;imagesPath;audioPath;findBone(t){if(null==t)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.name==t)return s}return null}findBoneIndex(t){if(null==t)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,s=e.length;i<s;i++)if(e[i].name==t)return i;return-1}findSlot(t){if(null==t)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.name==t)return s}return null}findSlotIndex(t){if(null==t)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,s=e.length;i<s;i++)if(e[i].name==t)return i;return-1}findSkin(t){if(null==t)throw new Error("skinName cannot be null.");let e=this.skins;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.name==t)return s}return null}findEvent(t){if(null==t)throw new Error("eventDataName cannot be null.");let e=this.events;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.name==t)return s}return null}findAnimation(t){if(null==t)throw new Error("animationName cannot be null.");let e=this.animations;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.name==t)return s}return null}findIkConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");let e=this.ikConstraints;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.name==t)return s}return null}findTransformConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");let e=this.transformConstraints;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.name==t)return s}return null}findPathConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");let e=this.pathConstraints;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.name==t)return s}return null}findPathConstraintIndex(t){if(null==t)throw new Error("pathConstraintName cannot be null.");let e=this.pathConstraints;for(let i=0,s=e.length;i<s;i++)if(e[i].name==t)return i;return-1}}class bt{slotIndex;name;attachment;constructor(t,e,i){this.slotIndex=t,this.name=e,this.attachment=i}}class yt{name;attachments=new Array;bones=Array();constraints=new Array;constructor(t){if(null==t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,i){if(null==i)throw new Error("attachment cannot be null.");let s=this.attachments;t>=s.length&&(s.length=t+1),s[t]||(s[t]={}),s[t][e]=i}addSkin(t){for(let e=0;e<t.bones.length;e++){let i=t.bones[e],s=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==i){s=!0;break}s||this.bones.push(i)}for(let e=0;e<t.constraints.length;e++){let i=t.constraints[e],s=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==i){s=!0;break}s||this.constraints.push(i)}let e=t.getAttachments();for(let t=0;t<e.length;t++){var i=e[t];this.setAttachment(i.slotIndex,i.name,i.attachment)}}copySkin(t){for(let e=0;e<t.bones.length;e++){let i=t.bones[e],s=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==i){s=!0;break}s||this.bones.push(i)}for(let e=0;e<t.constraints.length;e++){let i=t.constraints[e],s=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==i){s=!0;break}s||this.constraints.push(i)}let e=t.getAttachments();for(let t=0;t<e.length;t++){var i=e[t];null!=i.attachment&&(i.attachment instanceof Y?(i.attachment=i.attachment.newLinkedMesh(),this.setAttachment(i.slotIndex,i.name,i.attachment)):(i.attachment=i.attachment.copy(),this.setAttachment(i.slotIndex,i.name,i.attachment)))}}getAttachment(t,e){let i=this.attachments[t];return i?i[e]:null}removeAttachment(t,e){let i=this.attachments[t];i&&(i[e]=null)}getAttachments(){let t=new Array;for(var e=0;e<this.attachments.length;e++){let i=this.attachments[e];if(i)for(let s in i){let n=i[s];n&&t.push(new bt(e,s,n))}}return t}getAttachmentsForSlot(t,e){let i=this.attachments[t];if(i)for(let s in i){let n=i[s];n&&e.push(new bt(t,s,n))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let i=0;for(let s=0;s<t.slots.length;s++){let n=t.slots[s],a=n.getAttachment();if(a&&i<e.attachments.length){let t=e.attachments[i];for(let e in t)if(a==t[e]){let t=this.getAttachment(i,e);null!=t&&n.setAttachment(t);break}}i++}}}class vt{index;name;boneData;color=new R(1,1,1,1);darkColor;attachmentName;blendMode;constructor(t,e,i){if(t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");if(null==i)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=i}}class At extends G{bones=new Array;target;rotateMix=0;translateMix=0;scaleMix=0;shearMix=0;offsetRotation=0;offsetX=0;offsetY=0;offsetScaleX=0;offsetScaleY=0;offsetShearY=0;relative=!1;local=!1;constructor(t){super(t,0,!1)}}class Et{static AttachmentTypeValues=[0,1,2,3,4,5,6];static TransformModeValues=[o.Normal,o.OnlyTranslation,o.NoRotationOrReflection,o.NoScale,o.NoScaleOrReflection];static PositionModeValues=[l.Fixed,l.Percent];static SpacingModeValues=[h.Length,h.Fixed,h.Percent];static RotateModeValues=[c.Tangent,c.Chain,c.ChainScale];static BlendModeValues=[r.Normal,r.Additive,r.Multiply,r.Screen];static BONE_ROTATE=0;static BONE_TRANSLATE=1;static BONE_SCALE=2;static BONE_SHEAR=3;static SLOT_ATTACHMENT=0;static SLOT_COLOR=1;static SLOT_TWO_COLOR=2;static PATH_POSITION=0;static PATH_SPACING=1;static PATH_MIX=2;static CURVE_LINEAR=0;static CURVE_STEPPED=1;static CURVE_BEZIER=2;scale=1;attachmentLoader;linkedMeshes=new Array;constructor(t){this.attachmentLoader=t}readSkeletonData(t){let e=this.scale,i=new xt;i.name="";let s=new Mt(t);if(i.hash=s.readString(),i.version=s.readString(),"3.8.75"==i.version)throw new Error("Unsupported skeleton data, please export with a newer version of Spine.");i.x=s.readFloat(),i.y=s.readFloat(),i.width=s.readFloat(),i.height=s.readFloat();let n=s.readBoolean();n&&(i.fps=s.readFloat(),i.imagesPath=s.readString(),i.audioPath=s.readString());let a=0;a=s.readInt(!0);for(let t=0;t<a;t++)s.strings.push(s.readString());a=s.readInt(!0);for(let t=0;t<a;t++){let a=s.readString(),r=0==t?null:i.bones[s.readInt(!0)],o=new _(t,a,r);o.rotation=s.readFloat(),o.x=s.readFloat()*e,o.y=s.readFloat()*e,o.scaleX=s.readFloat(),o.scaleY=s.readFloat(),o.shearX=s.readFloat(),o.shearY=s.readFloat(),o.length=s.readFloat()*e,o.transformMode=Et.TransformModeValues[s.readInt(!0)],o.skinRequired=s.readBoolean(),n&&R.rgba8888ToColor(o.color,s.readInt32()),i.bones.push(o)}a=s.readInt(!0);for(let t=0;t<a;t++){let e=s.readString(),n=i.bones[s.readInt(!0)],a=new vt(t,e,n);R.rgba8888ToColor(a.color,s.readInt32());let r=s.readInt32();-1!=r&&R.rgb888ToColor(a.darkColor=new R,r),a.attachmentName=s.readStringRef(),a.blendMode=Et.BlendModeValues[s.readInt(!0)],i.slots.push(a)}a=s.readInt(!0);for(let t,n=0;n<a;n++){let n=new wt(s.readString());n.order=s.readInt(!0),n.skinRequired=s.readBoolean(),t=s.readInt(!0);for(let e=0;e<t;e++)n.bones.push(i.bones[s.readInt(!0)]);n.target=i.bones[s.readInt(!0)],n.mix=s.readFloat(),n.softness=s.readFloat()*e,n.bendDirection=s.readByte(),n.compress=s.readBoolean(),n.stretch=s.readBoolean(),n.uniform=s.readBoolean(),i.ikConstraints.push(n)}a=s.readInt(!0);for(let t,n=0;n<a;n++){let n=new At(s.readString());n.order=s.readInt(!0),n.skinRequired=s.readBoolean(),t=s.readInt(!0);for(let e=0;e<t;e++)n.bones.push(i.bones[s.readInt(!0)]);n.target=i.bones[s.readInt(!0)],n.local=s.readBoolean(),n.relative=s.readBoolean(),n.offsetRotation=s.readFloat(),n.offsetX=s.readFloat()*e,n.offsetY=s.readFloat()*e,n.offsetScaleX=s.readFloat(),n.offsetScaleY=s.readFloat(),n.offsetShearY=s.readFloat(),n.rotateMix=s.readFloat(),n.translateMix=s.readFloat(),n.scaleMix=s.readFloat(),n.shearMix=s.readFloat(),i.transformConstraints.push(n)}a=s.readInt(!0);for(let t,n=0;n<a;n++){let n=new Z(s.readString());n.order=s.readInt(!0),n.skinRequired=s.readBoolean(),t=s.readInt(!0);for(let e=0;e<t;e++)n.bones.push(i.bones[s.readInt(!0)]);n.target=i.slots[s.readInt(!0)],n.positionMode=Et.PositionModeValues[s.readInt(!0)],n.spacingMode=Et.SpacingModeValues[s.readInt(!0)],n.rotateMode=Et.RotateModeValues[s.readInt(!0)],n.offsetRotation=s.readFloat(),n.position=s.readFloat(),n.positionMode==l.Fixed&&(n.position*=e),n.spacing=s.readFloat(),n.spacingMode!=h.Length&&n.spacingMode!=h.Fixed||(n.spacing*=e),n.rotateMix=s.readFloat(),n.translateMix=s.readFloat(),i.pathConstraints.push(n)}let r=this.readSkin(s,i,!0,n);null!=r&&(i.defaultSkin=r,i.skins.push(r));{let t=i.skins.length;for(T.setArraySize(i.skins,a=t+s.readInt(!0));t<a;t++)i.skins[t]=this.readSkin(s,i,!1,n)}a=this.linkedMeshes.length;for(let t=0;t<a;t++){let e=this.linkedMeshes[t],s=null==e.skin?i.defaultSkin:i.findSkin(e.skin);if(null==s)throw new Error("Skin not found: "+e.skin);let n=s.getAttachment(e.slotIndex,e.parent);if(null==n)throw new Error("Parent mesh not found: "+e.parent);e.mesh.deformAttachment=e.inheritDeform?n:e.mesh,e.mesh.setParentMesh(n),e.mesh.updateUVs()}this.linkedMeshes.length=0,a=s.readInt(!0);for(let t=0;t<a;t++){let t=new ft(s.readStringRef());t.intValue=s.readInt(!1),t.floatValue=s.readFloat(),t.stringValue=s.readString(),t.audioPath=s.readString(),null!=t.audioPath&&(t.volume=s.readFloat(),t.balance=s.readFloat()),i.events.push(t)}a=s.readInt(!0);for(let t=0;t<a;t++)i.animations.push(this.readAnimation(s,s.readString(),i));return i}readSkin(t,e,i,s){let n=null,a=0;if(i){if(a=t.readInt(!0),0==a)return null;n=new yt("default")}else{n=new yt(t.readStringRef()),n.bones.length=t.readInt(!0);for(let i=0,s=n.bones.length;i<s;i++)n.bones[i]=e.bones[t.readInt(!0)];for(let i=0,s=t.readInt(!0);i<s;i++)n.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let i=0,s=t.readInt(!0);i<s;i++)n.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let i=0,s=t.readInt(!0);i<s;i++)n.constraints.push(e.pathConstraints[t.readInt(!0)]);a=t.readInt(!0)}for(let i=0;i<a;i++){let i=t.readInt(!0);for(let a=0,r=t.readInt(!0);a<r;a++){let a=t.readStringRef(),r=this.readAttachment(t,e,n,i,a,s);null!=r&&n.setAttachment(i,a,r)}}return n}readAttachment(t,e,i,s,n,a){let r=this.scale,o=t.readStringRef();null==o&&(o=n);let l=t.readByte();switch(Et.AttachmentTypeValues[l]){case gt.Region:{let e=t.readStringRef(),s=t.readFloat(),n=t.readFloat(),a=t.readFloat(),l=t.readFloat(),h=t.readFloat(),c=t.readFloat(),d=t.readFloat(),u=t.readInt32();null==e&&(e=o);let m=this.attachmentLoader.newRegionAttachment(i,o,e);return null==m?null:(m.path=e,m.x=n*r,m.y=a*r,m.scaleX=l,m.scaleY=h,m.rotation=s,m.width=c*r,m.height=d*r,R.rgba8888ToColor(m.color,u),m.updateOffset(),m)}case gt.BoundingBox:{let e=t.readInt(!0),s=this.readVertices(t,e),n=a?t.readInt32():0,r=this.attachmentLoader.newBoundingBoxAttachment(i,o);return null==r?null:(r.worldVerticesLength=e<<1,r.vertices=s.vertices,r.bones=s.bones,a&&R.rgba8888ToColor(r.color,n),r)}case gt.Mesh:{let e=t.readStringRef(),s=t.readInt32(),n=t.readInt(!0),l=this.readFloatArray(t,n<<1,1),h=this.readShortArray(t),c=this.readVertices(t,n),d=t.readInt(!0),u=null,m=0,g=0;a&&(u=this.readShortArray(t),m=t.readFloat(),g=t.readFloat()),null==e&&(e=o);let p=this.attachmentLoader.newMeshAttachment(i,o,e);return null==p?null:(p.path=e,R.rgba8888ToColor(p.color,s),p.bones=c.bones,p.vertices=c.vertices,p.worldVerticesLength=n<<1,p.triangles=h,p.regionUVs=l,p.updateUVs(),p.hullLength=d<<1,a&&(p.edges=u,p.width=m*r,p.height=g*r),p)}case gt.LinkedMesh:{let e=t.readStringRef(),n=t.readInt32(),l=t.readStringRef(),h=t.readStringRef(),c=t.readBoolean(),d=0,u=0;a&&(d=t.readFloat(),u=t.readFloat()),null==e&&(e=o);let m=this.attachmentLoader.newMeshAttachment(i,o,e);return null==m?null:(m.path=e,R.rgba8888ToColor(m.color,n),a&&(m.width=d*r,m.height=u*r),this.linkedMeshes.push(new St(m,l,s,h,c)),m)}case gt.Path:{let e=t.readBoolean(),s=t.readBoolean(),n=t.readInt(!0),l=this.readVertices(t,n),h=T.newArray(n/3,0);for(let e=0,i=h.length;e<i;e++)h[e]=t.readFloat()*r;let c=a?t.readInt32():0,d=this.attachmentLoader.newPathAttachment(i,o);return null==d?null:(d.closed=e,d.constantSpeed=s,d.worldVerticesLength=n<<1,d.vertices=l.vertices,d.bones=l.bones,d.lengths=h,a&&R.rgba8888ToColor(d.color,c),d)}case gt.Point:{let e=t.readFloat(),s=t.readFloat(),n=t.readFloat(),l=a?t.readInt32():0,h=this.attachmentLoader.newPointAttachment(i,o);return null==h?null:(h.x=s*r,h.y=n*r,h.rotation=e,a&&R.rgba8888ToColor(h.color,l),h)}case gt.Clipping:{let s=t.readInt(!0),n=t.readInt(!0),r=this.readVertices(t,n),l=a?t.readInt32():0,h=this.attachmentLoader.newClippingAttachment(i,o);return null==h?null:(h.endSlot=e.slots[s],h.worldVerticesLength=n<<1,h.vertices=r.vertices,h.bones=r.bones,a&&R.rgba8888ToColor(h.color,l),h)}}return null}readVertices(t,e){let i=e<<1,s=new Rt,n=this.scale;if(!t.readBoolean())return s.vertices=this.readFloatArray(t,i,n),s;let a=new Array,r=new Array;for(let i=0;i<e;i++){let e=t.readInt(!0);r.push(e);for(let i=0;i<e;i++)r.push(t.readInt(!0)),a.push(t.readFloat()*n),a.push(t.readFloat()*n),a.push(t.readFloat())}return s.vertices=T.toFloatArray(a),s.bones=r,s}readFloatArray(t,e,i){let s=new Array(e);if(1==i)for(let i=0;i<e;i++)s[i]=t.readFloat();else for(let n=0;n<e;n++)s[n]=t.readFloat()*i;return s}readShortArray(t){let e=t.readInt(!0),i=new Array(e);for(let s=0;s<e;s++)i[s]=t.readShort();return i}readAnimation(t,e,i){let s=new Array,n=this.scale,a=0,r=new R,o=new R;for(let e=0,i=t.readInt(!0);e<i;e++){let e=t.readInt(!0);for(let i=0,n=t.readInt(!0);i<n;i++){let i=t.readByte(),n=t.readInt(!0);switch(i){case Et.SLOT_ATTACHMENT:{let i=new nt(n);i.slotIndex=e;for(let e=0;e<n;e++)i.setFrame(e,t.readFloat(),t.readStringRef());s.push(i),a=Math.max(a,i.frames[n-1]);break}case Et.SLOT_COLOR:{let i=new it(n);i.slotIndex=e;for(let e=0;e<n;e++){let s=t.readFloat();R.rgba8888ToColor(r,t.readInt32()),i.setFrame(e,s,r.r,r.g,r.b,r.a),e<n-1&&this.readCurve(t,e,i)}s.push(i),a=Math.max(a,i.frames[(n-1)*it.ENTRIES]);break}case Et.SLOT_TWO_COLOR:{let i=new st(n);i.slotIndex=e;for(let e=0;e<n;e++){let s=t.readFloat();R.rgba8888ToColor(r,t.readInt32()),R.rgb888ToColor(o,t.readInt32()),i.setFrame(e,s,r.r,r.g,r.b,r.a,o.r,o.g,o.b),e<n-1&&this.readCurve(t,e,i)}s.push(i),a=Math.max(a,i.frames[(n-1)*st.ENTRIES]);break}}}}for(let e=0,i=t.readInt(!0);e<i;e++){let e=t.readInt(!0);for(let i=0,r=t.readInt(!0);i<r;i++){let i=t.readByte(),r=t.readInt(!0);switch(i){case Et.BONE_ROTATE:{let i=new K(r);i.boneIndex=e;for(let e=0;e<r;e++)i.setFrame(e,t.readFloat(),t.readFloat()),e<r-1&&this.readCurve(t,e,i);s.push(i),a=Math.max(a,i.frames[(r-1)*K.ENTRIES]);break}case Et.BONE_TRANSLATE:case Et.BONE_SCALE:case Et.BONE_SHEAR:{let o,l=1;i==Et.BONE_SCALE?o=new tt(r):i==Et.BONE_SHEAR?o=new et(r):(o=new $(r),l=n),o.boneIndex=e;for(let e=0;e<r;e++)o.setFrame(e,t.readFloat(),t.readFloat()*l,t.readFloat()*l),e<r-1&&this.readCurve(t,e,o);s.push(o),a=Math.max(a,o.frames[(r-1)*$.ENTRIES]);break}}}}for(let e=0,i=t.readInt(!0);e<i;e++){let e=t.readInt(!0),i=t.readInt(!0),r=new ht(i);r.ikConstraintIndex=e;for(let e=0;e<i;e++)r.setFrame(e,t.readFloat(),t.readFloat(),t.readFloat()*n,t.readByte(),t.readBoolean(),t.readBoolean()),e<i-1&&this.readCurve(t,e,r);s.push(r),a=Math.max(a,r.frames[(i-1)*ht.ENTRIES])}for(let e=0,i=t.readInt(!0);e<i;e++){let e=t.readInt(!0),i=t.readInt(!0),n=new ct(i);n.transformConstraintIndex=e;for(let e=0;e<i;e++)n.setFrame(e,t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat()),e<i-1&&this.readCurve(t,e,n);s.push(n),a=Math.max(a,n.frames[(i-1)*ct.ENTRIES])}for(let e=0,r=t.readInt(!0);e<r;e++){let e=t.readInt(!0),r=i.pathConstraints[e];for(let i=0,o=t.readInt(!0);i<o;i++){let i=t.readByte(),o=t.readInt(!0);switch(i){case Et.PATH_POSITION:case Et.PATH_SPACING:{let c,d=1;i==Et.PATH_SPACING?(c=new ut(o),r.spacingMode!=h.Length&&r.spacingMode!=h.Fixed||(d=n)):(c=new dt(o),r.positionMode==l.Fixed&&(d=n)),c.pathConstraintIndex=e;for(let e=0;e<o;e++)c.setFrame(e,t.readFloat(),t.readFloat()*d),e<o-1&&this.readCurve(t,e,c);s.push(c),a=Math.max(a,c.frames[(o-1)*dt.ENTRIES]);break}case Et.PATH_MIX:{let i=new mt(o);i.pathConstraintIndex=e;for(let e=0;e<o;e++)i.setFrame(e,t.readFloat(),t.readFloat(),t.readFloat()),e<o-1&&this.readCurve(t,e,i);s.push(i),a=Math.max(a,i.frames[(o-1)*mt.ENTRIES]);break}}}}for(let e=0,r=t.readInt(!0);e<r;e++){let e=i.skins[t.readInt(!0)];for(let i=0,r=t.readInt(!0);i<r;i++){let i=t.readInt(!0);for(let r=0,o=t.readInt(!0);r<o;r++){let r=e.getAttachment(i,t.readStringRef()),o=null!=r.bones,l=r.vertices,h=o?l.length/3*2:l.length,c=t.readInt(!0),d=new rt(c);d.slotIndex=i,d.attachment=r;for(let e=0;e<c;e++){let i,s=t.readFloat(),a=t.readInt(!0);if(0==a)i=o?T.newFloatArray(h):l;else{i=T.newFloatArray(h);let e=t.readInt(!0);if(a+=e,1==n)for(let s=e;s<a;s++)i[s]=t.readFloat();else for(let s=e;s<a;s++)i[s]=t.readFloat()*n;if(!o)for(let t=0,e=i.length;t<e;t++)i[t]+=l[t]}d.setFrame(e,s,i),e<c-1&&this.readCurve(t,e,d)}s.push(d),a=Math.max(a,d.frames[c-1])}}}let c=t.readInt(!0);if(c>0){let e=new lt(c),n=i.slots.length;for(let i=0;i<c;i++){let s=t.readFloat(),a=t.readInt(!0),r=T.newArray(n,0);for(let t=n-1;t>=0;t--)r[t]=-1;let o=T.newArray(n-a,0),l=0,h=0;for(let e=0;e<a;e++){let e=t.readInt(!0);for(;l!=e;)o[h++]=l++;r[l+t.readInt(!0)]=l++}for(;l<n;)o[h++]=l++;for(let t=n-1;t>=0;t--)-1==r[t]&&(r[t]=o[--h]);e.setFrame(i,s,r)}s.push(e),a=Math.max(a,e.frames[c-1])}let d=t.readInt(!0);if(d>0){let e=new ot(d);for(let s=0;s<d;s++){let n=t.readFloat(),a=i.events[t.readInt(!0)],r=new pt(n,a);r.intValue=t.readInt(!1),r.floatValue=t.readFloat(),r.stringValue=t.readBoolean()?t.readString():a.stringValue,null!=r.data.audioPath&&(r.volume=t.readFloat(),r.balance=t.readFloat()),e.setFrame(s,r)}s.push(e),a=Math.max(a,e.frames[d-1])}return new Q(e,s,a)}readCurve(t,e,i){switch(t.readByte()){case Et.CURVE_STEPPED:i.setStepped(e);break;case Et.CURVE_BEZIER:this.setCurve(i,e,t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat())}}setCurve(t,e,i,s,n,a){t.setCurve(e,i,s,n,a)}}class Mt{strings;index;buffer;constructor(t,e=new Array,i=0,s=new DataView(t.buffer)){this.strings=e,this.index=i,this.buffer=s}readByte(){return this.buffer.getInt8(this.index++)}readShort(){let t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){let t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){let e=this.readByte(),i=127&e;return 128&e&&(e=this.readByte(),i|=(127&e)<<7,128&e&&(e=this.readByte(),i|=(127&e)<<14,128&e&&(e=this.readByte(),i|=(127&e)<<21,128&e&&(e=this.readByte(),i|=(127&e)<<28)))),t?i:i>>>1^-(1&i)}readStringRef(){let t=this.readInt(!0);return 0==t?null:this.strings[t-1]}readString(){let t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;let e="";for(let i=0;i<t;){let t=this.readByte();switch(t>>4){case 12:case 13:e+=String.fromCharCode((31&t)<<6|63&this.readByte()),i+=2;break;case 14:e+=String.fromCharCode((15&t)<<12|(63&this.readByte())<<6|63&this.readByte()),i+=3;break;default:e+=String.fromCharCode(t),i++}}return e}readFloat(){let t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return 0!=this.readByte()}}class St{parent;skin;slotIndex;mesh;inheritDeform;constructor(t,e,i,s,n){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=s,this.inheritDeform=n}}class Rt{bones;vertices;constructor(t=null,e=null){this.bones=t,this.vertices=e}}class It{attachmentLoader;scale=1;linkedMeshes=new Array;constructor(t){this.attachmentLoader=t}readSkeletonData(t){let e=this.scale,i=new xt,s="string"==typeof t?JSON.parse(t):t,n=s.skeleton;if(null!=n){if(i.hash=n.hash,i.version=n.spine,"3.8.75"==i.version)throw new Error("Unsupported skeleton data, please export with a newer version of Spine.");i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height,i.fps=n.fps,i.imagesPath=n.images}if(s.bones)for(let t=0;t<s.bones.length;t++){let n=s.bones[t],a=null,r=this.getValue(n,"parent",null);if(null!=r&&(a=i.findBone(r),null==a))throw new Error("Parent bone not found: "+r);let o=new _(i.bones.length,n.name,a);o.length=this.getValue(n,"length",0)*e,o.x=this.getValue(n,"x",0)*e,o.y=this.getValue(n,"y",0)*e,o.rotation=this.getValue(n,"rotation",0),o.scaleX=this.getValue(n,"scaleX",1),o.scaleY=this.getValue(n,"scaleY",1),o.shearX=this.getValue(n,"shearX",0),o.shearY=this.getValue(n,"shearY",0),o.transformMode=It.transformModeFromString(this.getValue(n,"transform","normal")),o.skinRequired=this.getValue(n,"skin",!1),i.bones.push(o)}if(s.slots)for(let t=0;t<s.slots.length;t++){let e=s.slots[t],n=e.name,a=e.bone,r=i.findBone(a);if(null==r)throw new Error("Slot bone not found: "+a);let o=new vt(i.slots.length,n,r),l=this.getValue(e,"color",null);null!=l&&o.color.setFromString(l);let h=this.getValue(e,"dark",null);null!=h&&(o.darkColor=new R(1,1,1,1),o.darkColor.setFromString(h)),o.attachmentName=this.getValue(e,"attachment",null),o.blendMode=It.blendModeFromString(this.getValue(e,"blend","normal")),i.slots.push(o)}if(s.ik)for(let t=0;t<s.ik.length;t++){let n=s.ik[t],a=new wt(n.name);a.order=this.getValue(n,"order",0),a.skinRequired=this.getValue(n,"skin",!1);for(let t=0;t<n.bones.length;t++){let e=n.bones[t],s=i.findBone(e);if(null==s)throw new Error("IK bone not found: "+e);a.bones.push(s)}let r=n.target;if(a.target=i.findBone(r),null==a.target)throw new Error("IK target bone not found: "+r);a.mix=this.getValue(n,"mix",1),a.softness=this.getValue(n,"softness",0)*e,a.bendDirection=this.getValue(n,"bendPositive",!0)?1:-1,a.compress=this.getValue(n,"compress",!1),a.stretch=this.getValue(n,"stretch",!1),a.uniform=this.getValue(n,"uniform",!1),i.ikConstraints.push(a)}if(s.transform)for(let t=0;t<s.transform.length;t++){let n=s.transform[t],a=new At(n.name);a.order=this.getValue(n,"order",0),a.skinRequired=this.getValue(n,"skin",!1);for(let t=0;t<n.bones.length;t++){let e=n.bones[t],s=i.findBone(e);if(null==s)throw new Error("Transform constraint bone not found: "+e);a.bones.push(s)}let r=n.target;if(a.target=i.findBone(r),null==a.target)throw new Error("Transform constraint target bone not found: "+r);a.local=this.getValue(n,"local",!1),a.relative=this.getValue(n,"relative",!1),a.offsetRotation=this.getValue(n,"rotation",0),a.offsetX=this.getValue(n,"x",0)*e,a.offsetY=this.getValue(n,"y",0)*e,a.offsetScaleX=this.getValue(n,"scaleX",0),a.offsetScaleY=this.getValue(n,"scaleY",0),a.offsetShearY=this.getValue(n,"shearY",0),a.rotateMix=this.getValue(n,"rotateMix",1),a.translateMix=this.getValue(n,"translateMix",1),a.scaleMix=this.getValue(n,"scaleMix",1),a.shearMix=this.getValue(n,"shearMix",1),i.transformConstraints.push(a)}if(s.path)for(let t=0;t<s.path.length;t++){let n=s.path[t],a=new Z(n.name);a.order=this.getValue(n,"order",0),a.skinRequired=this.getValue(n,"skin",!1);for(let t=0;t<n.bones.length;t++){let e=n.bones[t],s=i.findBone(e);if(null==s)throw new Error("Transform constraint bone not found: "+e);a.bones.push(s)}let r=n.target;if(a.target=i.findSlot(r),null==a.target)throw new Error("Path target slot not found: "+r);a.positionMode=It.positionModeFromString(this.getValue(n,"positionMode","percent")),a.spacingMode=It.spacingModeFromString(this.getValue(n,"spacingMode","length")),a.rotateMode=It.rotateModeFromString(this.getValue(n,"rotateMode","tangent")),a.offsetRotation=this.getValue(n,"rotation",0),a.position=this.getValue(n,"position",0),a.positionMode==l.Fixed&&(a.position*=e),a.spacing=this.getValue(n,"spacing",0),a.spacingMode!=h.Length&&a.spacingMode!=h.Fixed||(a.spacing*=e),a.rotateMix=this.getValue(n,"rotateMix",1),a.translateMix=this.getValue(n,"translateMix",1),i.pathConstraints.push(a)}if(s.skins)for(let t=0;t<s.skins.length;t++){let e=s.skins[t],n=new yt(e.name);if(e.bones)for(let s=0;s<e.bones.length;s++){let a=i.findBone(e.bones[s]);if(null==a)throw new Error("Skin bone not found: "+e.bones[t]);n.bones.push(a)}if(e.ik)for(let s=0;s<e.ik.length;s++){let a=i.findIkConstraint(e.ik[s]);if(null==a)throw new Error("Skin IK constraint not found: "+e.ik[t]);n.constraints.push(a)}if(e.transform)for(let s=0;s<e.transform.length;s++){let a=i.findTransformConstraint(e.transform[s]);if(null==a)throw new Error("Skin transform constraint not found: "+e.transform[t]);n.constraints.push(a)}if(e.path)for(let s=0;s<e.path.length;s++){let a=i.findPathConstraint(e.path[s]);if(null==a)throw new Error("Skin path constraint not found: "+e.path[t]);n.constraints.push(a)}for(let t in e.attachments){let s=i.findSlot(t);if(null==s)throw new Error("Slot not found: "+t);let a=e.attachments[t];for(let t in a){let e=this.readAttachment(a[t],n,s.index,t,i);null!=e&&n.setAttachment(s.index,t,e)}}i.skins.push(n),"default"==n.name&&(i.defaultSkin=n)}for(let t=0,e=this.linkedMeshes.length;t<e;t++){let e=this.linkedMeshes[t],s=null==e.skin?i.defaultSkin:i.findSkin(e.skin);if(null==s)throw new Error("Skin not found: "+e.skin);let n=s.getAttachment(e.slotIndex,e.parent);if(null==n)throw new Error("Parent mesh not found: "+e.parent);e.mesh.deformAttachment=e.inheritDeform?n:e.mesh,e.mesh.setParentMesh(n),e.mesh.updateUVs()}if(this.linkedMeshes.length=0,s.events)for(let t in s.events){let e=s.events[t],n=new ft(t);n.intValue=this.getValue(e,"int",0),n.floatValue=this.getValue(e,"float",0),n.stringValue=this.getValue(e,"string",""),n.audioPath=this.getValue(e,"audio",null),null!=n.audioPath&&(n.volume=this.getValue(e,"volume",1),n.balance=this.getValue(e,"balance",0)),i.events.push(n)}if(s.animations)for(let t in s.animations){let e=s.animations[t];this.readAnimation(e,t,i)}return i}readAttachment(t,e,i,s,n){let a=this.scale;switch(s=this.getValue(t,"name",s),this.getValue(t,"type","region")){case"region":{let i=this.getValue(t,"path",s),n=this.attachmentLoader.newRegionAttachment(e,s,i);if(null==n)return null;n.path=i,n.x=this.getValue(t,"x",0)*a,n.y=this.getValue(t,"y",0)*a,n.scaleX=this.getValue(t,"scaleX",1),n.scaleY=this.getValue(t,"scaleY",1),n.rotation=this.getValue(t,"rotation",0),n.width=t.width*a,n.height=t.height*a;let r=this.getValue(t,"color",null);return null!=r&&n.color.setFromString(r),n.updateOffset(),n}case"boundingbox":{let i=this.attachmentLoader.newBoundingBoxAttachment(e,s);if(null==i)return null;this.readVertices(t,i,t.vertexCount<<1);let n=this.getValue(t,"color",null);return null!=n&&i.color.setFromString(n),i}case"mesh":case"linkedmesh":{let n=this.getValue(t,"path",s),r=this.attachmentLoader.newMeshAttachment(e,s,n);if(null==r)return null;r.path=n;let o=this.getValue(t,"color",null);null!=o&&r.color.setFromString(o),r.width=this.getValue(t,"width",0)*a,r.height=this.getValue(t,"height",0)*a;let l=this.getValue(t,"parent",null);if(null!=l)return this.linkedMeshes.push(new Tt(r,this.getValue(t,"skin",null),i,l,this.getValue(t,"deform",!0))),r;let h=t.uvs;return this.readVertices(t,r,h.length),r.triangles=t.triangles,r.regionUVs=h,r.updateUVs(),r.edges=this.getValue(t,"edges",null),r.hullLength=2*this.getValue(t,"hull",0),r}case"path":{let i=this.attachmentLoader.newPathAttachment(e,s);if(null==i)return null;i.closed=this.getValue(t,"closed",!1),i.constantSpeed=this.getValue(t,"constantSpeed",!0);let n=t.vertexCount;this.readVertices(t,i,n<<1);let r=T.newArray(n/3,0);for(let e=0;e<t.lengths.length;e++)r[e]=t.lengths[e]*a;i.lengths=r;let o=this.getValue(t,"color",null);return null!=o&&i.color.setFromString(o),i}case"point":{let i=this.attachmentLoader.newPointAttachment(e,s);if(null==i)return null;i.x=this.getValue(t,"x",0)*a,i.y=this.getValue(t,"y",0)*a,i.rotation=this.getValue(t,"rotation",0);let n=this.getValue(t,"color",null);return null!=n&&i.color.setFromString(n),i}case"clipping":{let i=this.attachmentLoader.newClippingAttachment(e,s);if(null==i)return null;let a=this.getValue(t,"end",null);if(null!=a){let t=n.findSlot(a);if(null==t)throw new Error("Clipping end slot not found: "+a);i.endSlot=t}let r=t.vertexCount;this.readVertices(t,i,r<<1);let o=this.getValue(t,"color",null);return null!=o&&i.color.setFromString(o),i}}return null}readVertices(t,e,i){let s=this.scale;e.worldVerticesLength=i;let n=t.vertices;if(i==n.length){let t=T.toFloatArray(n);if(1!=s)for(let e=0,i=n.length;e<i;e++)t[e]*=s;return void(e.vertices=t)}let a=new Array,r=new Array;for(let t=0,e=n.length;t<e;){let e=n[t++];r.push(e);for(let i=t+4*e;t<i;t+=4)r.push(n[t]),a.push(n[t+1]*s),a.push(n[t+2]*s),a.push(n[t+3])}e.bones=r,e.vertices=T.toFloatArray(a)}readAnimation(t,e,i){let s=this.scale,n=new Array,a=0;if(t.slots)for(let e in t.slots){let s=t.slots[e],r=i.findSlotIndex(e);if(-1==r)throw new Error("Slot not found: "+e);for(let t in s){let i=s[t];if("attachment"==t){let t=new nt(i.length);t.slotIndex=r;let e=0;for(let s=0;s<i.length;s++){let n=i[s];t.setFrame(e++,this.getValue(n,"time",0),n.name)}n.push(t),a=Math.max(a,t.frames[t.getFrameCount()-1])}else if("color"==t){let t=new it(i.length);t.slotIndex=r;let e=0;for(let s=0;s<i.length;s++){let n=i[s],a=new R;a.setFromString(n.color),t.setFrame(e,this.getValue(n,"time",0),a.r,a.g,a.b,a.a),this.readCurve(n,t,e),e++}n.push(t),a=Math.max(a,t.frames[(t.getFrameCount()-1)*it.ENTRIES])}else{if("twoColor"!=t)throw new Error("Invalid timeline type for a slot: "+t+" ("+e+")");{let t=new st(i.length);t.slotIndex=r;let e=0;for(let s=0;s<i.length;s++){let n=i[s],a=new R,r=new R;a.setFromString(n.light),r.setFromString(n.dark),t.setFrame(e,this.getValue(n,"time",0),a.r,a.g,a.b,a.a,r.r,r.g,r.b),this.readCurve(n,t,e),e++}n.push(t),a=Math.max(a,t.frames[(t.getFrameCount()-1)*st.ENTRIES])}}}}if(t.bones)for(let e in t.bones){let r=t.bones[e],o=i.findBoneIndex(e);if(-1==o)throw new Error("Bone not found: "+e);for(let t in r){let i=r[t];if("rotate"===t){let t=new K(i.length);t.boneIndex=o;let e=0;for(let s=0;s<i.length;s++){let n=i[s];t.setFrame(e,this.getValue(n,"time",0),this.getValue(n,"angle",0)),this.readCurve(n,t,e),e++}n.push(t),a=Math.max(a,t.frames[(t.getFrameCount()-1)*K.ENTRIES])}else{if("translate"!==t&&"scale"!==t&&"shear"!==t)throw new Error("Invalid timeline type for a bone: "+t+" ("+e+")");{let e=null,r=1,l=0;"scale"===t?(e=new tt(i.length),l=1):"shear"===t?e=new et(i.length):(e=new $(i.length),r=s),e.boneIndex=o;let h=0;for(let t=0;t<i.length;t++){let s=i[t],n=this.getValue(s,"x",l),a=this.getValue(s,"y",l);e.setFrame(h,this.getValue(s,"time",0),n*r,a*r),this.readCurve(s,e,h),h++}n.push(e),a=Math.max(a,e.frames[(e.getFrameCount()-1)*$.ENTRIES])}}}}if(t.ik)for(let e in t.ik){let r=t.ik[e],o=i.findIkConstraint(e),l=new ht(r.length);l.ikConstraintIndex=i.ikConstraints.indexOf(o);let h=0;for(let t=0;t<r.length;t++){let e=r[t];l.setFrame(h,this.getValue(e,"time",0),this.getValue(e,"mix",1),this.getValue(e,"softness",0)*s,this.getValue(e,"bendPositive",!0)?1:-1,this.getValue(e,"compress",!1),this.getValue(e,"stretch",!1)),this.readCurve(e,l,h),h++}n.push(l),a=Math.max(a,l.frames[(l.getFrameCount()-1)*ht.ENTRIES])}if(t.transform)for(let e in t.transform){let s=t.transform[e],r=i.findTransformConstraint(e),o=new ct(s.length);o.transformConstraintIndex=i.transformConstraints.indexOf(r);let l=0;for(let t=0;t<s.length;t++){let e=s[t];o.setFrame(l,this.getValue(e,"time",0),this.getValue(e,"rotateMix",1),this.getValue(e,"translateMix",1),this.getValue(e,"scaleMix",1),this.getValue(e,"shearMix",1)),this.readCurve(e,o,l),l++}n.push(o),a=Math.max(a,o.frames[(o.getFrameCount()-1)*ct.ENTRIES])}if(t.path)for(let e in t.path){let r=t.path[e],o=i.findPathConstraintIndex(e);if(-1==o)throw new Error("Path constraint not found: "+e);let c=i.pathConstraints[o];for(let t in r){let e=r[t];if("position"===t||"spacing"===t){let i=null,r=1;"spacing"===t?(i=new ut(e.length),c.spacingMode!=h.Length&&c.spacingMode!=h.Fixed||(r=s)):(i=new dt(e.length),c.positionMode==l.Fixed&&(r=s)),i.pathConstraintIndex=o;let d=0;for(let s=0;s<e.length;s++){let n=e[s];i.setFrame(d,this.getValue(n,"time",0),this.getValue(n,t,0)*r),this.readCurve(n,i,d),d++}n.push(i),a=Math.max(a,i.frames[(i.getFrameCount()-1)*dt.ENTRIES])}else if("mix"===t){let t=new mt(e.length);t.pathConstraintIndex=o;let i=0;for(let s=0;s<e.length;s++){let n=e[s];t.setFrame(i,this.getValue(n,"time",0),this.getValue(n,"rotateMix",1),this.getValue(n,"translateMix",1)),this.readCurve(n,t,i),i++}n.push(t),a=Math.max(a,t.frames[(t.getFrameCount()-1)*mt.ENTRIES])}}}if(t.deform)for(let e in t.deform){let r=t.deform[e],o=i.findSkin(e);if(null==o)throw new Error("Skin not found: "+e);for(let t in r){let e=r[t],l=i.findSlotIndex(t);if(-1==l)throw new Error("Slot not found: "+e.name);for(let t in e){let i=e[t],r=o.getAttachment(l,t);if(null==r)throw new Error("Deform attachment not found: "+i.name);let h=null!=r.bones,c=r.vertices,d=h?c.length/3*2:c.length,u=new rt(i.length);u.slotIndex=l,u.attachment=r;let m=0;for(let t=0;t<i.length;t++){let e,n=i[t],a=this.getValue(n,"vertices",null);if(null==a)e=h?T.newFloatArray(d):c;else{e=T.newFloatArray(d);let t=this.getValue(n,"offset",0);if(T.arrayCopy(a,0,e,t,a.length),1!=s)for(let i=t,n=i+a.length;i<n;i++)e[i]*=s;if(!h)for(let t=0;t<d;t++)e[t]+=c[t]}u.setFrame(m,this.getValue(n,"time",0),e),this.readCurve(n,u,m),m++}n.push(u),a=Math.max(a,u.frames[u.getFrameCount()-1])}}}let r=t.drawOrder;if(null==r&&(r=t.draworder),null!=r){let t=new lt(r.length),e=i.slots.length,s=0;for(let n=0;n<r.length;n++){let a=r[n],o=null,l=this.getValue(a,"offsets",null);if(null!=l){o=T.newArray(e,-1);let t=T.newArray(e-l.length,0),s=0,n=0;for(let e=0;e<l.length;e++){let a=l[e],r=i.findSlotIndex(a.slot);if(-1==r)throw new Error("Slot not found: "+a.slot);for(;s!=r;)t[n++]=s++;o[s+a.offset]=s++}for(;s<e;)t[n++]=s++;for(let i=e-1;i>=0;i--)-1==o[i]&&(o[i]=t[--n])}t.setFrame(s++,this.getValue(a,"time",0),o)}n.push(t),a=Math.max(a,t.frames[t.getFrameCount()-1])}if(t.events){let e=new ot(t.events.length),s=0;for(let n=0;n<t.events.length;n++){let a=t.events[n],r=i.findEvent(a.name);if(null==r)throw new Error("Event not found: "+a.name);let o=new pt(T.toSinglePrecision(this.getValue(a,"time",0)),r);o.intValue=this.getValue(a,"int",r.intValue),o.floatValue=this.getValue(a,"float",r.floatValue),o.stringValue=this.getValue(a,"string",r.stringValue),null!=o.data.audioPath&&(o.volume=this.getValue(a,"volume",1),o.balance=this.getValue(a,"balance",0)),e.setFrame(s++,o)}n.push(e),a=Math.max(a,e.frames[e.getFrameCount()-1])}if(isNaN(a))throw new Error("Error while parsing animation, duration is NaN");i.animations.push(new Q(e,n,a))}readCurve(t,e,i){if(t.hasOwnProperty("curve"))if("stepped"==t.curve)e.setStepped(i);else{let s=t.curve;e.setCurve(i,s,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))}}getValue(t,e,i){return void 0!==t[e]?t[e]:i}static blendModeFromString(t){if("normal"==(t=t.toLowerCase()))return r.Normal;if("additive"==t)return r.Additive;if("multiply"==t)return r.Multiply;if("screen"==t)return r.Screen;throw new Error(`Unknown blend mode: ${t}`)}static positionModeFromString(t){if("fixed"==(t=t.toLowerCase()))return l.Fixed;if("percent"==t)return l.Percent;throw new Error(`Unknown position mode: ${t}`)}static spacingModeFromString(t){if("length"==(t=t.toLowerCase()))return h.Length;if("fixed"==t)return h.Fixed;if("percent"==t)return h.Percent;throw new Error(`Unknown position mode: ${t}`)}static rotateModeFromString(t){if("tangent"==(t=t.toLowerCase()))return c.Tangent;if("chain"==t)return c.Chain;if("chainscale"==t)return c.ChainScale;throw new Error(`Unknown rotate mode: ${t}`)}static transformModeFromString(t){if("normal"==(t=t.toLowerCase()))return o.Normal;if("onlytranslation"==t)return o.OnlyTranslation;if("norotationorreflection"==t)return o.NoRotationOrReflection;if("noscale"==t)return o.NoScale;if("noscaleorreflection"==t)return o.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${t}`)}}class Tt{parent;skin;slotIndex;mesh;inheritDeform;constructor(t,e,i,s,n){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=s,this.inheritDeform=n}}class Ct{x=0;y=0;z=0;w=0;constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}setFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}set(t,e,i){return this.x=t,this.y=e,this.z=i,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}scale(t){return this.x*=t,this.y*=t,this.z*=t,this}normalize(){let t=this.length();return 0==t||(t=1/t,this.x*=t,this.y*=t,this.z*=t),this}cross(t){return this.set(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}multiply(t){let e=t.values;return this.w=this.x*e[Wt]+this.y*e[Ut]+this.z*e[Gt]+e[Zt],this.set(this.x*e[Pt]+this.y*e[kt]+this.z*e[Vt]+e[Nt],this.x*e[Lt]+this.y*e[Ot]+this.z*e[Yt]+e[Dt],this.x*e[Ft]+this.y*e[Bt]+this.z*e[Xt]+e[_t])}project(t){let e=t.values;this.w=this.x*e[Wt]+this.y*e[Ut]+this.z*e[Gt]+e[Zt];let i=1/this.w;return this.set((this.x*e[Pt]+this.y*e[kt]+this.z*e[Vt]+e[Nt])*i,(this.x*e[Lt]+this.y*e[Ot]+this.z*e[Yt]+e[Dt])*i,(this.x*e[Ft]+this.y*e[Bt]+this.z*e[Xt]+e[_t])*i)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}distance(t){let e=t.x-this.x,i=t.y-this.y,s=t.z-this.z;return Math.sqrt(e*e+i*i+s*s)}copy(){return new Ct(this.x,this.y,this.z)}}const Pt=0,kt=4,Vt=8,Nt=12,Lt=1,Ot=5,Yt=9,Dt=13,Ft=2,Bt=6,Xt=10,_t=14,Wt=3,Ut=7,Gt=11,Zt=15;class zt{temp=new Float32Array(16);values=new Float32Array(16);static xAxis=null;static yAxis=null;static zAxis=null;static tmpMatrix=new zt;constructor(){let t=this.values;this.identity(),t[Pt]=1,t[Ot]=1,t[Xt]=1,t[Zt]=1}set(t){return this.values.set(t),this}transpose(){let t=this.temp,e=this.values;return t[Pt]=e[Pt],t[kt]=e[Lt],t[Vt]=e[Ft],t[Nt]=e[Wt],t[Lt]=e[kt],t[Ot]=e[Ot],t[Yt]=e[Bt],t[Dt]=e[Ut],t[Ft]=e[Vt],t[Bt]=e[Yt],t[Xt]=e[Xt],t[_t]=e[Gt],t[Wt]=e[Nt],t[Ut]=e[Dt],t[Gt]=e[_t],t[Zt]=e[Zt],this.set(t)}identity(){let t=this.values;return t[Pt]=1,t[kt]=0,t[Vt]=0,t[Nt]=0,t[Lt]=0,t[Ot]=1,t[Yt]=0,t[Dt]=0,t[Ft]=0,t[Bt]=0,t[Xt]=1,t[_t]=0,t[Wt]=0,t[Ut]=0,t[Gt]=0,t[Zt]=1,this}invert(){let t=this.values,e=this.temp,i=t[Wt]*t[Bt]*t[Yt]*t[Nt]-t[Ft]*t[Ut]*t[Yt]*t[Nt]-t[Wt]*t[Ot]*t[Xt]*t[Nt]+t[Lt]*t[Ut]*t[Xt]*t[Nt]+t[Ft]*t[Ot]*t[Gt]*t[Nt]-t[Lt]*t[Bt]*t[Gt]*t[Nt]-t[Wt]*t[Bt]*t[Vt]*t[Dt]+t[Ft]*t[Ut]*t[Vt]*t[Dt]+t[Wt]*t[kt]*t[Xt]*t[Dt]-t[Pt]*t[Ut]*t[Xt]*t[Dt]-t[Ft]*t[kt]*t[Gt]*t[Dt]+t[Pt]*t[Bt]*t[Gt]*t[Dt]+t[Wt]*t[Ot]*t[Vt]*t[_t]-t[Lt]*t[Ut]*t[Vt]*t[_t]-t[Wt]*t[kt]*t[Yt]*t[_t]+t[Pt]*t[Ut]*t[Yt]*t[_t]+t[Lt]*t[kt]*t[Gt]*t[_t]-t[Pt]*t[Ot]*t[Gt]*t[_t]-t[Ft]*t[Ot]*t[Vt]*t[Zt]+t[Lt]*t[Bt]*t[Vt]*t[Zt]+t[Ft]*t[kt]*t[Yt]*t[Zt]-t[Pt]*t[Bt]*t[Yt]*t[Zt]-t[Lt]*t[kt]*t[Xt]*t[Zt]+t[Pt]*t[Ot]*t[Xt]*t[Zt];if(0==i)throw new Error("non-invertible matrix");let s=1/i;return e[Pt]=t[Yt]*t[_t]*t[Ut]-t[Dt]*t[Xt]*t[Ut]+t[Dt]*t[Bt]*t[Gt]-t[Ot]*t[_t]*t[Gt]-t[Yt]*t[Bt]*t[Zt]+t[Ot]*t[Xt]*t[Zt],e[kt]=t[Nt]*t[Xt]*t[Ut]-t[Vt]*t[_t]*t[Ut]-t[Nt]*t[Bt]*t[Gt]+t[kt]*t[_t]*t[Gt]+t[Vt]*t[Bt]*t[Zt]-t[kt]*t[Xt]*t[Zt],e[Vt]=t[Vt]*t[Dt]*t[Ut]-t[Nt]*t[Yt]*t[Ut]+t[Nt]*t[Ot]*t[Gt]-t[kt]*t[Dt]*t[Gt]-t[Vt]*t[Ot]*t[Zt]+t[kt]*t[Yt]*t[Zt],e[Nt]=t[Nt]*t[Yt]*t[Bt]-t[Vt]*t[Dt]*t[Bt]-t[Nt]*t[Ot]*t[Xt]+t[kt]*t[Dt]*t[Xt]+t[Vt]*t[Ot]*t[_t]-t[kt]*t[Yt]*t[_t],e[Lt]=t[Dt]*t[Xt]*t[Wt]-t[Yt]*t[_t]*t[Wt]-t[Dt]*t[Ft]*t[Gt]+t[Lt]*t[_t]*t[Gt]+t[Yt]*t[Ft]*t[Zt]-t[Lt]*t[Xt]*t[Zt],e[Ot]=t[Vt]*t[_t]*t[Wt]-t[Nt]*t[Xt]*t[Wt]+t[Nt]*t[Ft]*t[Gt]-t[Pt]*t[_t]*t[Gt]-t[Vt]*t[Ft]*t[Zt]+t[Pt]*t[Xt]*t[Zt],e[Yt]=t[Nt]*t[Yt]*t[Wt]-t[Vt]*t[Dt]*t[Wt]-t[Nt]*t[Lt]*t[Gt]+t[Pt]*t[Dt]*t[Gt]+t[Vt]*t[Lt]*t[Zt]-t[Pt]*t[Yt]*t[Zt],e[Dt]=t[Vt]*t[Dt]*t[Ft]-t[Nt]*t[Yt]*t[Ft]+t[Nt]*t[Lt]*t[Xt]-t[Pt]*t[Dt]*t[Xt]-t[Vt]*t[Lt]*t[_t]+t[Pt]*t[Yt]*t[_t],e[Ft]=t[Ot]*t[_t]*t[Wt]-t[Dt]*t[Bt]*t[Wt]+t[Dt]*t[Ft]*t[Ut]-t[Lt]*t[_t]*t[Ut]-t[Ot]*t[Ft]*t[Zt]+t[Lt]*t[Bt]*t[Zt],e[Bt]=t[Nt]*t[Bt]*t[Wt]-t[kt]*t[_t]*t[Wt]-t[Nt]*t[Ft]*t[Ut]+t[Pt]*t[_t]*t[Ut]+t[kt]*t[Ft]*t[Zt]-t[Pt]*t[Bt]*t[Zt],e[Xt]=t[kt]*t[Dt]*t[Wt]-t[Nt]*t[Ot]*t[Wt]+t[Nt]*t[Lt]*t[Ut]-t[Pt]*t[Dt]*t[Ut]-t[kt]*t[Lt]*t[Zt]+t[Pt]*t[Ot]*t[Zt],e[_t]=t[Nt]*t[Ot]*t[Ft]-t[kt]*t[Dt]*t[Ft]-t[Nt]*t[Lt]*t[Bt]+t[Pt]*t[Dt]*t[Bt]+t[kt]*t[Lt]*t[_t]-t[Pt]*t[Ot]*t[_t],e[Wt]=t[Yt]*t[Bt]*t[Wt]-t[Ot]*t[Xt]*t[Wt]-t[Yt]*t[Ft]*t[Ut]+t[Lt]*t[Xt]*t[Ut]+t[Ot]*t[Ft]*t[Gt]-t[Lt]*t[Bt]*t[Gt],e[Ut]=t[kt]*t[Xt]*t[Wt]-t[Vt]*t[Bt]*t[Wt]+t[Vt]*t[Ft]*t[Ut]-t[Pt]*t[Xt]*t[Ut]-t[kt]*t[Ft]*t[Gt]+t[Pt]*t[Bt]*t[Gt],e[Gt]=t[Vt]*t[Ot]*t[Wt]-t[kt]*t[Yt]*t[Wt]-t[Vt]*t[Lt]*t[Ut]+t[Pt]*t[Yt]*t[Ut]+t[kt]*t[Lt]*t[Gt]-t[Pt]*t[Ot]*t[Gt],e[Zt]=t[kt]*t[Yt]*t[Ft]-t[Vt]*t[Ot]*t[Ft]+t[Vt]*t[Lt]*t[Bt]-t[Pt]*t[Yt]*t[Bt]-t[kt]*t[Lt]*t[Xt]+t[Pt]*t[Ot]*t[Xt],t[Pt]=e[Pt]*s,t[kt]=e[kt]*s,t[Vt]=e[Vt]*s,t[Nt]=e[Nt]*s,t[Lt]=e[Lt]*s,t[Ot]=e[Ot]*s,t[Yt]=e[Yt]*s,t[Dt]=e[Dt]*s,t[Ft]=e[Ft]*s,t[Bt]=e[Bt]*s,t[Xt]=e[Xt]*s,t[_t]=e[_t]*s,t[Wt]=e[Wt]*s,t[Ut]=e[Ut]*s,t[Gt]=e[Gt]*s,t[Zt]=e[Zt]*s,this}determinant(){let t=this.values;return t[Wt]*t[Bt]*t[Yt]*t[Nt]-t[Ft]*t[Ut]*t[Yt]*t[Nt]-t[Wt]*t[Ot]*t[Xt]*t[Nt]+t[Lt]*t[Ut]*t[Xt]*t[Nt]+t[Ft]*t[Ot]*t[Gt]*t[Nt]-t[Lt]*t[Bt]*t[Gt]*t[Nt]-t[Wt]*t[Bt]*t[Vt]*t[Dt]+t[Ft]*t[Ut]*t[Vt]*t[Dt]+t[Wt]*t[kt]*t[Xt]*t[Dt]-t[Pt]*t[Ut]*t[Xt]*t[Dt]-t[Ft]*t[kt]*t[Gt]*t[Dt]+t[Pt]*t[Bt]*t[Gt]*t[Dt]+t[Wt]*t[Ot]*t[Vt]*t[_t]-t[Lt]*t[Ut]*t[Vt]*t[_t]-t[Wt]*t[kt]*t[Yt]*t[_t]+t[Pt]*t[Ut]*t[Yt]*t[_t]+t[Lt]*t[kt]*t[Gt]*t[_t]-t[Pt]*t[Ot]*t[Gt]*t[_t]-t[Ft]*t[Ot]*t[Vt]*t[Zt]+t[Lt]*t[Bt]*t[Vt]*t[Zt]+t[Ft]*t[kt]*t[Yt]*t[Zt]-t[Pt]*t[Bt]*t[Yt]*t[Zt]-t[Lt]*t[kt]*t[Xt]*t[Zt]+t[Pt]*t[Ot]*t[Xt]*t[Zt]}translate(t,e,i){let s=this.values;return s[Nt]+=t,s[Dt]+=e,s[_t]+=i,this}copy(){return(new zt).set(this.values)}projection(t,e,i,s){this.identity();let n=i*(Math.PI/180),a=t*(1/Math.tan(n/2)),r=a*s,o=this.values;return o[Pt]=t/r,o[Lt]=0,o[Ft]=0,o[Wt]=0,o[kt]=0,o[Ot]=t/a,o[Bt]=0,o[Ut]=0,o[Vt]=0,o[Yt]=0,o[Xt]=-(e+t)/(e-t),o[Gt]=-1,o[Nt]=0,o[Dt]=0,o[_t]=-2*e*t/(e-t),o[Zt]=0,this}ortho2d(t,e,i,s){return this.ortho(t,t+i,e,e+s,0,1)}ortho(t,e,i,s,n,a){this.identity();let r=2/(e-t),o=2/(s-i),l=-2/(a-n),h=-(e+t)/(e-t),c=-(s+i)/(s-i),d=-(a+n)/(a-n),u=this.values;return u[Pt]=r,u[Lt]=0,u[Ft]=0,u[Wt]=0,u[kt]=0,u[Ot]=o,u[Bt]=0,u[Ut]=0,u[Vt]=0,u[Yt]=0,u[Xt]=l,u[Gt]=0,u[Nt]=h,u[Dt]=c,u[_t]=d,u[Zt]=1,this}multiply(t){let e=this.temp,i=this.values,s=t.values;return e[Pt]=i[Pt]*s[Pt]+i[kt]*s[Lt]+i[Vt]*s[Ft]+i[Nt]*s[Wt],e[kt]=i[Pt]*s[kt]+i[kt]*s[Ot]+i[Vt]*s[Bt]+i[Nt]*s[Ut],e[Vt]=i[Pt]*s[Vt]+i[kt]*s[Yt]+i[Vt]*s[Xt]+i[Nt]*s[Gt],e[Nt]=i[Pt]*s[Nt]+i[kt]*s[Dt]+i[Vt]*s[_t]+i[Nt]*s[Zt],e[Lt]=i[Lt]*s[Pt]+i[Ot]*s[Lt]+i[Yt]*s[Ft]+i[Dt]*s[Wt],e[Ot]=i[Lt]*s[kt]+i[Ot]*s[Ot]+i[Yt]*s[Bt]+i[Dt]*s[Ut],e[Yt]=i[Lt]*s[Vt]+i[Ot]*s[Yt]+i[Yt]*s[Xt]+i[Dt]*s[Gt],e[Dt]=i[Lt]*s[Nt]+i[Ot]*s[Dt]+i[Yt]*s[_t]+i[Dt]*s[Zt],e[Ft]=i[Ft]*s[Pt]+i[Bt]*s[Lt]+i[Xt]*s[Ft]+i[_t]*s[Wt],e[Bt]=i[Ft]*s[kt]+i[Bt]*s[Ot]+i[Xt]*s[Bt]+i[_t]*s[Ut],e[Xt]=i[Ft]*s[Vt]+i[Bt]*s[Yt]+i[Xt]*s[Xt]+i[_t]*s[Gt],e[_t]=i[Ft]*s[Nt]+i[Bt]*s[Dt]+i[Xt]*s[_t]+i[_t]*s[Zt],e[Wt]=i[Wt]*s[Pt]+i[Ut]*s[Lt]+i[Gt]*s[Ft]+i[Zt]*s[Wt],e[Ut]=i[Wt]*s[kt]+i[Ut]*s[Ot]+i[Gt]*s[Bt]+i[Zt]*s[Ut],e[Gt]=i[Wt]*s[Vt]+i[Ut]*s[Yt]+i[Gt]*s[Xt]+i[Zt]*s[Gt],e[Zt]=i[Wt]*s[Nt]+i[Ut]*s[Dt]+i[Gt]*s[_t]+i[Zt]*s[Zt],this.set(this.temp)}multiplyLeft(t){let e=this.temp,i=this.values,s=t.values;return e[Pt]=s[Pt]*i[Pt]+s[kt]*i[Lt]+s[Vt]*i[Ft]+s[Nt]*i[Wt],e[kt]=s[Pt]*i[kt]+s[kt]*i[Ot]+s[Vt]*i[Bt]+s[Nt]*i[Ut],e[Vt]=s[Pt]*i[Vt]+s[kt]*i[Yt]+s[Vt]*i[Xt]+s[Nt]*i[Gt],e[Nt]=s[Pt]*i[Nt]+s[kt]*i[Dt]+s[Vt]*i[_t]+s[Nt]*i[Zt],e[Lt]=s[Lt]*i[Pt]+s[Ot]*i[Lt]+s[Yt]*i[Ft]+s[Dt]*i[Wt],e[Ot]=s[Lt]*i[kt]+s[Ot]*i[Ot]+s[Yt]*i[Bt]+s[Dt]*i[Ut],e[Yt]=s[Lt]*i[Vt]+s[Ot]*i[Yt]+s[Yt]*i[Xt]+s[Dt]*i[Gt],e[Dt]=s[Lt]*i[Nt]+s[Ot]*i[Dt]+s[Yt]*i[_t]+s[Dt]*i[Zt],e[Ft]=s[Ft]*i[Pt]+s[Bt]*i[Lt]+s[Xt]*i[Ft]+s[_t]*i[Wt],e[Bt]=s[Ft]*i[kt]+s[Bt]*i[Ot]+s[Xt]*i[Bt]+s[_t]*i[Ut],e[Xt]=s[Ft]*i[Vt]+s[Bt]*i[Yt]+s[Xt]*i[Xt]+s[_t]*i[Gt],e[_t]=s[Ft]*i[Nt]+s[Bt]*i[Dt]+s[Xt]*i[_t]+s[_t]*i[Zt],e[Wt]=s[Wt]*i[Pt]+s[Ut]*i[Lt]+s[Gt]*i[Ft]+s[Zt]*i[Wt],e[Ut]=s[Wt]*i[kt]+s[Ut]*i[Ot]+s[Gt]*i[Bt]+s[Zt]*i[Ut],e[Gt]=s[Wt]*i[Vt]+s[Ut]*i[Yt]+s[Gt]*i[Xt]+s[Zt]*i[Gt],e[Zt]=s[Wt]*i[Nt]+s[Ut]*i[Dt]+s[Gt]*i[_t]+s[Zt]*i[Zt],this.set(this.temp)}lookAt(t,e,i){zt.initTemps();let s=zt.xAxis,n=zt.yAxis,a=zt.zAxis;a.setFrom(e).normalize(),s.setFrom(e).normalize(),s.cross(i).normalize(),n.setFrom(s).cross(a).normalize(),this.identity();let r=this.values;return r[Pt]=s.x,r[kt]=s.y,r[Vt]=s.z,r[Lt]=n.x,r[Ot]=n.y,r[Yt]=n.z,r[Ft]=-a.x,r[Bt]=-a.y,r[Xt]=-a.z,zt.tmpMatrix.identity(),zt.tmpMatrix.values[Nt]=-t.x,zt.tmpMatrix.values[Dt]=-t.y,zt.tmpMatrix.values[_t]=-t.z,this.multiply(zt.tmpMatrix),this}static initTemps(){null===zt.xAxis&&(zt.xAxis=new Ct),null===zt.yAxis&&(zt.yAxis=new Ct),null===zt.zAxis&&(zt.zAxis=new Ct)}}class jt{position=new Ct(0,0,0);direction=new Ct(0,0,-1);up=new Ct(0,1,0);near=0;far=100;fov=0;zoom=1;viewportWidth=0;viewportHeight=0;projectionView=new zt;inverseProjectionView=new zt;projection=new zt;view=new zt;is_perspective=!1;tmp=new Ct;constructor(t,e){this.viewportWidth=t,this.viewportHeight=e,this.update()}update(){let t=this.projection,e=this.view,i=this.projectionView,s=this.inverseProjectionView,n=this.zoom,a=this.viewportWidth,r=this.viewportHeight;t.ortho(n*(-a/2),n*(a/2),n*(-r/2),n*(r/2),this.near,this.far),e.lookAt(this.position,this.direction,this.up),i.set(t.values),i.multiply(e),s.set(i.values).invert()}screenToWorld(t,e,i){let s=t.x,n=t.y,a=t.z,r=this.tmp;return r.x=s/e*2-1,r.y=n/i*2-1,r.z=a,r.project(this.inverseProjectionView),t.set(r.x,r.y,r.z),t}worldToScreen(t){let e=new Ct(t.x,t.y,t.z);return e.multiply(this.projectionView),e.x=(e.x+1)/2*this.viewportWidth,e.y=(e.y+1)/2*this.viewportHeight,new Ct(e.x,e.y,0)}setViewport(t,e){this.viewportWidth=t,this.viewportHeight=e}}class Ht{position=new Ct(0,0,0);direction=new Ct(0,0,-1);up=new Ct(0,1,0);near=1;far=1e3;zoom=1;fov=45;viewportWidth=0;viewportHeight=0;projectionView=new zt;inverseProjectionView=new zt;projection=new zt;view=new zt;is_perspective=!0;tmp=new Ct;constructor(t,e){this.viewportWidth=t,this.viewportHeight=e,this.update()}update(t=!1){let e=this.projection,i=this.view,s=this.projectionView,n=this.inverseProjectionView;try{e.projection(this.near,this.far,this.fov,this.viewportWidth/this.viewportHeight),i.lookAt(this.position,this.direction,this.up),s.set(e.values),s.multiply(i),n.set(s.values).invert()}catch(e){if(t)throw e}}screenToWorld(t,e,i){let s=t.x,n=t.y,a=t.z,r=this.tmp;return r.x=s/e*2-1,r.y=n/i*2-1,r.z=a,r.project(this.inverseProjectionView),t.set(r.x,r.y,r.z),t}worldToScreen(t){let e=new Ct(t.x,t.y,t.z);e.project(this.projectionView),e.x=(e.x+1)/2*this.viewportWidth,e.y=(e.y+1)/2*this.viewportHeight;let i=new Ct(e.x,e.y,e.z);return i.w=e.w,i}setViewport(t,e){this.viewportWidth=t,this.viewportHeight=e}}class Jt{element;lastX=0;lastY=0;buttonDown=!1;currTouch=null;touchesPool=new C((()=>new Qt(0,0,0)));listeners=new Array;constructor(t){this.element=t,this.setupCallbacks(t)}setupCallbacks(t){let e=e=>{if(e instanceof MouseEvent){let i=t.getBoundingClientRect(),s=e.clientX-i.left,n=e.clientY-i.top,a=this.listeners;for(let t=0;t<a.length;t++)this.buttonDown?a[t].dragged&&a[t].dragged(s,n):a[t].moved&&a[t].moved(s,n);this.lastX=s,this.lastY=n}},i=s=>{if(s instanceof MouseEvent){let n=t.getBoundingClientRect(),a=s.clientX-n.left,r=s.clientY-n.top,o=this.listeners;for(let t=0;t<o.length;t++)o[t].up&&o[t].up(a,r);this.lastX=a,this.lastY=r,this.buttonDown=!1,document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",i)}};t.addEventListener("mousedown",(s=>{if(s instanceof MouseEvent){let n=t.getBoundingClientRect(),a=s.clientX-n.left,r=s.clientY-n.top,o=this.listeners;for(let t=0;t<o.length;t++)o[t].down&&o[t].down(a,r);this.lastX=a,this.lastY=r,this.buttonDown=!0,document.addEventListener("mousemove",e),document.addEventListener("mouseup",i)}}),!0),t.addEventListener("mousemove",e,!0),t.addEventListener("mouseup",i,!0),t.addEventListener("touchstart",(e=>{if(null!=this.currTouch)return;for(var i=e.changedTouches,s=0;s<i.length;s++){var n=i[s];let e=t.getBoundingClientRect(),a=n.clientX-e.left,r=n.clientY-e.top;this.currTouch=this.touchesPool.obtain(),this.currTouch.identifier=n.identifier,this.currTouch.x=a,this.currTouch.y=r;break}let a=this.listeners;for(let t=0;t<a.length;t++)a[t].down&&a[t].down(this.currTouch.x,this.currTouch.y);this.lastX=this.currTouch.x,this.lastY=this.currTouch.y,this.buttonDown=!0,e.preventDefault()}),!1),t.addEventListener("touchend",(e=>{for(var i=e.changedTouches,s=0;s<i.length;s++){var n=i[s];if(this.currTouch.identifier===n.identifier){let e=t.getBoundingClientRect(),i=this.currTouch.x=n.clientX-e.left,s=this.currTouch.y=n.clientY-e.top;this.touchesPool.free(this.currTouch);let a=this.listeners;for(let t=0;t<a.length;t++)a[t].up&&a[t].up(i,s);this.lastX=i,this.lastY=s,this.buttonDown=!1,this.currTouch=null;break}}e.preventDefault()}),!1),t.addEventListener("touchcancel",(e=>{for(var i=e.changedTouches,s=0;s<i.length;s++){var n=i[s];if(this.currTouch.identifier===n.identifier){let e=t.getBoundingClientRect(),i=this.currTouch.x=n.clientX-e.left,s=this.currTouch.y=n.clientY-e.top;this.touchesPool.free(this.currTouch);let a=this.listeners;for(let t=0;t<a.length;t++)a[t].up&&a[t].up(i,s);this.lastX=i,this.lastY=s,this.buttonDown=!1,this.currTouch=null;break}}e.preventDefault()}),!1),t.addEventListener("touchmove",(e=>{if(null!=this.currTouch){for(var i=e.changedTouches,s=0;s<i.length;s++){var n=i[s];if(this.currTouch.identifier===n.identifier){let e=t.getBoundingClientRect(),i=n.clientX-e.left,s=n.clientY-e.top,a=this.listeners;for(let t=0;t<a.length;t++)a[t].dragged&&a[t].dragged(i,s);this.lastX=this.currTouch.x=i,this.lastY=this.currTouch.y=s;break}}e.preventDefault()}}),!1)}addListener(t){this.listeners.push(t)}removeListener(t){let e=this.listeners.indexOf(t);e>-1&&this.listeners.splice(e,1)}}class Qt{identifier;x;y;constructor(t,e,i){this.identifier=t,this.x=e,this.y=i}}class qt{vertexShader;fragmentShader;static MVP_MATRIX="u_projTrans";static POSITION="a_position";static COLOR="a_color";static COLOR2="a_color2";static TEXCOORDS="a_texCoords";static SAMPLER="u_texture";context;vs=null;vsSource;fs=null;fsSource;program=null;tmp2x2=new Float32Array(4);tmp3x3=new Float32Array(9);tmp4x4=new Float32Array(16);getProgram(){return this.program}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}getVertexShaderSource(){return this.vsSource}getFragmentSource(){return this.fsSource}constructor(t,e,i){this.vertexShader=e,this.fragmentShader=i,this.vsSource=e,this.fsSource=i,this.context=t instanceof v?t:new v(t),this.context.addRestorable(this),this.compile()}compile(){let t=this.context.gl;try{this.vs=this.compileShader(t.VERTEX_SHADER,this.vertexShader),this.fs=this.compileShader(t.FRAGMENT_SHADER,this.fragmentShader),this.program=this.compileProgram(this.vs,this.fs)}catch(t){throw console.log("Shader compilation error",t),this.dispose(),t}}compileShader(t,e){let i=this.context.gl,s=i.createShader(t);if(i.shaderSource(s,e),i.compileShader(s),!i.getShaderParameter(s,i.COMPILE_STATUS)){let t="Couldn't compile shader: "+i.getShaderInfoLog(s);if(i.deleteShader(s),!i.isContextLost())throw new Error(t)}return s}compileProgram(t,e){let i=this.context.gl,s=i.createProgram();if(i.attachShader(s,t),i.attachShader(s,e),i.linkProgram(s),!i.getProgramParameter(s,i.LINK_STATUS)){let t="Couldn't compile shader program: "+i.getProgramInfoLog(s);if(i.deleteProgram(s),!i.isContextLost())throw new Error(t)}return s}restore(){this.compile()}bind(){this.context.gl.useProgram(this.program)}unbind(){this.context.gl.useProgram(null)}setUniformi(t,e){this.context.gl.uniform1i(this.getUniformLocation(t),e)}setUniformf(t,e){this.context.gl.uniform1f(this.getUniformLocation(t),e)}setUniform2f(t,e,i){this.context.gl.uniform2f(this.getUniformLocation(t),e,i)}setUniform3f(t,e,i,s){this.context.gl.uniform3f(this.getUniformLocation(t),e,i,s)}setUniform4f(t,e,i,s,n){this.context.gl.uniform4f(this.getUniformLocation(t),e,i,s,n)}setUniform2x2f(t,e){let i=this.context.gl;this.tmp2x2.set(e),i.uniformMatrix2fv(this.getUniformLocation(t),!1,this.tmp2x2)}setUniform3x3f(t,e){let i=this.context.gl;this.tmp3x3.set(e),i.uniformMatrix3fv(this.getUniformLocation(t),!1,this.tmp3x3)}setUniform4x4f(t,e){let i=this.context.gl;this.tmp4x4.set(e),i.uniformMatrix4fv(this.getUniformLocation(t),!1,this.tmp4x4)}getUniformLocation(t){let e=this.context.gl,i=e.getUniformLocation(this.program,t);if(!i&&!e.isContextLost())throw new Error(`Couldn't find location for uniform ${t}`);return i}getAttributeLocation(t){let e=this.context.gl,i=e.getAttribLocation(this.program,t);if(-1==i&&!e.isContextLost())throw new Error(`Couldn't find location for attribute ${t}`);return i}dispose(){this.context.removeRestorable(this);let t=this.context.gl;this.vs&&(t.deleteShader(this.vs),this.vs=null),this.fs&&(t.deleteShader(this.fs),this.fs=null),this.program&&(t.deleteProgram(this.program),this.program=null)}static newColoredTextured(t){let e=`\n\t\t\t\tattribute vec4 ${qt.POSITION};\n\t\t\t\tattribute vec4 ${qt.COLOR};\n\t\t\t\tattribute vec2 ${qt.TEXCOORDS};\n\t\t\t\tuniform mat4 ${qt.MVP_MATRIX};\n\t\t\t\tvarying vec4 v_color;\n\t\t\t\tvarying vec2 v_texCoords;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_color = ${qt.COLOR};\n\t\t\t\t\tv_texCoords = ${qt.TEXCOORDS};\n\t\t\t\t\tgl_Position = ${qt.MVP_MATRIX} * ${qt.POSITION};\n\t\t\t\t}\n\t\t\t`;return new qt(t,e,"\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_color;\n\t\t\t\tvarying vec2 v_texCoords;\n\t\t\t\tuniform sampler2D u_texture;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tgl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n\t\t\t\t}\n\t\t\t")}static newTwoColoredTextured(t){let e=`\n\t\t\t\tattribute vec4 ${qt.POSITION};\n\t\t\t\tattribute vec4 ${qt.COLOR};\n\t\t\t\tattribute vec4 ${qt.COLOR2};\n\t\t\t\tattribute vec2 ${qt.TEXCOORDS};\n\t\t\t\tuniform mat4 ${qt.MVP_MATRIX};\n\t\t\t\tvarying vec4 v_light;\n\t\t\t\tvarying vec4 v_dark;\n\t\t\t\tvarying vec2 v_texCoords;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_light = ${qt.COLOR};\n\t\t\t\t\tv_dark = ${qt.COLOR2};\n\t\t\t\t\tv_texCoords = ${qt.TEXCOORDS};\n\t\t\t\t\tgl_Position = ${qt.MVP_MATRIX} * ${qt.POSITION};\n\t\t\t\t}\n\t\t\t`;return new qt(t,e,"\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_light;\n\t\t\t\tvarying LOWP vec4 v_dark;\n\t\t\t\tvarying vec2 v_texCoords;\n\t\t\t\tuniform sampler2D u_texture;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tvec4 texColor = texture2D(u_texture, v_texCoords);\n\t\t\t\t\tgl_FragColor.a = texColor.a * v_light.a;\n\t\t\t\t\tgl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n\t\t\t\t}\n\t\t\t")}static newColored(t){let e=`\n\t\t\t\tattribute vec4 ${qt.POSITION};\n\t\t\t\tattribute vec4 ${qt.COLOR};\n\t\t\t\tuniform mat4 ${qt.MVP_MATRIX};\n\t\t\t\tvarying vec4 v_color;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_color = ${qt.COLOR};\n\t\t\t\t\tgl_Position = ${qt.MVP_MATRIX} * ${qt.POSITION};\n\t\t\t\t}\n\t\t\t`;return new qt(t,e,"\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_color;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tgl_FragColor = v_color;\n\t\t\t\t}\n\t\t\t")}}class Kt{attributes;context;vertices;verticesBuffer;verticesLength=0;dirtyVertices=!1;indices;indicesBuffer;indicesLength=0;dirtyIndices=!1;elementsPerVertex=0;getAttributes(){return this.attributes}maxVertices(){return this.vertices.length/this.elementsPerVertex}numVertices(){return this.verticesLength/this.elementsPerVertex}setVerticesLength(t){this.dirtyVertices=!0,this.verticesLength=t}getVertices(){return this.vertices}maxIndices(){return this.indices.length}numIndices(){return this.indicesLength}setIndicesLength(t){this.dirtyIndices=!0,this.indicesLength=t}getIndices(){return this.indices}getVertexSizeInFloats(){let t=0;for(var e=0;e<this.attributes.length;e++)t+=this.attributes[e].numElements;return t}constructor(t,e,i,s){this.attributes=e,this.context=t instanceof v?t:new v(t),this.elementsPerVertex=0;for(let t=0;t<e.length;t++)this.elementsPerVertex+=e[t].numElements;this.vertices=new Float32Array(i*this.elementsPerVertex),this.indices=new Uint16Array(s),this.context.addRestorable(this)}setVertices(t){if(this.dirtyVertices=!0,t.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(t,0),this.verticesLength=t.length}setIndices(t){if(this.dirtyIndices=!0,t.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(t,0),this.indicesLength=t.length}draw(t,e){this.drawWithOffset(t,e,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)}drawWithOffset(t,e,i,s){let n=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(t),this.indicesLength>0?n.drawElements(e,s,n.UNSIGNED_SHORT,2*i):n.drawArrays(e,i,s),this.unbind(t)}bind(t){let e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer);let i=0;for(let s=0;s<this.attributes.length;s++){let n=this.attributes[s],a=t.getAttributeLocation(n.name);e.enableVertexAttribArray(a),e.vertexAttribPointer(a,n.numElements,e.FLOAT,!1,4*this.elementsPerVertex,4*i),i+=n.numElements}this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)}unbind(t){let e=this.context.gl;for(let i=0;i<this.attributes.length;i++){let s=this.attributes[i],n=t.getAttributeLocation(s.name);e.disableVertexAttribArray(n)}e.bindBuffer(e.ARRAY_BUFFER,null),this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}update(){let t=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),t.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),t.DYNAMIC_DRAW),this.dirtyIndices=!1)}restore(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()}dispose(){this.context.removeRestorable(this);let t=this.context.gl;t.deleteBuffer(this.verticesBuffer),t.deleteBuffer(this.indicesBuffer)}}class $t{name;type;numElements;constructor(t,e,i){this.name=t,this.type=e,this.numElements=i}}class te extends $t{constructor(){super(qt.POSITION,ne.Float,2)}}class ee extends $t{constructor(t=0){super(qt.TEXCOORDS+(0==t?"":t),ne.Float,2)}}class ie extends $t{constructor(){super(qt.COLOR,ne.Float,4)}}class se extends $t{constructor(){super(qt.COLOR2,ne.Float,4)}}var ne,ae,re,oe;!function(t){t[t.Float=0]="Float"}(ne||(ne={}));class le{context;drawCalls;isDrawing=!1;mesh;shader=null;lastTexture=null;verticesLength=0;indicesLength=0;srcBlend;dstBlend;constructor(t,e=!0,i=10920){if(i>10920)throw new Error("Can't have more than 10920 triangles per batch: "+i);this.context=t instanceof v?t:new v(t);let s=e?[new te,new ie,new ee,new se]:[new te,new ie,new ee];this.mesh=new Kt(t,s,i,3*i),this.srcBlend=this.context.gl.SRC_ALPHA,this.dstBlend=this.context.gl.ONE_MINUS_SRC_ALPHA}begin(t){let e=this.context.gl;if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0,this.shader=t,this.lastTexture=null,this.isDrawing=!0,e.enable(e.BLEND),e.blendFunc(this.srcBlend,this.dstBlend)}setBlendMode(t,e){let i=this.context.gl;this.srcBlend=t,this.dstBlend=e,this.isDrawing&&(this.flush(),i.blendFunc(this.srcBlend,this.dstBlend))}draw(t,e,i){t!=this.lastTexture?(this.flush(),this.lastTexture=t):(this.verticesLength+e.length>this.mesh.getVertices().length||this.indicesLength+i.length>this.mesh.getIndices().length)&&this.flush();let s=this.mesh.numVertices();this.mesh.getVertices().set(e,this.verticesLength),this.verticesLength+=e.length,this.mesh.setVerticesLength(this.verticesLength);let n=this.mesh.getIndices();for(let t=this.indicesLength,e=0;e<i.length;t++,e++)n[t]=i[e]+s;this.indicesLength+=i.length,this.mesh.setIndicesLength(this.indicesLength)}flush(){let t=this.context.gl;0!=this.verticesLength&&(this.lastTexture.bind(),this.mesh.draw(this.shader,t.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++)}end(){let t=this.context.gl;if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader=null,this.lastTexture=null,this.isDrawing=!1,t.disable(t.BLEND)}getDrawCalls(){return this.drawCalls}dispose(){this.mesh.dispose()}}class he{context;isDrawing=!1;mesh;shapeType=ae.Filled;color=new R(1,1,1,1);shader;vertexIndex=0;tmp=new P;srcBlend;dstBlend;constructor(t,e=10920){if(e>10920)throw new Error("Can't have more than 10920 triangles per batch: "+e);this.context=t instanceof v?t:new v(t),this.mesh=new Kt(t,[new te,new ie],e,0),this.srcBlend=this.context.gl.SRC_ALPHA,this.dstBlend=this.context.gl.ONE_MINUS_SRC_ALPHA}begin(t){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.shader=t,this.vertexIndex=0,this.isDrawing=!0;let e=this.context.gl;e.enable(e.BLEND),e.blendFunc(this.srcBlend,this.dstBlend)}setBlendMode(t,e){let i=this.context.gl;this.srcBlend=t,this.dstBlend=e,this.isDrawing&&(this.flush(),i.blendFunc(this.srcBlend,this.dstBlend))}setColor(t){this.color.setFromColor(t)}setColorWith(t,e,i,s){this.color.set(t,e,i,s)}point(t,e,i=null){this.check(ae.Point,1),null===i&&(i=this.color),this.vertex(t,e,i)}line(t,e,i,s,n=null){this.check(ae.Line,2),this.mesh.getVertices(),this.vertexIndex,null===n&&(n=this.color),this.vertex(t,e,n),this.vertex(i,s,n)}triangle(t,e,i,s,n,a,r,o=null,l=null,h=null){this.check(t?ae.Filled:ae.Line,3),this.mesh.getVertices(),this.vertexIndex,null===o&&(o=this.color),null===l&&(l=this.color),null===h&&(h=this.color),t?(this.vertex(e,i,o),this.vertex(s,n,l),this.vertex(a,r,h)):(this.vertex(e,i,o),this.vertex(s,n,l),this.vertex(s,n,o),this.vertex(a,r,l),this.vertex(a,r,o),this.vertex(e,i,l))}quad(t,e,i,s,n,a,r,o,l,h=null,c=null,d=null,u=null){this.check(t?ae.Filled:ae.Line,3),this.mesh.getVertices(),this.vertexIndex,null===h&&(h=this.color),null===c&&(c=this.color),null===d&&(d=this.color),null===u&&(u=this.color),t?(this.vertex(e,i,h),this.vertex(s,n,c),this.vertex(a,r,d),this.vertex(a,r,d),this.vertex(o,l,u),this.vertex(e,i,h)):(this.vertex(e,i,h),this.vertex(s,n,c),this.vertex(s,n,c),this.vertex(a,r,d),this.vertex(a,r,d),this.vertex(o,l,u),this.vertex(o,l,u),this.vertex(e,i,h))}rect(t,e,i,s,n,a=null){this.quad(t,e,i,e+s,i,e+s,i+n,e,i+n,a,a,a,a)}rectLine(t,e,i,s,n,a,r=null){this.check(t?ae.Filled:ae.Line,8),null===r&&(r=this.color);let o=this.tmp.set(n-i,e-s);o.normalize(),a*=.5;let l=o.x*a,h=o.y*a;t?(this.vertex(e+l,i+h,r),this.vertex(e-l,i-h,r),this.vertex(s+l,n+h,r),this.vertex(s-l,n-h,r),this.vertex(s+l,n+h,r),this.vertex(e-l,i-h,r)):(this.vertex(e+l,i+h,r),this.vertex(e-l,i-h,r),this.vertex(s+l,n+h,r),this.vertex(s-l,n-h,r),this.vertex(s+l,n+h,r),this.vertex(e+l,i+h,r),this.vertex(s-l,n-h,r),this.vertex(e-l,i-h,r))}x(t,e,i){this.line(t-i,e-i,t+i,e+i),this.line(t-i,e+i,t+i,e-i)}polygon(t,e,i,s=null){if(i<3)throw new Error("Polygon must contain at least 3 vertices");this.check(ae.Line,2*i),null===s&&(s=this.color),this.mesh.getVertices(),this.vertexIndex,i<<=1;let n=t[e<<=1],a=t[e+1],r=e+i;for(let o=e,l=e+i-2;o<l;o+=2){let e=t[o],i=t[o+1],l=0,h=0;o+2>=r?(l=n,h=a):(l=t[o+2],h=t[o+3]),this.vertex(e,i,s),this.vertex(l,h,s)}}circle(t,e,i,s,n=null,a=0){if(0===a&&(a=Math.max(1,6*I.cbrt(s)|0)),a<=0)throw new Error("segments must be > 0.");null===n&&(n=this.color);let r=2*I.PI/a,o=Math.cos(r),l=Math.sin(r),h=s,c=0;if(t){this.check(ae.Filled,3*a+3),a--;for(let t=0;t<a;t++){this.vertex(e,i,n),this.vertex(e+h,i+c,n);let t=h;h=o*h-l*c,c=l*t+o*c,this.vertex(e+h,i+c,n)}this.vertex(e,i,n),this.vertex(e+h,i+c,n)}else{this.check(ae.Line,2*a+2);for(let t=0;t<a;t++){this.vertex(e+h,i+c,n);let t=h;h=o*h-l*c,c=l*t+o*c,this.vertex(e+h,i+c,n)}this.vertex(e+h,i+c,n)}h=s,c=0,this.vertex(e+h,i+c,n)}curve(t,e,i,s,n,a,r,o,l,h=null){this.check(ae.Line,2*l+2),null===h&&(h=this.color);let c=1/l,d=c*c,u=c*c*c,m=3*c,g=3*d,p=6*d,f=6*u,w=t-2*i+n,x=e-2*s+a,b=3*(i-n)-t+r,y=3*(s-a)-e+o,v=t,A=e,E=(i-t)*m+w*g+b*u,M=(s-e)*m+x*g+y*u,S=w*p+b*f,R=x*p+y*f,I=b*f,T=y*f;for(;l-- >0;)this.vertex(v,A,h),v+=E,A+=M,E+=S,M+=R,S+=I,R+=T,this.vertex(v,A,h);this.vertex(v,A,h),this.vertex(r,o,h)}vertex(t,e,i){let s=this.vertexIndex,n=this.mesh.getVertices();n[s++]=t,n[s++]=e,n[s++]=i.r,n[s++]=i.g,n[s++]=i.b,n[s++]=i.a,this.vertexIndex=s}end(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush(),this.context.gl.disable(this.context.gl.BLEND),this.isDrawing=!1}flush(){0!=this.vertexIndex&&(this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0)}check(t,e){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType==t){if(!(this.mesh.maxVertices()-this.mesh.numVertices()<e))return;this.flush()}else this.flush(),this.shapeType=t}dispose(){this.mesh.dispose()}}!function(t){t[t.Point=0]="Point",t[t.Line=1]="Line",t[t.Filled=4]="Filled"}(ae||(ae={}));class ce{minX=0;minY=0;maxX=0;maxY=0;boundingBoxes=new Array;polygons=new Array;polygonPool=new C((()=>T.newFloatArray(16)));update(t,e){if(null==t)throw new Error("skeleton cannot be null.");let i=this.boundingBoxes,s=this.polygons,n=this.polygonPool,a=t.slots,r=a.length;i.length=0,n.freeAll(s),s.length=0;for(let t=0;t<r;t++){let e=a[t];if(!e.bone.active)continue;let r=e.getAttachment();if(r instanceof L){let t=r;i.push(t);let a=n.obtain();a.length!=t.worldVerticesLength&&(a=T.newFloatArray(t.worldVerticesLength)),s.push(a),t.computeWorldVertices(e,0,t.worldVerticesLength,a,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,n=this.polygons;for(let a=0,r=n.length;a<r;a++){let r=n[a],o=r;for(let n=0,a=r.length;n<a;n+=2){let a=o[n],r=o[n+1];t=Math.min(t,a),e=Math.min(e,r),i=Math.max(i,a),s=Math.max(s,r)}}this.minX=t,this.minY=e,this.maxX=i,this.maxY=s}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,i,s){let n=this.minX,a=this.minY,r=this.maxX,o=this.maxY;if(t<=n&&i<=n||e<=a&&s<=a||t>=r&&i>=r||e>=o&&s>=o)return!1;let l=(s-e)/(i-t),h=l*(n-t)+e;if(h>a&&h<o)return!0;if(h=l*(r-t)+e,h>a&&h<o)return!0;let c=(a-e)/l+t;return c>n&&c<r||(c=(o-e)/l+t,c>n&&c<r)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(t,e){let i=this.polygons;for(let s=0,n=i.length;s<n;s++)if(this.containsPointPolygon(i[s],t,e))return this.boundingBoxes[s];return null}containsPointPolygon(t,e,i){let s=t,n=t.length,a=n-2,r=!1;for(let t=0;t<n;t+=2){let n=s[t+1],o=s[a+1];if(n<i&&o>=i||o<i&&n>=i){let l=s[t];l+(i-n)/(o-n)*(s[a]-l)<e&&(r=!r)}a=t}return r}intersectsSegment(t,e,i,s){let n=this.polygons;for(let a=0,r=n.length;a<r;a++)if(this.intersectsSegmentPolygon(n[a],t,e,i,s))return this.boundingBoxes[a];return null}intersectsSegmentPolygon(t,e,i,s,n){let a=t,r=t.length,o=e-s,l=i-n,h=e*n-i*s,c=a[r-2],d=a[r-1];for(let t=0;t<r;t+=2){let r=a[t],u=a[t+1],m=c*u-d*r,g=c-r,p=d-u,f=o*p-l*g,w=(h*g-o*m)/f;if((w>=c&&w<=r||w>=r&&w<=c)&&(w>=e&&w<=s||w>=s&&w<=e)){let t=(h*p-l*m)/f;if((t>=d&&t<=u||t>=u&&t<=d)&&(t>=i&&t<=n||t>=n&&t<=i))return!0}c=r,d=u}return!1}getPolygon(t){if(null==t)throw new Error("boundingBox cannot be null.");let e=this.boundingBoxes.indexOf(t);return-1==e?null:this.polygons[e]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}class de{boneLineColor=new R(1,0,0,1);boneOriginColor=new R(0,1,0,1);attachmentLineColor=new R(0,0,1,.5);triangleLineColor=new R(1,.64,0,.5);pathColor=(new R).setFromString("FF7F00");clipColor=new R(.8,0,0,2);aabbColor=new R(0,1,0,.5);drawBones=!0;drawRegionAttachments=!0;drawBoundingBoxes=!0;drawMeshHull=!0;drawMeshTriangles=!0;drawPaths=!0;drawSkeletonXY=!1;drawClipping=!0;premultipliedAlpha=!1;scale=1;boneWidth=2;context;bounds=new ce;temp=new Array;vertices=T.newFloatArray(2048);static LIGHT_GRAY=new R(192/255,192/255,192/255,1);static GREEN=new R(0,1,0,1);constructor(t){this.context=t instanceof v?t:new v(t)}draw(t,e,i=null){let s=e.x,n=e.y,a=this.context.gl,r=this.premultipliedAlpha?a.ONE:a.SRC_ALPHA;t.setBlendMode(r,a.ONE_MINUS_SRC_ALPHA);let o=e.bones;if(this.drawBones){t.setColor(this.boneLineColor);for(let e=0,a=o.length;e<a;e++){let a=o[e];if(i&&i.indexOf(a.data.name)>-1)continue;if(null==a.parent)continue;let r=s+a.data.length*a.a+a.worldX,l=n+a.data.length*a.c+a.worldY;t.rectLine(!0,s+a.worldX,n+a.worldY,r,l,this.boneWidth*this.scale)}this.drawSkeletonXY&&t.x(s,n,4*this.scale)}if(this.drawRegionAttachments){t.setColor(this.attachmentLineColor);let i=e.slots;for(let e=0,s=i.length;e<s;e++){let s=i[e],n=s.getAttachment();if(n instanceof B){let e=n,i=this.vertices;e.computeWorldVertices(s.bone,i,0,2),t.line(i[0],i[1],i[2],i[3]),t.line(i[2],i[3],i[4],i[5]),t.line(i[4],i[5],i[6],i[7]),t.line(i[6],i[7],i[0],i[1])}}}if(this.drawMeshHull||this.drawMeshTriangles){let i=e.slots;for(let e=0,s=i.length;e<s;e++){let s=i[e];if(!s.bone.active)continue;let n=s.getAttachment();if(!(n instanceof Y))continue;let a=n,r=this.vertices;a.computeWorldVertices(s,0,a.worldVerticesLength,r,0,2);let o=a.triangles,l=a.hullLength;if(this.drawMeshTriangles){t.setColor(this.triangleLineColor);for(let e=0,i=o.length;e<i;e+=3){let i=2*o[e],s=2*o[e+1],n=2*o[e+2];t.triangle(!1,r[i],r[i+1],r[s],r[s+1],r[n],r[n+1])}}if(this.drawMeshHull&&l>0){t.setColor(this.attachmentLineColor),l=2*(l>>1);let e=r[l-2],i=r[l-1];for(let s=0,n=l;s<n;s+=2){let n=r[s],a=r[s+1];t.line(n,a,e,i),e=n,i=a}}}}if(this.drawBoundingBoxes){let i=this.bounds;i.update(e,!0),t.setColor(this.aabbColor),t.rect(!1,i.minX,i.minY,i.getWidth(),i.getHeight());let s=i.polygons,n=i.boundingBoxes;for(let e=0,i=s.length;e<i;e++){let i=s[e];t.setColor(n[e].color),t.polygon(i,0,i.length)}}if(this.drawPaths){let i=e.slots;for(let e=0,s=i.length;e<s;e++){let s=i[e];if(!s.bone.active)continue;let n=s.getAttachment();if(!(n instanceof D))continue;let a=n,r=a.worldVerticesLength,o=this.temp=T.setArraySize(this.temp,r,0);a.computeWorldVertices(s,0,r,o,0,2);let l=this.pathColor,h=o[2],c=o[3],d=0,u=0;if(a.closed){t.setColor(l);let e=o[0],i=o[1],s=o[r-2],n=o[r-1];d=o[r-4],u=o[r-3],t.curve(h,c,e,i,s,n,d,u,32),t.setColor(de.LIGHT_GRAY),t.line(h,c,e,i),t.line(d,u,s,n)}r-=4;for(let e=4;e<r;e+=6){let i=o[e],s=o[e+1],n=o[e+2],a=o[e+3];d=o[e+4],u=o[e+5],t.setColor(l),t.curve(h,c,i,s,n,a,d,u,32),t.setColor(de.LIGHT_GRAY),t.line(h,c,i,s),t.line(d,u,n,a),h=d,c=u}}}if(this.drawBones){t.setColor(this.boneOriginColor);for(let e=0,a=o.length;e<a;e++){let a=o[e];i&&i.indexOf(a.data.name)>-1||t.circle(!0,s+a.worldX,n+a.worldY,3*this.scale,de.GREEN,8)}}if(this.drawClipping){let i=e.slots;t.setColor(this.clipColor);for(let e=0,s=i.length;e<s;e++){let s=i[e];if(!s.bone.active)continue;let n=s.getAttachment();if(!(n instanceof O))continue;let a=n,r=a.worldVerticesLength,o=this.temp=T.setArraySize(this.temp,r,0);a.computeWorldVertices(s,0,r,o,0,2);for(let e=0,i=o.length;e<i;e+=2){let i=o[e],s=o[e+1],n=o[(e+2)%o.length],a=o[(e+3)%o.length];t.line(i,s,n,a)}}}}dispose(){}}class ue{convexPolygons=new Array;convexPolygonsIndices=new Array;indicesArray=new Array;isConcaveArray=new Array;triangles=new Array;polygonPool=new C((()=>new Array));polygonIndicesPool=new C((()=>new Array));triangulate(t){let e=t,i=t.length>>1,s=this.indicesArray;s.length=0;for(let t=0;t<i;t++)s[t]=t;let n=this.isConcaveArray;n.length=0;for(let t=0,a=i;t<a;++t)n[t]=ue.isConcave(t,i,e,s);let a=this.triangles;for(a.length=0;i>3;){let t=i-1,r=0,o=1;for(;;){t:if(!n[r]){let a=s[t]<<1,l=s[r]<<1,h=s[o]<<1,c=e[a],d=e[a+1],u=e[l],m=e[l+1],g=e[h],p=e[h+1];for(let a=(o+1)%i;a!=t;a=(a+1)%i){if(!n[a])continue;let t=s[a]<<1,i=e[t],r=e[t+1];if(ue.positiveArea(g,p,c,d,i,r)&&ue.positiveArea(c,d,u,m,i,r)&&ue.positiveArea(u,m,g,p,i,r))break t}break}if(0==o){do{if(!n[r])break;r--}while(r>0);break}t=r,r=o,o=(o+1)%i}a.push(s[(i+r-1)%i]),a.push(s[r]),a.push(s[(r+1)%i]),s.splice(r,1),n.splice(r,1),i--;let l=(i+r-1)%i,h=r==i?0:r;n[l]=ue.isConcave(l,i,e,s),n[h]=ue.isConcave(h,i,e,s)}return 3==i&&(a.push(s[2]),a.push(s[0]),a.push(s[1])),a}decompose(t,e){let i=t,s=this.convexPolygons;this.polygonPool.freeAll(s),s.length=0;let n=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(n),n.length=0;let a=this.polygonIndicesPool.obtain();a.length=0;let r=this.polygonPool.obtain();r.length=0;let o=-1,l=0;for(let t=0,h=e.length;t<h;t+=3){let h=e[t]<<1,c=e[t+1]<<1,d=e[t+2]<<1,u=i[h],m=i[h+1],g=i[c],p=i[c+1],f=i[d],w=i[d+1],x=!1;if(o==h){let t=r.length-4,e=ue.winding(r[t],r[t+1],r[t+2],r[t+3],f,w),i=ue.winding(f,w,r[0],r[1],r[2],r[3]);e==l&&i==l&&(r.push(f),r.push(w),a.push(d),x=!0)}x||(r.length>0?(s.push(r),n.push(a)):(this.polygonPool.free(r),this.polygonIndicesPool.free(a)),r=this.polygonPool.obtain(),r.length=0,r.push(u),r.push(m),r.push(g),r.push(p),r.push(f),r.push(w),a=this.polygonIndicesPool.obtain(),a.length=0,a.push(h),a.push(c),a.push(d),l=ue.winding(u,m,g,p,f,w),o=h)}r.length>0&&(s.push(r),n.push(a));for(let t=0,e=s.length;t<e;t++){if(a=n[t],0==a.length)continue;let i=a[0],o=a[a.length-1];r=s[t];let l=r.length-4,h=r[l],c=r[l+1],d=r[l+2],u=r[l+3],m=r[0],g=r[1],p=r[2],f=r[3],w=ue.winding(h,c,d,u,m,g);for(let l=0;l<e;l++){if(l==t)continue;let e=n[l];if(3!=e.length)continue;let x=e[0],b=e[1],y=e[2],v=s[l],A=v[v.length-2],E=v[v.length-1];if(x!=i||b!=o)continue;let M=ue.winding(h,c,d,u,A,E),S=ue.winding(A,E,m,g,p,f);M==w&&S==w&&(v.length=0,e.length=0,r.push(A),r.push(E),a.push(y),h=d,c=u,d=A,u=E,l=0)}}for(let t=s.length-1;t>=0;t--)r=s[t],0==r.length&&(s.splice(t,1),this.polygonPool.free(r),a=n[t],n.splice(t,1),this.polygonIndicesPool.free(a));return s}static isConcave(t,e,i,s){let n=s[(e+t-1)%e]<<1,a=s[t]<<1,r=s[(t+1)%e]<<1;return!this.positiveArea(i[n],i[n+1],i[a],i[a+1],i[r],i[r+1])}static positiveArea(t,e,i,s,n,a){return t*(a-s)+i*(e-a)+n*(s-e)>=0}static winding(t,e,i,s,n,a){let r=i-t,o=s-e;return n*o-a*r+r*e-t*o>=0?1:-1}}class me{triangulator=new ue;clippingPolygon=new Array;clipOutput=new Array;clippedVertices=new Array;clippedTriangles=new Array;scratch=new Array;clipAttachment;clippingPolygons;clipStart(t,e){if(null!=this.clipAttachment)return 0;this.clipAttachment=e;let i=e.worldVerticesLength,s=T.setArraySize(this.clippingPolygon,i);e.computeWorldVertices(t,0,i,s,0,2);let n=this.clippingPolygon;me.makeClockwise(n);let a=this.clippingPolygons=this.triangulator.decompose(n,this.triangulator.triangulate(n));for(let t=0,e=a.length;t<e;t++){let e=a[t];me.makeClockwise(e),e.push(e[0]),e.push(e[1])}return a.length}clipEndWithSlot(t){null!=this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()}clipEnd(){null!=this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return null!=this.clipAttachment}clipTriangles(t,e,i,s,n,a,r,o){let l=this.clipOutput,h=this.clippedVertices,c=this.clippedTriangles,d=this.clippingPolygons,u=this.clippingPolygons.length,m=o?12:8,g=0;h.length=0,c.length=0;t:for(let e=0;e<s;e+=3){let s=i[e]<<1,p=t[s],f=t[s+1],w=n[s],x=n[s+1];s=i[e+1]<<1;let b=t[s],y=t[s+1],v=n[s],A=n[s+1];s=i[e+2]<<1;let E=t[s],M=t[s+1],S=n[s],R=n[s+1];for(let t=0;t<u;t++){let e=h.length;if(!this.clip(p,f,b,y,E,M,d[t],l)){let t=T.setArraySize(h,e+3*m);t[e]=p,t[e+1]=f,t[e+2]=a.r,t[e+3]=a.g,t[e+4]=a.b,t[e+5]=a.a,o?(t[e+6]=w,t[e+7]=x,t[e+8]=r.r,t[e+9]=r.g,t[e+10]=r.b,t[e+11]=r.a,t[e+12]=b,t[e+13]=y,t[e+14]=a.r,t[e+15]=a.g,t[e+16]=a.b,t[e+17]=a.a,t[e+18]=v,t[e+19]=A,t[e+20]=r.r,t[e+21]=r.g,t[e+22]=r.b,t[e+23]=r.a,t[e+24]=E,t[e+25]=M,t[e+26]=a.r,t[e+27]=a.g,t[e+28]=a.b,t[e+29]=a.a,t[e+30]=S,t[e+31]=R,t[e+32]=r.r,t[e+33]=r.g,t[e+34]=r.b,t[e+35]=r.a):(t[e+6]=w,t[e+7]=x,t[e+8]=b,t[e+9]=y,t[e+10]=a.r,t[e+11]=a.g,t[e+12]=a.b,t[e+13]=a.a,t[e+14]=v,t[e+15]=A,t[e+16]=E,t[e+17]=M,t[e+18]=a.r,t[e+19]=a.g,t[e+20]=a.b,t[e+21]=a.a,t[e+22]=S,t[e+23]=R),e=c.length;let i=T.setArraySize(c,e+3);i[e]=g,i[e+1]=g+1,i[e+2]=g+2,g+=3;continue t}{let t=l.length;if(0==t)continue;let i=y-M,s=E-b,n=p-E,d=M-f,u=1/(i*n+s*(f-M)),I=t>>1,C=this.clipOutput,P=T.setArraySize(h,e+I*m);for(let l=0;l<t;l+=2){let t=C[l],h=C[l+1];P[e]=t,P[e+1]=h,P[e+2]=a.r,P[e+3]=a.g,P[e+4]=a.b,P[e+5]=a.a;let c=t-E,g=h-M,p=(i*c+s*g)*u,f=(d*c+n*g)*u,b=1-p-f;P[e+6]=w*p+v*f+S*b,P[e+7]=x*p+A*f+R*b,o&&(P[e+8]=r.r,P[e+9]=r.g,P[e+10]=r.b,P[e+11]=r.a),e+=m}e=c.length;let k=T.setArraySize(c,e+3*(I-2));I--;for(let t=1;t<I;t++)k[e]=g,k[e+1]=g+t,k[e+2]=g+t+1,e+=3;g+=I+1}}}}clip(t,e,i,s,n,a,r,o){let l=o,h=!1,c=null;r.length%4>=2?(c=o,o=this.scratch):c=this.scratch,c.length=0,c.push(t),c.push(e),c.push(i),c.push(s),c.push(n),c.push(a),c.push(t),c.push(e),o.length=0;let d=r,u=r.length-4;for(let t=0;;t+=2){let e=d[t],i=d[t+1],s=d[t+2],n=d[t+3],a=e-s,r=i-n,m=c,g=c.length-2,p=o.length;for(let t=0;t<g;t+=2){let l=m[t],c=m[t+1],d=m[t+2],u=m[t+3],g=a*(u-n)-r*(d-s)>0;if(a*(c-n)-r*(l-s)>0){if(g){o.push(d),o.push(u);continue}let t=u-c,a=d-l,r=t*(s-e)-a*(n-i);if(Math.abs(r)>1e-6){let h=(a*(i-c)-t*(e-l))/r;o.push(e+(s-e)*h),o.push(i+(n-i)*h)}else o.push(e),o.push(i)}else if(g){let t=u-c,a=d-l,r=t*(s-e)-a*(n-i);if(Math.abs(r)>1e-6){let h=(a*(i-c)-t*(e-l))/r;o.push(e+(s-e)*h),o.push(i+(n-i)*h)}else o.push(e),o.push(i);o.push(d),o.push(u)}h=!0}if(p==o.length)return l.length=0,!0;if(o.push(o[0]),o.push(o[1]),t==u)break;let f=o;(o=c).length=0,c=f}if(l!=o){l.length=0;for(let t=0,e=o.length-2;t<e;t++)l[t]=o[t]}else l.length=l.length-2;return h}static makeClockwise(t){let e=t,i=t.length,s=e[i-2]*e[1]-e[0]*e[i-1],n=0,a=0,r=0,o=0;for(let t=0,l=i-3;t<l;t+=2)n=e[t],a=e[t+1],r=e[t+2],o=e[t+3],s+=n*o-r*a;if(!(s<0))for(let t=0,s=i-2,n=i>>1;t<n;t+=2){let i=e[t],n=e[t+1],a=s-t;e[t]=e[a],e[t+1]=e[a+1],e[a]=i,e[a+1]=n}}}class ge{vertices;numVertices;numFloats;constructor(t,e,i){this.vertices=t,this.numVertices=e,this.numFloats=i}}class pe{static QUAD_TRIANGLES=[0,1,2,2,3,0];premultipliedAlpha=!1;vertexEffect=null;tempColor=new R;tempColor2=new R;vertices;vertexSize=8;twoColorTint=!1;renderable=new ge(null,0,0);clipper=new me;temp=new P;temp2=new P;temp3=new R;temp4=new R;constructor(t,e=!0){this.twoColorTint=e,e&&(this.vertexSize+=4),this.vertices=T.newFloatArray(1024*this.vertexSize)}draw(t,e,i=-1,s=-1){let n=this.clipper,a=this.premultipliedAlpha,r=this.twoColorTint,o=null,l=this.temp,h=this.temp2,c=this.temp3,d=this.temp4,u=this.renderable,m=null,g=null,p=e.drawOrder,f=null,w=e.color,x=r?12:8,b=!1;-1==i&&(b=!0);for(let e=0,y=p.length;e<y;e++){let y=n.isClipping()?2:x,v=p[e];if(!v.bone.active){n.clipEndWithSlot(v);continue}if(i>=0&&i==v.data.index&&(b=!0),!b){n.clipEndWithSlot(v);continue}s>=0&&s==v.data.index&&(b=!1);let E=v.getAttachment(),M=null;if(E instanceof B){let t=E;u.vertices=this.vertices,u.numVertices=4,u.numFloats=y<<2,t.computeWorldVertices(v.bone,u.vertices,0,y),g=pe.QUAD_TRIANGLES,m=t.uvs,M=t.region.renderObject.texture,f=t.color}else{if(!(E instanceof Y)){if(E instanceof O){let t=E;n.clipStart(v,t);continue}n.clipEndWithSlot(v);continue}{let t=E;u.vertices=this.vertices,u.numVertices=t.worldVerticesLength>>1,u.numFloats=u.numVertices*y,u.numFloats>u.vertices.length&&(u.vertices=this.vertices=T.newFloatArray(u.numFloats)),t.computeWorldVertices(v,0,t.worldVerticesLength,u.vertices,0,y),g=t.triangles,M=t.region.renderObject.texture,m=t.uvs,f=t.color}}if(null!=M){let e=v.color,i=this.tempColor;i.r=w.r*e.r*f.r,i.g=w.g*e.g*f.g,i.b=w.b*e.b*f.b,i.a=w.a*e.a*f.a,a&&(i.r*=i.a,i.g*=i.a,i.b*=i.a);let s=this.tempColor2;null==v.darkColor?s.set(0,0,0,1):(a?(s.r=v.darkColor.r*i.a,s.g=v.darkColor.g*i.a,s.b=v.darkColor.b*i.a):s.setFromColor(v.darkColor),s.a=a?1:0);let p=v.data.blendMode;if(p!=o&&(o=p,t.setBlendMode(A.getSourceGLBlendMode(o,a),A.getDestGLBlendMode(o))),n.isClipping()){n.clipTriangles(u.vertices,u.numFloats,g,g.length,m,i,s,r);let e=new Float32Array(n.clippedVertices),a=n.clippedTriangles;if(null!=this.vertexEffect){let t=this.vertexEffect,i=e;if(r)for(let s=0,n=e.length;s<n;s+=x)l.x=i[s],l.y=i[s+1],c.set(i[s+2],i[s+3],i[s+4],i[s+5]),h.x=i[s+6],h.y=i[s+7],d.set(i[s+8],i[s+9],i[s+10],i[s+11]),t.transform(l,h,c,d),i[s]=l.x,i[s+1]=l.y,i[s+2]=c.r,i[s+3]=c.g,i[s+4]=c.b,i[s+5]=c.a,i[s+6]=h.x,i[s+7]=h.y,i[s+8]=d.r,i[s+9]=d.g,i[s+10]=d.b,i[s+11]=d.a;else for(let s=0,n=e.length;s<n;s+=x)l.x=i[s],l.y=i[s+1],c.set(i[s+2],i[s+3],i[s+4],i[s+5]),h.x=i[s+6],h.y=i[s+7],d.set(0,0,0,0),t.transform(l,h,c,d),i[s]=l.x,i[s+1]=l.y,i[s+2]=c.r,i[s+3]=c.g,i[s+4]=c.b,i[s+5]=c.a,i[s+6]=h.x,i[s+7]=h.y}t.draw(M,e,a)}else{let e=u.vertices;if(null!=this.vertexEffect){let t=this.vertexEffect;if(r)for(let n=0,a=0,r=u.numFloats;n<r;n+=x,a+=2)l.x=e[n],l.y=e[n+1],h.x=m[a],h.y=m[a+1],c.setFromColor(i),d.setFromColor(s),t.transform(l,h,c,d),e[n]=l.x,e[n+1]=l.y,e[n+2]=c.r,e[n+3]=c.g,e[n+4]=c.b,e[n+5]=c.a,e[n+6]=h.x,e[n+7]=h.y,e[n+8]=d.r,e[n+9]=d.g,e[n+10]=d.b,e[n+11]=d.a;else for(let s=0,n=0,a=u.numFloats;s<a;s+=x,n+=2)l.x=e[s],l.y=e[s+1],h.x=m[n],h.y=m[n+1],c.setFromColor(i),d.set(0,0,0,0),t.transform(l,h,c,d),e[s]=l.x,e[s+1]=l.y,e[s+2]=c.r,e[s+3]=c.g,e[s+4]=c.b,e[s+5]=c.a,e[s+6]=h.x,e[s+7]=h.y}else if(r)for(let t=2,n=0,a=u.numFloats;t<a;t+=x,n+=2)e[t]=i.r,e[t+1]=i.g,e[t+2]=i.b,e[t+3]=i.a,e[t+4]=m[n],e[t+5]=m[n+1],e[t+6]=s.r,e[t+7]=s.g,e[t+8]=s.b,e[t+9]=s.a;else for(let t=2,s=0,n=u.numFloats;t<n;t+=x,s+=2)e[t]=i.r,e[t+1]=i.g,e[t+2]=i.b,e[t+3]=i.a,e[t+4]=m[s],e[t+5]=m[s+1];let n=u.vertices.subarray(0,u.numFloats);t.draw(M,n,g)}}n.clipEndWithSlot(v)}n.clipEnd()}}class fe{context;canvas;orthoCamera;perspectiveCamera;camera;batcher;twoColorTint=!1;batcherShader;shapes;shapesShader;activeRenderer=null;skeletonRenderer;skeletonDebugRenderer;QUAD=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0];QUAD_TRIANGLES=[0,1,2,2,3,0];WHITE=new R(1,1,1,1);constructor(t,e,i=!0){this.canvas=t,this.context=e instanceof v?e:new v(e),this.twoColorTint=i,this.orthoCamera=new jt(t.width,t.height),this.perspectiveCamera=new Ht(t.width,t.height),this.camera=this.perspectiveCamera,this.batcherShader=i?qt.newTwoColoredTextured(this.context):qt.newColoredTextured(this.context),this.batcher=new le(this.context,i),this.shapesShader=qt.newColored(this.context),this.shapes=new he(this.context),this.skeletonRenderer=new pe(this.context,i),this.skeletonDebugRenderer=new de(this.context)}begin(){this.camera.update(),this.enableRenderer(this.batcher)}drawSkeleton(t,e=!1,i=-1,s=-1){this.enableRenderer(this.batcher),this.skeletonRenderer.premultipliedAlpha=e,this.skeletonRenderer.draw(this.batcher,t,i,s)}drawSkeletonDebug(t,e=!1,i=null){this.enableRenderer(this.shapes),this.skeletonDebugRenderer.premultipliedAlpha=e,this.skeletonDebugRenderer.draw(this.shapes,t,i)}drawTexture(t,e,i,s,n,a=null){this.enableRenderer(this.batcher),null===a&&(a=this.WHITE);let r=this.QUAD;var o=0;r[o++]=e,r[o++]=i,r[o++]=a.r,r[o++]=a.g,r[o++]=a.b,r[o++]=a.a,r[o++]=0,r[o++]=1,this.twoColorTint&&(r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0),r[o++]=e+s,r[o++]=i,r[o++]=a.r,r[o++]=a.g,r[o++]=a.b,r[o++]=a.a,r[o++]=1,r[o++]=1,this.twoColorTint&&(r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0),r[o++]=e+s,r[o++]=i+n,r[o++]=a.r,r[o++]=a.g,r[o++]=a.b,r[o++]=a.a,r[o++]=1,r[o++]=0,this.twoColorTint&&(r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0),r[o++]=e,r[o++]=i+n,r[o++]=a.r,r[o++]=a.g,r[o++]=a.b,r[o++]=a.a,r[o++]=0,r[o++]=0,this.twoColorTint&&(r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0),this.batcher.draw(t,r,this.QUAD_TRIANGLES)}drawTextureUV(t,e,i,s,n,a,r,o,l,h=null){this.enableRenderer(this.batcher),null===h&&(h=this.WHITE);let c=this.QUAD;var d=0;c[d++]=e,c[d++]=i,c[d++]=h.r,c[d++]=h.g,c[d++]=h.b,c[d++]=h.a,c[d++]=a,c[d++]=r,this.twoColorTint&&(c[d++]=0,c[d++]=0,c[d++]=0,c[d++]=0),c[d++]=e+s,c[d++]=i,c[d++]=h.r,c[d++]=h.g,c[d++]=h.b,c[d++]=h.a,c[d++]=o,c[d++]=r,this.twoColorTint&&(c[d++]=0,c[d++]=0,c[d++]=0,c[d++]=0),c[d++]=e+s,c[d++]=i+n,c[d++]=h.r,c[d++]=h.g,c[d++]=h.b,c[d++]=h.a,c[d++]=o,c[d++]=l,this.twoColorTint&&(c[d++]=0,c[d++]=0,c[d++]=0,c[d++]=0),c[d++]=e,c[d++]=i+n,c[d++]=h.r,c[d++]=h.g,c[d++]=h.b,c[d++]=h.a,c[d++]=a,c[d++]=l,this.twoColorTint&&(c[d++]=0,c[d++]=0,c[d++]=0,c[d++]=0),this.batcher.draw(t,c,this.QUAD_TRIANGLES)}drawTextureRotated(t,e,i,s,n,a,r,o,l=null,h=!1){this.enableRenderer(this.batcher),null===l&&(l=this.WHITE);let c=this.QUAD,d=e+a,u=i+r,m=-a,g=-r,p=s-a,f=n-r,w=m,x=g,b=m,y=f,v=p,A=f,E=p,M=g,S=0,R=0,T=0,C=0,P=0,k=0,V=0,N=0;if(0!=o){let t=I.cosDeg(o),e=I.sinDeg(o);S=t*w-e*x,R=e*w+t*x,V=t*b-e*y,N=e*b+t*y,P=t*v-e*A,k=e*v+t*A,T=P+(S-V),C=k+(R-N)}else S=w,R=x,V=b,N=y,P=v,k=A,T=E,C=M;S+=d,R+=u,T+=d,C+=u,P+=d,k+=u,V+=d,N+=u;var L=0;c[L++]=S,c[L++]=R,c[L++]=l.r,c[L++]=l.g,c[L++]=l.b,c[L++]=l.a,c[L++]=0,c[L++]=1,this.twoColorTint&&(c[L++]=0,c[L++]=0,c[L++]=0,c[L++]=0),c[L++]=T,c[L++]=C,c[L++]=l.r,c[L++]=l.g,c[L++]=l.b,c[L++]=l.a,c[L++]=1,c[L++]=1,this.twoColorTint&&(c[L++]=0,c[L++]=0,c[L++]=0,c[L++]=0),c[L++]=P,c[L++]=k,c[L++]=l.r,c[L++]=l.g,c[L++]=l.b,c[L++]=l.a,c[L++]=1,c[L++]=0,this.twoColorTint&&(c[L++]=0,c[L++]=0,c[L++]=0,c[L++]=0),c[L++]=V,c[L++]=N,c[L++]=l.r,c[L++]=l.g,c[L++]=l.b,c[L++]=l.a,c[L++]=0,c[L++]=0,this.twoColorTint&&(c[L++]=0,c[L++]=0,c[L++]=0,c[L++]=0),this.batcher.draw(t,c,this.QUAD_TRIANGLES)}drawRegion(t,e,i,s,n,a=null,r=!1){this.enableRenderer(this.batcher),null===a&&(a=this.WHITE);let o=this.QUAD;var l=0;o[l++]=e,o[l++]=i,o[l++]=a.r,o[l++]=a.g,o[l++]=a.b,o[l++]=a.a,o[l++]=t.u,o[l++]=t.v2,this.twoColorTint&&(o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=0),o[l++]=e+s,o[l++]=i,o[l++]=a.r,o[l++]=a.g,o[l++]=a.b,o[l++]=a.a,o[l++]=t.u2,o[l++]=t.v2,this.twoColorTint&&(o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=0),o[l++]=e+s,o[l++]=i+n,o[l++]=a.r,o[l++]=a.g,o[l++]=a.b,o[l++]=a.a,o[l++]=t.u2,o[l++]=t.v,this.twoColorTint&&(o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=0),o[l++]=e,o[l++]=i+n,o[l++]=a.r,o[l++]=a.g,o[l++]=a.b,o[l++]=a.a,o[l++]=t.u,o[l++]=t.v,this.twoColorTint&&(o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=0),this.batcher.draw(t.texture,o,this.QUAD_TRIANGLES)}line(t,e,i,s,n=null,a=null){this.enableRenderer(this.shapes),this.shapes.line(t,e,i,s,n)}triangle(t,e,i,s,n,a,r,o=null,l=null,h=null){this.enableRenderer(this.shapes),this.shapes.triangle(t,e,i,s,n,a,r,o,l,h)}quad(t,e,i,s,n,a,r,o,l,h=null,c=null,d=null,u=null){this.enableRenderer(this.shapes),this.shapes.quad(t,e,i,s,n,a,r,o,l,h,c,d,u)}rect(t,e,i,s,n,a=null){this.enableRenderer(this.shapes),this.shapes.rect(t,e,i,s,n,a)}rectLine(t,e,i,s,n,a,r=null){this.enableRenderer(this.shapes),this.shapes.rectLine(t,e,i,s,n,a,r)}polygon(t,e,i,s=null){this.enableRenderer(this.shapes),this.shapes.polygon(t,e,i,s)}circle(t,e,i,s,n=null,a=0){this.enableRenderer(this.shapes),this.shapes.circle(t,e,i,s,n,a)}curve(t,e,i,s,n,a,r,o,l,h=null){this.enableRenderer(this.shapes),this.shapes.curve(t,e,i,s,n,a,r,o,l,h)}end(){this.activeRenderer===this.batcher?this.batcher.end():this.activeRenderer===this.shapes&&this.shapes.end(),this.activeRenderer=null}resize(t){let e=this.canvas;var i=e.clientWidth,s=e.clientHeight;if(e.width==i&&e.height==s||(e.width=i,e.height=s),this.context.gl.viewport(0,0,e.width,e.height),t===re.Stretch);else if(t===re.Expand)this.camera.setViewport(i,s);else if(t===re.Fit){let t=e.width,i=e.height,s=this.camera.viewportWidth,n=this.camera.viewportHeight,a=n/s<i/t?s/t:n/i;this.camera.viewportWidth=t*a,this.camera.viewportHeight=i*a}this.camera.update()}enableRenderer(t){this.activeRenderer!==t&&(this.end(),t instanceof le?(this.batcherShader.bind(),this.batcherShader.setUniform4x4f(qt.MVP_MATRIX,this.camera.projectionView.values),this.batcherShader.setUniformi("u_texture",0),this.batcher.begin(this.batcherShader),this.activeRenderer=this.batcher):t instanceof he?(this.shapesShader.bind(),this.shapesShader.setUniform4x4f(qt.MVP_MATRIX,this.camera.projectionView.values),this.shapes.begin(this.shapesShader),this.activeRenderer=this.shapes):this.activeRenderer=this.skeletonDebugRenderer)}dispose(){this.batcher.dispose(),this.batcherShader.dispose(),this.shapes.dispose(),this.shapesShader.dispose(),this.skeletonDebugRenderer.dispose()}}!function(t){t[t.Stretch=0]="Stretch",t[t.Expand=1]="Expand",t[t.Fit=2]="Fit"}(re||(re={}));class we{static FADE_SECONDS=1;static loaded=0;static spinnerImg=null;static logoImg=null;renderer;logo=null;spinner=null;angle=0;fadeOut=0;timeKeeper=new k;backgroundColor=new R(.135,.135,.135,1);tempColor=new R;firstDraw=0;static SPINNER_DATA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKMAAACjCAYAAADmbK6AAAAACXBIWXMAAAsTAAALEwEAmpwYAAALB2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNS41IChXaW5kb3dzKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTYtMDktMDhUMTQ6MjU6MTIrMDI6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTgtMTEtMTVUMTY6NDA6NTkrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTExLTE1VDE2OjQwOjU5KzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpmZDhlNTljMC02NGJjLTIxNGQtODAyZi1jZDlhODJjM2ZjMGMiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpmYmNmZWJlYS03MjY2LWE0NGQtOTI4NS0wOTJmNGNhYzk4ZWEiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowODMzNWIyYy04NzYyLWQzNGMtOTBhOS02ODJjYjJmYTQ2M2UiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHRpZmY6T3JpZW50YXRpb249IjEiIHRpZmY6WFJlc29sdXRpb249IjcyMDAwMC8xMDAwMCIgdGlmZjpZUmVzb2x1dGlvbj0iNzIwMDAwLzEwMDAwIiB0aWZmOlJlc29sdXRpb25Vbml0PSIyIiBleGlmOkNvbG9yU3BhY2U9IjY1NTM1IiBleGlmOlBpeGVsWERpbWVuc2lvbj0iMjk3IiBleGlmOlBpeGVsWURpbWVuc2lvbj0iMjQyIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDowODMzNWIyYy04NzYyLWQzNGMtOTBhOS02ODJjYjJmYTQ2M2UiIHN0RXZ0OndoZW49IjIwMTYtMDktMDhUMTQ6MjU6MTIrMDI6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1LjUgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpiNThlMTlkNi0xYTRjLTQyNDEtODU0ZC01MDVlZjYxMjRhODQiIHN0RXZ0OndoZW49IjIwMTgtMTEtMTVUMTY6NDA6MjMrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ3YzYzYzIwLWJkYjgtYzM0YS1hYzMyLWQ5MDdjOWEyOTA0MCIgc3RFdnQ6d2hlbj0iMjAxOC0xMS0xNVQxNjo0MDo1OSswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZmQ4ZTU5YzAtNjRiYy0yMTRkLTgwMmYtY2Q5YTgyYzNmYzBjIiBzdEV2dDp3aGVuPSIyMDE4LTExLTE1VDE2OjQwOjU5KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0N2M2M2MyMC1iZGI4LWMzNGEtYWMzMi1kOTA3YzlhMjkwNDAiIHN0UmVmOmRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo2OWRmZjljYy01YzFiLWE5NDctOTc3OS03ODgxZjM0ODk3MDMiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowODMzNWIyYy04NzYyLWQzNGMtOTBhOS02ODJjYjJmYTQ2M2UiLz4gPHBob3Rvc2hvcDpEb2N1bWVudEFu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";static SPINE_LOGO_DATA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKUAAABsCAYAAAALzHKmAAAACXBIWXMAAAsTAAALEwEAmpwYAAALB2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNS41IChXaW5kb3dzKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTYtMDktMDhUMTQ6MjU6MTIrMDI6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTgtMTEtMTVUMTY6NDA6NTkrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTExLTE1VDE2OjQwOjU5KzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowMTdhZGQ3Ni04OTZlLThlNGUtYmM5MS00ZjEyNjI1YjA3MjgiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDplMTViNGE2ZS1hMDg3LWEzNDktODdhOS1mNDYzYjE2MzQ0Y2MiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowODMzNWIyYy04NzYyLWQzNGMtOTBhOS02ODJjYjJmYTQ2M2UiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHRpZmY6T3JpZW50YXRpb249IjEiIHRpZmY6WFJlc29sdXRpb249IjcyMDAwMC8xMDAwMCIgdGlmZjpZUmVzb2x1dGlvbj0iNzIwMDAwLzEwMDAwIiB0aWZmOlJlc29sdXRpb25Vbml0PSIyIiBleGlmOkNvbG9yU3BhY2U9IjY1NTM1IiBleGlmOlBpeGVsWERpbWVuc2lvbj0iMjk3IiBleGlmOlBpeGVsWURpbWVuc2lvbj0iMjQyIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDowODMzNWIyYy04NzYyLWQzNGMtOTBhOS02ODJjYjJmYTQ2M2UiIHN0RXZ0OndoZW49IjIwMTYtMDktMDhUMTQ6MjU6MTIrMDI6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1LjUgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpiNThlMTlkNi0xYTRjLTQyNDEtODU0ZC01MDVlZjYxMjRhODQiIHN0RXZ0OndoZW49IjIwMTgtMTEtMTVUMTY6NDA6MjMrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjJlNjJiMWM2LWIxYzQtNDk0MC04MDMxLWU4ZDkyNTBmODJjNSIgc3RFdnQ6d2hlbj0iMjAxOC0xMS0xNVQxNjo0MDo1OSswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MDE3YWRkNzYtODk2ZS04ZTRlLWJjOTEtNGYxMjYyNWIwNzI4IiBzdEV2dDp3aGVuPSIyMDE4LTExLTE1VDE2OjQwOjU5KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoyZTYyYjFjNi1iMWM0LTQ5NDAtODAzMS1lOGQ5MjUwZjgyYzUiIHN0UmVmOmRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo2OWRmZjljYy01YzFiLWE5NDctOTc3OS03ODgxZjM0ODk3MDMiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowODMzNWIyYy04NzYyLWQzNGMtOTBhOS02ODJjYjJmYTQ2M2UiLz4gPHBob3Rvc2hvcDpEb2N1bWVudEFu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";constructor(t){if(this.renderer=t,this.timeKeeper.maxDelta=9,null===we.logoImg){let t=navigator.userAgent.indexOf("Safari")>-1;we.logoImg=new Image,we.logoImg.src=we.SPINE_LOGO_DATA,t||(we.logoImg.crossOrigin="anonymous"),we.logoImg.onload=t=>{we.loaded++},we.spinnerImg=new Image,we.spinnerImg.src=we.SPINNER_DATA,t||(we.spinnerImg.crossOrigin="anonymous"),we.spinnerImg.onload=t=>{we.loaded++}}}draw(t=!1){if(t&&this.fadeOut>we.FADE_SECONDS)return;this.timeKeeper.update();let e=Math.abs(Math.sin(this.timeKeeper.totalTime+.75));this.angle-=this.timeKeeper.delta/1.4*360*(1+1.5*Math.pow(e,5));let i=this.renderer,s=i.canvas,n=i.context.gl;if(i.resize(re.Stretch),i.camera,t){if(this.fadeOut+=this.timeKeeper.delta*(this.timeKeeper.totalTime<1?2:1),this.fadeOut>we.FADE_SECONDS)return;e=1-this.fadeOut/we.FADE_SECONDS,this.tempColor.setFromColor(this.backgroundColor),this.tempColor.a=1-(e-1)*(e-1),i.begin();let t=s.width/2;i.quad(!0,0-t,0,s.width-t,0,s.width-t,s.height,0-t,s.height,this.tempColor,this.tempColor,this.tempColor,this.tempColor),i.end()}else n.clearColor(this.backgroundColor.r,this.backgroundColor.g,this.backgroundColor.b,this.backgroundColor.a),n.clear(n.COLOR_BUFFER_BIT),this.tempColor.a=1;if(this.tempColor.set(1,1,1,this.tempColor.a),2!=we.loaded)return;null===this.logo&&(this.logo=new E(i.context,we.logoImg),this.spinner=new E(i.context,we.spinnerImg)),this.logo.update(!1),this.spinner.update(!1);let a=this.logo.getImage().width,r=this.logo.getImage().height,o=this.spinner.getImage().width,l=this.spinner.getImage().height;i.batcher.setBlendMode(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),i.begin(),i.drawTexture(this.logo,-a/2,(s.height-r)/2,a,r,this.tempColor),i.drawTextureRotated(this.spinner,-o/2,(s.height-l)/2,o,l,o/2,l/2,this.angle,this.tempColor),i.end()}}class xe{static emptyAnimation=new Q("<empty>",[],0);static SUBSEQUENT=0;static FIRST=1;static HOLD=2;static HOLD_MIX=3;static SETUP=1;static CURRENT=2;data;tracks=new Array;timeScale=1;unkeyedState=0;events=new Array;listeners=new Array;queue=new ye(this);propertyIDs=new S;animationsChanged=!1;trackEntryPool=new C((()=>new be));constructor(t){this.data=t}update(t){t*=this.timeScale;let e=this.tracks;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(null==s)continue;s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast;let n=t*s.timeScale;if(s.delay>0){if(s.delay-=n,s.delay>0)continue;n=-s.delay,s.delay=0}let a=s.next;if(null!=a){let e=s.trackLast-a.delay;if(e>=0){for(a.delay=0,a.trackTime+=0==s.timeScale?0:(e/s.timeScale+t)*a.timeScale,s.trackTime+=n,this.setCurrent(i,a,!0);null!=a.mixingFrom;)a.mixTime+=t,a=a.mixingFrom;continue}}else if(s.trackLast>=s.trackEnd&&null==s.mixingFrom){e[i]=null,this.queue.end(s),this.disposeNext(s);continue}if(null!=s.mixingFrom&&this.updateMixingFrom(s,t)){let t=s.mixingFrom;for(s.mixingFrom=null,null!=t&&(t.mixingTo=null);null!=t;)this.queue.end(t),t=t.mixingFrom}s.trackTime+=n}this.queue.drain()}updateMixingFrom(t,e){let i=t.mixingFrom;if(null==i)return!0;let s=this.updateMixingFrom(i,e);return i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?(0!=i.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=i.mixingFrom,null!=i.mixingFrom&&(i.mixingFrom.mixingTo=t),t.interruptAlpha=i.interruptAlpha,this.queue.end(i)),s):(i.trackTime+=e*i.timeScale,t.mixTime+=e,!1)}apply(t){if(null==t)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let e=this.events,i=this.tracks,s=!1;for(let a=0,r=i.length;a<r;a++){let r=i[a];if(null==r||r.delay>0)continue;s=!0;let o=0==a?d.first:r.mixBlend,l=r.alpha;null!=r.mixingFrom?l*=this.applyMixingFrom(r,t,o):r.trackTime>=r.trackEnd&&null==r.next&&(l=0);let h=r.animationLast,c=r.getAnimationTime(),m=r.animation.timelines.length,g=r.animation.timelines;if(0==a&&1==l||o==d.add)for(let i=0;i<m;i++){T.webkit602BugfixHelper(l,o);var n=g[i];n instanceof nt?this.applyAttachmentTimeline(n,t,c,o,!0):n.apply(t,h,c,e,l,o,u.mixIn)}else{let i=r.timelineMode,s=0==r.timelinesRotation.length;s&&T.setArraySize(r.timelinesRotation,m<<1,null);let n=r.timelinesRotation;for(let a=0;a<m;a++){let r=g[a],m=i[a]==xe.SUBSEQUENT?o:d.setup;r instanceof K?this.applyRotateTimeline(r,t,c,l,m,n,a<<1,s):r instanceof nt?this.applyAttachmentTimeline(r,t,c,o,!0):(T.webkit602BugfixHelper(l,o),r.apply(t,h,c,e,l,m,u.mixIn))}}this.queueEvents(r,c),e.length=0,r.nextAnimationLast=c,r.nextTrackLast=r.trackTime}for(var a=this.unkeyedState+xe.SETUP,r=t.slots,o=0,l=t.slots.length;o<l;o++){var h=r[o];if(h.attachmentState==a){var c=h.data.attachmentName;h.attachment=null==c?null:t.getAttachment(h.data.index,c)}}return this.unkeyedState+=2,this.queue.drain(),s}applyMixingFrom(t,e,i){let s=t.mixingFrom;null!=s.mixingFrom&&this.applyMixingFrom(s,e,i);let n=0;0==t.mixDuration?(n=1,i==d.first&&(i=d.setup)):(n=t.mixTime/t.mixDuration,n>1&&(n=1),i!=d.first&&(i=s.mixBlend));let a=n<s.eventThreshold?this.events:null,r=n<s.attachmentThreshold,o=n<s.drawOrderThreshold,l=s.animationLast,h=s.getAnimationTime(),c=s.animation.timelines.length,m=s.animation.timelines,g=s.alpha*t.interruptAlpha,p=g*(1-n);if(i==d.add)for(let t=0;t<c;t++)m[t].apply(e,l,h,a,p,i,u.mixOut);else{let t=s.timelineMode,n=s.timelineHoldMix,f=0==s.timelinesRotation.length;f&&T.setArraySize(s.timelinesRotation,c<<1,null);let w=s.timelinesRotation;s.totalAlpha=0;for(let x=0;x<c;x++){let c,b=m[x],y=u.mixOut,v=0;switch(t[x]){case xe.SUBSEQUENT:if(!o&&b instanceof lt)continue;c=i,v=p;break;case xe.FIRST:c=d.setup,v=p;break;case xe.HOLD:c=d.setup,v=g;break;default:c=d.setup;let t=n[x];v=g*Math.max(0,1-t.mixTime/t.mixDuration)}s.totalAlpha+=v,b instanceof K?this.applyRotateTimeline(b,e,h,v,c,w,x<<1,f):b instanceof nt?this.applyAttachmentTimeline(b,e,h,c,r):(T.webkit602BugfixHelper(v,i),o&&b instanceof lt&&c==d.setup&&(y=u.mixIn),b.apply(e,l,h,a,v,c,y))}}return t.mixDuration>0&&this.queueEvents(s,h),this.events.length=0,s.nextAnimationLast=h,s.nextTrackLast=s.trackTime,n}applyAttachmentTimeline(t,e,i,s,n){var a=e.slots[t.slotIndex];if(a.bone.active){var r,o=t.frames;i<o[0]?s!=d.setup&&s!=d.first||this.setAttachment(e,a,a.data.attachmentName,n):(r=i>=o[o.length-1]?o.length-1:Q.binarySearch(o,i)-1,this.setAttachment(e,a,t.attachmentNames[r],n)),a.attachmentState<=this.unkeyedState&&(a.attachmentState=this.unkeyedState+xe.SETUP)}}setAttachment(t,e,i,s){e.attachment=null==i?null:t.getAttachment(e.data.index,i),s&&(e.attachmentState=this.unkeyedState+xe.CURRENT)}applyRotateTimeline(t,e,i,s,n,a,r,o){if(o&&(a[r]=0),1==s)return void t.apply(e,0,i,null,1,n,u.mixIn);let l=t,h=l.frames,c=e.bones[l.boneIndex];if(!c.active)return;let m=0,g=0;if(i<h[0])switch(n){case d.setup:c.rotation=c.data.rotation;default:return;case d.first:m=c.rotation,g=c.data.rotation}else if(m=n==d.setup?c.data.rotation:c.rotation,i>=h[h.length-K.ENTRIES])g=c.data.rotation+h[h.length+K.PREV_ROTATION];else{let t=Q.binarySearch(h,i,K.ENTRIES),e=h[t+K.PREV_ROTATION],s=h[t],n=l.getCurvePercent((t>>1)-1,1-(i-s)/(h[t+K.PREV_TIME]-s));g=h[t+K.ROTATION]-e,g-=360*(16384-(16384.499999999996-g/360|0)),g=e+g*n+c.data.rotation,g-=360*(16384-(16384.499999999996-g/360|0))}let p=0,f=g-m;if(f-=360*(16384-(16384.499999999996-f/360|0)),0==f)p=a[r];else{let t=0,e=0;o?(t=0,e=f):(t=a[r],e=a[r+1]);let i=f>0,s=t>=0;I.signum(e)!=I.signum(f)&&Math.abs(e)<=90&&(Math.abs(t)>180&&(t+=360*I.signum(t)),s=i),p=f+t-t%360,s!=i&&(p+=360*I.signum(t)),a[r]=p}a[r+1]=f,m+=p*s,c.rotation=m-360*(16384-(16384.499999999996-m/360|0))}queueEvents(t,e){let i=t.animationStart,s=t.animationEnd,n=s-i,a=t.trackLast%n,r=this.events,o=0,l=r.length;for(;o<l;o++){let e=r[o];if(e.time<a)break;e.time>s||this.queue.event(t,e)}let h=!1;for(h=t.loop?0==n||a>t.trackTime%n:e>=s&&t.animationLast<s,h&&this.queue.complete(t);o<l;o++)r[o].time<i||this.queue.event(t,r[o])}clearTracks(){let t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;let e=this.tracks[t];if(null==e)return;this.queue.end(e),this.disposeNext(e);let i=e;for(;;){let t=i.mixingFrom;if(null==t)break;this.queue.end(t),i.mixingFrom=null,i.mixingTo=null,i=t}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,i){let s=this.expandToIndex(t);this.tracks[t]=e,null!=s&&(i&&this.queue.interrupt(s),e.mixingFrom=s,s.mixingTo=e,e.mixTime=0,null!=s.mixingFrom&&s.mixDuration>0&&(e.interruptAlpha*=Math.min(1,s.mixTime/s.mixDuration)),s.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,i){let s=this.data.skeletonData.findAnimation(e);if(null==s)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,s,i)}setAnimationWith(t,e,i){if(null==e)throw new Error("animation cannot be null.");let s=!0,n=this.expandToIndex(t);null!=n&&(-1==n.nextTrackLast?(this.tracks[t]=n.mixingFrom,this.queue.interrupt(n),this.queue.end(n),this.disposeNext(n),n=n.mixingFrom,s=!1):this.disposeNext(n));let a=this.trackEntry(t,e,i,n);return this.setCurrent(t,a,s),this.queue.drain(),a}addAnimation(t,e,i,s){let n=this.data.skeletonData.findAnimation(e);if(null==n)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,n,i,s)}addAnimationWith(t,e,i,s){if(null==e)throw new Error("animation cannot be null.");let n=this.expandToIndex(t);if(null!=n)for(;null!=n.next;)n=n.next;let a=this.trackEntry(t,e,i,n);if(null==n)this.setCurrent(t,a,!0),this.queue.drain();else if(n.next=a,s<=0){let t=n.animationEnd-n.animationStart;0!=t?(n.loop?s+=t*(1+(n.trackTime/t|0)):s+=Math.max(t,n.trackTime),s-=this.data.getMix(n.animation,e)):s=n.trackTime}return a.delay=s,a}setEmptyAnimation(t,e){let i=this.setAnimationWith(t,xe.emptyAnimation,!1);return i.mixDuration=e,i.trackEnd=e,i}addEmptyAnimation(t,e,i){i<=0&&(i-=e);let s=this.addAnimationWith(t,xe.emptyAnimation,!1,i);return s.mixDuration=e,s.trackEnd=e,s}setEmptyAnimations(t){let e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,i=this.tracks.length;e<i;e++){let i=this.tracks[e];null!=i&&this.setEmptyAnimation(i.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(T.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,i,s){let n=this.trackEntryPool.obtain();return n.trackIndex=t,n.animation=e,n.loop=i,n.holdPrevious=!1,n.eventThreshold=0,n.attachmentThreshold=0,n.drawOrderThreshold=0,n.animationStart=0,n.animationEnd=e.duration,n.animationLast=-1,n.nextAnimationLast=-1,n.delay=0,n.trackTime=0,n.trackLast=-1,n.nextTrackLast=-1,n.trackEnd=Number.MAX_VALUE,n.timeScale=1,n.alpha=1,n.interruptAlpha=1,n.mixTime=0,n.mixDuration=null==s?0:this.data.getMix(s.animation,e),n.mixBlend=d.replace,n}disposeNext(t){let e=t.next;for(;null!=e;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let t=0,e=this.tracks.length;t<e;t++){let e=this.tracks[t];if(null!=e){for(;null!=e.mixingFrom;)e=e.mixingFrom;do{null!=e.mixingFrom&&e.mixBlend==d.add||this.computeHold(e),e=e.mixingTo}while(null!=e)}}}computeHold(t){let e=t.mixingTo,i=t.animation.timelines,s=t.animation.timelines.length,n=T.setArraySize(t.timelineMode,s);t.timelineHoldMix.length=0;let a=T.setArraySize(t.timelineHoldMix,s),r=this.propertyIDs;if(null!=e&&e.holdPrevious)for(let t=0;t<s;t++)r.add(i[t].getPropertyId()),n[t]=xe.HOLD;else t:for(let o=0;o<s;o++){let s=i[o],l=s.getPropertyId();if(r.add(l))if(null==e||s instanceof nt||s instanceof lt||s instanceof ot||!e.animation.hasTimeline(l))n[o]=xe.FIRST;else{for(let i=e.mixingTo;null!=i;i=i.mixingTo)if(!i.animation.hasTimeline(l)){if(t.mixDuration>0){n[o]=xe.HOLD_MIX,a[o]=i;continue t}break}n[o]=xe.HOLD}else n[o]=xe.SUBSEQUENT}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){let e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}}class be{animation;next;mixingFrom;mixingTo;listener;trackIndex;loop;holdPrevious;eventThreshold;attachmentThreshold;drawOrderThreshold;animationStart;animationEnd;animationLast;nextAnimationLast;delay;trackTime;trackLast;nextTrackLast;trackEnd;timeScale;alpha;mixTime;mixDuration;interruptAlpha;totalAlpha;mixBlend=d.replace;timelineMode=new Array;timelineHoldMix=new Array;timelinesRotation=new Array;reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}}class ye{objects=[];drainDisabled=!1;animState;constructor(t){this.animState=t}start(t){this.objects.push(oe.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(oe.interrupt),this.objects.push(t)}end(t){this.objects.push(oe.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(oe.dispose),this.objects.push(t)}complete(t){this.objects.push(oe.complete),this.objects.push(t)}event(t,e){this.objects.push(oe.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let t=this.objects,e=this.animState.listeners;for(let i=0;i<t.length;i+=2){let s=t[i],n=t[i+1];switch(s){case oe.start:null!=n.listener&&n.listener.start&&n.listener.start(n);for(let t=0;t<e.length;t++)e[t].start&&e[t].start(n);break;case oe.interrupt:null!=n.listener&&n.listener.interrupt&&n.listener.interrupt(n);for(let t=0;t<e.length;t++)e[t].interrupt&&e[t].interrupt(n);break;case oe.end:null!=n.listener&&n.listener.end&&n.listener.end(n);for(let t=0;t<e.length;t++)e[t].end&&e[t].end(n);case oe.dispose:null!=n.listener&&n.listener.dispose&&n.listener.dispose(n);for(let t=0;t<e.length;t++)e[t].dispose&&e[t].dispose(n);this.animState.trackEntryPool.free(n);break;case oe.complete:null!=n.listener&&n.listener.complete&&n.listener.complete(n);for(let t=0;t<e.length;t++)e[t].complete&&e[t].complete(n);break;case oe.event:let s=t[2+i++];null!=n.listener&&n.listener.event&&n.listener.event(n,s);for(let t=0;t<e.length;t++)e[t].event&&e[t].event(n,s)}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}!function(t){t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event"}(oe||(oe={}));class ve{skeletonData;animationToMixTime={};defaultMix=0;constructor(t){if(null==t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,i){let s=this.skeletonData.findAnimation(t);if(null==s)throw new Error("Animation not found: "+t);let n=this.skeletonData.findAnimation(e);if(null==n)throw new Error("Animation not found: "+e);this.setMixWith(s,n,i)}setMixWith(t,e,i){if(null==t)throw new Error("from cannot be null.");if(null==e)throw new Error("to cannot be null.");let s=t.name+"."+e.name;this.animationToMixTime[s]=i}getMix(t,e){let i=t.name+"."+e.name,s=this.animationToMixTime[i];return void 0===s?this.defaultMix:s}}class Ae{static PLAY_ANIMATION="PLAY_ANIMATION";static WANDER="WANDER";static WALK_TO="WALK_TO";static PACE_AROUND="PACE_AROUND"}class Ee{actionData;startPosition;endPosition;currentAnimation;constructor(t){this.actionData=t,this.currentAnimation=null,this.endPosition=null}getRandomPosition(t,e){let i=e.width/2,s=Math.random();return new P(s*e.width-i,t.y)}SetAnimation(t,e,i){const s=t.config.startPosY*i.y;"Sit"==e?t.setPositionY(s+Math.abs(t.animViewport.y)):t.setPositionY(s),this.currentAnimation=e,this.currentAnimation.includes("Move")&&(this.startPosition=null,this.endPosition=null)}GetAnimations(){return this.actionData.animations}UpdatePhysics(t,e,i){if(this.currentAnimation.includes("Move")){null==this.endPosition&&(this.startPosition=t.getPosition(),this.endPosition=this.getRandomPosition(t.getPosition(),i));let s=this.endPosition.subtract(t.getPosition());s.length()<5&&(t.setPosition(this.endPosition.x,this.endPosition.y,0),this.startPosition=t.getPosition(),this.endPosition=this.getRandomPosition(t.getPosition(),i)),s.normalize(),t.setVelocity(s.x*t.getMovementSpeedX()*e,s.y*t.getMovementSpeedY()*e,0)}else t.setVelocity(0,0,0)}}class Me{actionData;startPosition=null;endPosition=null;constructor(t){this.actionData=t,this.startPosition=null,this.endPosition=null}getRandomPosition(t,e){let i=e.width/2;return new P(Math.random()*e.width-i,t.y)}SetAnimation(t,e,i){t.setPositionY(t.config.startPosY*i.y)}GetAnimations(){return[this.actionData.wander_animation]}UpdatePhysics(t,e,i){null==this.endPosition&&(this.startPosition=t.getPosition(),this.endPosition=this.getRandomPosition(t.getPosition(),i));let s=this.endPosition.subtract(t.getPosition());s.length()<5&&(t.setPosition(this.endPosition.x,this.endPosition.y,0),this.startPosition=t.getPosition(),this.endPosition=this.getRandomPosition(t.getPosition(),i)),s.normalize(),t.setVelocity(s.x*t.getMovementSpeedX()*e,s.y*t.getMovementSpeedY()*e,0)}}class Se{actionData;startPosition=null;endPosition=null;startDir=null;reachedDestination;constructor(t){this.actionData=t,this.startPosition=null,this.endPosition=null,this.startDir=null,this.reachedDestination=!1}SetAnimation(t,e,i){t.setPositionY(t.config.startPosY*i.y)}GetAnimations(){return this.reachedDestination?[this.actionData.walk_to_final_animation]:[this.actionData.walk_to_animation]}UpdatePhysics(t,e,i){if(this.reachedDestination)return;if(null==this.endPosition){this.startPosition=t.getPosition();let e=new P(this.actionData.target_pos.x,this.actionData.target_pos.y);this.endPosition=new P(e.x*i.width-i.width/2,0),this.startDir=this.endPosition.subtract(this.startPosition),this.startDir.length()<10&&(this.reachedDestination=!0),this.startDir=this.startDir.normalize()}let s=this.endPosition.subtract(t.getPosition()).normalize(),n=this.startDir.angle(s);Math.abs(Math.PI-n)<.001||this.reachedDestination?(t.setPosition(this.endPosition.x,this.endPosition.y,0),this.startPosition=t.getPosition(),t.setVelocity(0,0,0),this.reachedDestination=!0,t.InitAnimationState()):t.setVelocity(s.x*t.getMovementSpeedX()*e,s.y*t.getMovementSpeedY()*e,0)}}class Re{actionData;startPosition=null;endPosition=null;reachedDestination;constructor(t){this.actionData=t,this.startPosition=null,this.endPosition=null,this.reachedDestination=!1}SetAnimation(t,e,i){t.setPositionY(t.config.startPosY*i.y)}GetAnimations(){return[this.actionData.pace_around_animation]}UpdatePhysics(t,e,i){if(this.reachedDestination){this.reachedDestination=!1;let t=this.startPosition;return this.startPosition=this.endPosition,void(this.endPosition=t)}if(null==this.endPosition){let e=20*Math.random(),s=20*Math.random(),n=new Ct(this.actionData.pace_start_pos.x,this.actionData.pace_start_pos.y,e),a=new Ct(this.actionData.pace_end_pos.x,this.actionData.pace_end_pos.y,s);this.startPosition=new Ct(n.x*i.width-i.width/2,n.y*i.height,n.z),this.endPosition=new Ct(a.x*i.width-i.width/2,a.y*i.height,a.z),this.endPosition.copy().sub(t.getPosition3()).length()<10&&(this.reachedDestination=!0)}let s=this.endPosition.copy().sub(t.getPosition3()).normalize();this.endPosition.copy().sub(t.getPosition3()).length()<10||this.reachedDestination?(t.setPosition(this.endPosition.x,this.endPosition.y,this.endPosition.z),t.setVelocity(0,0,0),this.reachedDestination=!0):t.setVelocity(s.x*t.getMovementSpeedX()*e,s.y*t.getMovementSpeedY()*e,s.z*t.getMovementSpeedZ()*e)}}class Ie{loaded;skeleton;animationState;time=new k;paused=!1;playTime=0;speed=1;config;lastAnimation=null;viewport=null;animViewport=null;prevAnimViewport=null;defaultBB=null;movementSpeed=new Ct;position=new Ct;scale=new P(1,1);velocity=new Ct(0,0,0);startPosition=null;currentAction=null;load_attempts=0;max_load_attempts=10;load_perma_failed=!1;loadedWhen=(new Date).getTime();constructor(t,e){this.loadedWhen=(new Date).getTime(),this.viewport=e,this.ResetWithConfig(t);let i=Math.random()*e.width-e.width/2;this.position=new Ct(i,0,0),(t.startPosX||t.startPosY)&&(this.position=new Ct(t.startPosX*e.width-e.width/2,t.startPosY*e.height,0))}getPosition(){return new P(this.position.x,this.position.y)}getPosition3(){return new Ct(this.position.x,this.position.y,this.position.z)}getPositionX(){return this.position.x}getPositionY(){return this.position.y}getPositionZ(){return this.position.z}setPositionX(t){this.position.x=t}setPositionY(t){this.position.y=t}setPositionZ(t){this.position.z=t}setPosition(t,e,i){this.position.x=t,this.position.y=e,this.position.z=void 0!==i?i:0}getMovmentSpeed(){return new P(this.movementSpeed.x,this.movementSpeed.y)}getMovmentSpeed3(){return new Ct(this.movementSpeed.x,this.movementSpeed.y,this.movementSpeed.z)}getMovementSpeedX(){return this.movementSpeed.x}getMovementSpeedY(){return this.movementSpeed.y}getMovementSpeedZ(){return this.movementSpeed.z}setMovementSpeedX(t){this.movementSpeed.x=t}setMovementSpeedY(t){this.movementSpeed.y=t}setMovementSpeedZ(t){this.movementSpeed.z=t}setMovementSpeed(t,e,i){this.movementSpeed.x=t,this.movementSpeed.y=e,this.movementSpeed.z=void 0!==i?i:this.config.defaultMovementSpeedPxZ}getVelocity(){return new P(this.velocity.x,this.velocity.y)}getVelocity3(){return new Ct(this.velocity.x,this.velocity.y,this.velocity.z)}setVelocity(t,e,i){this.velocity=new Ct(null!=t?t:this.velocity.x,null!=e?e:this.velocity.y,null!=i?i:this.velocity.z)}InitAnimations(){this.initAnimationsInternal(this.currentAction.GetAnimations())}GetAnimations(){return this.currentAction.GetAnimations()}ResetWithConfig(t){this.load_attempts=0,this.load_perma_failed=!1,this.loaded=!1,this.skeleton=null,this.animationState=null,this.time=new k,this.paused=!1,this.playTime=0,this.speed=1,this.config=t,this.animViewport=null,this.prevAnimViewport=null,this.defaultBB=null,null!==t.movementSpeedPxX&&null!==t.movementSpeedPxY&&null!==t.movementSpeedPxZ?this.movementSpeed=new Ct(t.movementSpeedPxX,t.movementSpeedPxY,t.movementSpeedPxZ):this.movementSpeed=new Ct(t.defaultMovementSpeedPxX+Math.random()*t.defaultMovementSpeedPxX/2,t.defaultMovementSpeedPxY,t.defaultMovementSpeedPxZ),this.scale.x=Math.sign(this.scale.x)*t.scaleX,this.scale.y=Math.sign(this.scale.y)*t.scaleY,this.currentAction=function(t,e){switch(t){case Ae.PLAY_ANIMATION:return new Ee(e);case Ae.WANDER:return new Me(e);case Ae.WALK_TO:return new Se(e);case Ae.PACE_AROUND:return new Re(e);default:return console.log("Unknown action name ",t),null}}(this.config.action,this.config.action_data)}UpdatePhysics(t,e){this.currentAction.UpdatePhysics(this,t,e),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.position.z+=this.velocity.z,0!=this.velocity.x&&(this.velocity.x>0?this.scale.x=this.config.scaleX:this.scale.x=-this.config.scaleX),this.setSkeletonMovementData(e)}InitAnimationState(){let t=this.skeleton.data,e=new ve(t);e.defaultMix=this.config.defaultMix,this.animationState=new xe(e),this.config.animation_listener&&(this.animationState.clearListeners(),this.animationState.addListener(this.config.animation_listener)),this.GetAnimations()&&this.animationState&&(this.animationState.getCurrent(0)||this.InitAnimations())}GetUsernameHeaderHeight(){let t=0;if(this.config.chibiId.includes("enemy_"))t=this.defaultBB.height;else{let e=70*this.config.scaleY/.15,i=this.defaultBB.height;t=i>e?e:i}return t+Math.abs(this.config.extraOffsetY)}setSkeletonMovementData(t){this.skeleton.x=this.position.x+this.config.extraOffsetX,this.skeleton.y=this.position.y+this.config.extraOffsetY,this.skeleton.scaleX=this.scale.x,this.skeleton.scaleY=this.scale.y}recordAnimation(t){this.currentAction.SetAnimation(this,t,this.viewport),this.lastAnimation=t}initAnimationsInternal(t){this.setAnimationState(t),this.recordAnimation(t[0]);let e=this.defaultBB.width,i=this.defaultBB.height;if(Math.sqrt(e*e+i*i)>this.config.maxSizePx&&this.config.chibiId.includes("enemy_")){console.log("Resizing actor to "+this.config.maxSizePx);let s=e/i,n=0,a=0;i>e?(n=s*this.config.maxSizePx,a=this.config.maxSizePx):(n=this.config.maxSizePx,a=this.config.maxSizePx/s);let r=n*this.config.scaleX/e,o=a*this.config.scaleY/i;this.config.defaultScaleX=this.config.scaleX,this.config.defaultScaleY=this.config.scaleY,this.config.scaleX=r,this.config.scaleY=o,this.scale.x=Math.sign(this.scale.x)*this.config.scaleX,this.scale.y=Math.sign(this.scale.y)*this.config.scaleY,this.setAnimationState(t),this.recordAnimation(t[0])}}setAnimationState(t){let e=t[0];this.animViewport=this.calculateAnimationViewport(e),this.defaultBB=this.getDefaultBoundingBox(),this.animationState.timeScale=this.config.animationPlaySpeed,this.animationState.clearTracks(),this.skeleton.setToSetupPose(),this.animationState.setAnimation(0,e,!0);let i=null;for(let e=1;e<t.length;e++)i=this.animationState.addAnimation(0,t[e],!1,0);i&&this.animationState.addListener({start:(t=>{this.recordAnimation(t.animation.name)}).bind(this),interrupt:function(t){},end:function(t){},complete:(s=>{if(null==s.next){this.animationState.setAnimation(0,e,!0);for(let e=1;e<t.length;e++)i=this.animationState.addAnimation(0,t[e],!1,0)}}).bind(this),dispose:function(t){},event:function(t,e){}})}getDefaultBoundingBox(){let t=this.skeleton.data.animations,e=new P,i=new P,s=0;for(let n=0,a=t.length;n<a;n++){let a=t[n].name,r=this.skeleton.data.findAnimation(a);this.animationState.clearTracks(),this.skeleton.setToSetupPose(),this.animationState.setAnimationWith(0,r,!0);let o=this.skeleton.x,l=this.skeleton.y;this.skeleton.x=0,this.skeleton.y=0,this.skeleton.scaleX=Math.abs(this.config.scaleX),this.skeleton.scaleY=Math.abs(this.config.scaleY),this.animationState.update(0),this.animationState.apply(this.skeleton),this.skeleton.updateWorldTransform();let h=new P,c=new P;this.skeleton.getBounds(h,c),this.skeleton.x=o,this.skeleton.y=l,Number.isFinite(h.x)&&Number.isFinite(h.y)&&Number.isFinite(c.x)&&Number.isFinite(c.y)&&(s+=1,e.x+=h.x,e.y+=h.y,i.x+=c.x,i.y+=c.y)}e.x/=s,e.y/=s,i.x/=s,i.y/=s;let n={x:e.x,y:e.y,width:i.x,height:i.y};return this.config.chibiId.includes("enemy_")&&n.y<-15&&(this.config.extraOffsetY=-n.y),n}calculateAnimationViewport(t){let e=this.skeleton.data.findAnimation(t);this.animationState.clearTracks(),this.skeleton.setToSetupPose(),this.animationState.setAnimationWith(0,e,!0);let i=e.duration>0?e.duration/100:0,s=1e8,n=-1e8,a=1e8,r=-1e8,o=new P,l=new P,h=this.skeleton.x,c=this.skeleton.y;for(var d=0;d<100;d++)this.animationState.update(i),this.animationState.apply(this.skeleton),this.skeleton.x=0,this.skeleton.y=0,this.skeleton.scaleX=Math.abs(this.config.scaleX),this.skeleton.scaleY=Math.abs(this.config.scaleY),this.skeleton.updateWorldTransform(),this.skeleton.getBounds(o,l),s=Math.min(o.x,s),n=Math.max(o.x+l.x,n),a=Math.min(o.y,a),r=Math.max(o.y+l.y,r);return this.skeleton.x=h,this.skeleton.y=c,o.x=s,o.y=a,l.x=n-s,l.y=r-a,{x:o.x,y:o.y,width:l.x,height:l.y}}}class Te{snaps;snapPercentage;big;slider;value;knob;change;constructor(t=0,e=.1,i=!1){this.snaps=t,this.snapPercentage=e,this.big=i}render(){this.slider=Ve(`\n\t\t\t\t<div class="spine-player-slider ${this.big?"big":""}">\n\t\t\t\t\t<div class="spine-player-slider-value"></div>\n\t\t\t\t\t\x3c!--<div class="spine-player-slider-knob"></div>--\x3e\n\t\t\t\t</div>\n\t\t\t`),this.value=ke(this.slider,"spine-player-slider-value")[0],this.setValue(0);let t=new Jt(this.slider);var e=!1;return t.addListener({down:(t,i)=>{e=!0,this.value.classList.add("hovering")},up:(t,i)=>{e=!1;let s=t/this.slider.clientWidth;s=s=Math.max(0,Math.min(s,1)),this.setValue(t/this.slider.clientWidth),this.change&&this.change(s),this.value.classList.remove("hovering")},moved:(t,i)=>{if(e){let e=t/this.slider.clientWidth;e=Math.max(0,Math.min(e,1)),e=this.setValue(t/this.slider.clientWidth),this.change&&this.change(e)}},dragged:(t,e)=>{let i=t/this.slider.clientWidth;i=Math.max(0,Math.min(i,1)),i=this.setValue(t/this.slider.clientWidth),this.change&&this.change(i)}}),this.slider}setValue(t){if(t=Math.max(0,Math.min(1,t)),this.snaps>0){let e=t%(1/this.snaps);e<1/this.snaps*this.snapPercentage?t-=e:e>1/this.snaps-1/this.snaps*this.snapPercentage&&(t=t-e+1/this.snaps),t=Math.max(0,Math.min(1,t))}return this.value.style.width=100*t+"%",t}}class Ce{static HOVER_COLOR_INNER=new R(.478,0,0,.25);static HOVER_COLOR_OUTER=new R(1,1,1,1);static NON_HOVER_COLOR_INNER=new R(.478,0,0,.5);static NON_HOVER_COLOR_OUTER=new R(1,0,0,.8);sceneRenderer;dom;playerControls;canvas;textCanvas;textCanvasContext;timelineSlider;playButton;context;loadingScreen;assetManager;paused=!1;actors=new Map;playerConfig=null;parent;stopRequestAnimationFrame=!1;lastRequestAnimationFrameId=0;windowFpsFrameCount=0;webSocket=null;renderCallbacks=[];constructor(t,e){this.parent="string"==typeof t?document.getElementById(t):t,this.playerConfig=this.validatePlayerConfig(e),this.parent.appendChild(this.setupDom())}setWebsocket(t){this.webSocket=t}validatePlayerConfig(t){if(!t)throw new Error("Please pass a configuration to new.SpinePlayer().");return t.alpha||(t.alpha=!1),t.backgroundColor||(t.backgroundColor="#000000"),t.fullScreenBackgroundColor||(t.fullScreenBackgroundColor=t.backgroundColor),void 0===t.showControls&&(t.showControls=!0),t.runtimeDebugInfoDumpIntervalSec||(t.runtimeDebugInfoDumpIntervalSec=60),t}validateActorConfig(t){if(!t)throw new Error("Please pass a configuration to new.SpinePlayer().");if(!t.jsonUrl&&!t.skelUrl)throw new Error("Please specify the URL of the skeleton JSON or .skel file.");if(!t.atlasUrl)throw new Error("Please specify the URL of the atlas file.");if(void 0===t.premultipliedAlpha&&(t.premultipliedAlpha=!0),t.scaleX||(t.scaleX=1),t.scaleY||(t.scaleY=1),t.extraOffsetX||(t.extraOffsetX=0),t.extraOffsetY||(t.extraOffsetY=0),t.success||(t.success=(t,e)=>{}),t.error||(t.error=(t,e,i)=>{}),t.animation_listener||(t.animation_listener={event:function(t,e){},complete:function(t){},start:function(t){},end:function(t){},interrupt:function(t){},dispose:function(t){}}),t.skins&&t.skin&&t.skins.indexOf(t.skin)<0)throw new Error("Default skin '"+t.skin+"' is not contained in the list of selectable skins "+Ne(JSON.stringify(t.skins))+".");return void 0===t.defaultMix&&(t.defaultMix=.25),t}showError(t,e){let i=ke(this.dom,"spine-player-error")[0];i.classList.remove("spine-player-hidden"),i.innerHTML=`<p style="text-align: center; align-self: center;">${e}</p>`,t.config.error(this,t,e)}hideError(){ke(this.dom,"spine-player-error")[0].classList.add("spine-player-hidden")}setupDom(){let t=this.dom=Ve('\n\t\t\t\t<div class="spine-player">\n\t\t\t\t\t<div class="spine-player-error spine-player-hidden"></div>\n\t\t\t\t\t<canvas id="spine-canvas" class="spine-player-canvas"></canvas>\n\t\t\t\t\t<canvas id="spine-text" class="spine-player-text-canvas"></canvas>\n\t\t\t\t\t<div class="spine-player-controls spine-player-popup-parent spine-player-controls-hidden">\n\t\t\t\t\t\t<div class="spine-player-timeline">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="spine-player-buttons">\n\t\t\t\t\t\t\t<button id="spine-player-button-play-pause" class="spine-player-button spine-player-button-icon-pause"></button>\n\t\t\t\t\t\t\t<div class="spine-player-button-spacer"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t');try{this.canvas=Pe(t,"spine-canvas")[0],this.textCanvas=Pe(t,"spine-text")[0],this.textCanvasContext=this.textCanvas.getContext("2d");var e={alpha:this.playerConfig.alpha};this.context=new v(this.canvas,e),this.sceneRenderer=new fe(this.canvas,this.context,!0),this.loadingScreen=new we(this.sceneRenderer)}catch(e){return console.log("Sorry, your browser does not support WebGL.<br><br>Please use the latest version of Firefox, Chrome, Edge, or Safari."),t}this.configurePerspectiveCamera(this.playerConfig.viewport),this.assetManager=new M(this.context),this.lastRequestAnimationFrameId=requestAnimationFrame((()=>this.drawFrame())),performance.mark("fps_window_start"),this.windowFpsFrameCount=0,this.playerConfig.runtimeDebugInfoDumpIntervalSec>0&&setInterval((()=>this.callbackSendRuntimeUpdateInfo()),1e3*this.playerConfig.runtimeDebugInfoDumpIntervalSec),this.playerControls=ke(t,"spine-player-controls")[0];let i=ke(t,"spine-player-timeline")[0];return this.timelineSlider=new Te,i.appendChild(this.timelineSlider.render()),this.playButton=Pe(t,"spine-player-button-play-pause")[0],this.playButton.onclick=()=>{this.paused?this.play():this.pause()},window.onresize=()=>{this.drawFrame(!1)},this.setupInput(),t}callbackSendRuntimeUpdateInfo(){performance.mark("fps_window_end");const t=performance.measure("fps_window_time","fps_window_start","fps_window_end"),e=this.windowFpsFrameCount/(t.duration/1e3);if(null!=this.webSocket){const t=JSON.stringify({type_name:"RUNTIME_DEBUG_UPDATE",average_fps:e});this.webSocket.send(t)}performance.mark("fps_window_start"),this.windowFpsFrameCount=0}changeOrAddActor(t,e){if(this.actors.has(t)){let i=this.actors.get(t);i.ResetWithConfig(e),this.setupActor(i)}else{let i=new Ie(e,this.playerConfig.viewport);this.setupActor(i),this.actors.set(t,i)}}getActor(t){return this.actors.get(t)}getActorNames(){return Array.from(this.actors.keys())}removeActor(t){this.actors.delete(t)}setupActor(t){let e=t.config;try{t.config=this.validateActorConfig(t.config)}catch(e){return void this.showError(t,e)}if(e.rawDataURIs)for(let t in e.rawDataURIs){let i=e.rawDataURIs[t];this.assetManager.setRawDataURI(t,i)}e.jsonUrl?this.assetManager.loadText(e.jsonUrl):this.assetManager.loadBinary(e.skelUrl),this.assetManager.loadTextureAtlas(e.atlasUrl),e.backgroundImage&&e.backgroundImage.url&&this.assetManager.loadTexture(e.backgroundImage.url)}drawText(t,e,i){let s=this.playerConfig.viewport,n=this.sceneRenderer.camera.worldToScreen(new Ct(e,i,0)),a=new P(n.x,n.y);a.y=s.height-a.y,e=a.x,i=a.y;let r=this.textCanvasContext;r.save(),r.translate(e,i),r.font=this.playerConfig.textSize+"px "+this.playerConfig.textFont,r.textBaseline="bottom";let o=r.measureText(t),l=o.actualBoundingBoxAscent-o.actualBoundingBoxDescent,h=o.width;r.beginPath(),r.fillStyle="black",r.fillRect(-h/2-5,5,h+10,-l-10),r.fill(),r.fillStyle="white",r.fillText(t,-h/2,0),r.restore()}getPerspectiveCameraZOffset(t,e,i,s){let n=t.width,a=t.height,r=new Ht(n,a);return r.near=e,r.far=i,r.fov=s,r.zoom=1,r.position.x=0,r.position.y=0,r.position.z=0,r.update(),n/2*-r.projectionView.values[Pt]}configurePerspectiveCamera(t){let e=this.sceneRenderer.camera;e.near=this.playerConfig.cameraPerspectiveNear,e.far=this.playerConfig.cameraPerspectiveFar,e.zoom=1,e.position.x=0,e.position.y=t.height/2,e.position.z=-this.getPerspectiveCameraZOffset(t,e.near,e.far,e.fov),e.direction=new Ct(0,0,-1),e.update()}updateCameraSettings(t,e){let i=this.sceneRenderer.camera;i.position.x=0,i.position.y=e.height/2,i.position.z=-this.getPerspectiveCameraZOffset(e,i.near,i.far,i.fov)+t.getPositionZ(),i.direction=new Ct(0,0,-1),i.update()}drawFrame(t=!0){t&&!this.stopRequestAnimationFrame&&(this.lastRequestAnimationFrameId=requestAnimationFrame((()=>this.drawFrame())));let e=this.context.gl;var i=document,s=i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement;let n=(new R).setFromString(s?this.playerConfig.fullScreenBackgroundColor:this.playerConfig.backgroundColor);e.clearColor(n.r,n.g,n.b,n.a),e.clear(e.COLOR_BUFFER_BIT),this.textCanvas.width=this.textCanvas.clientWidth,this.textCanvas.height=this.textCanvas.clientHeight,this.textCanvasContext.clearRect(0,0,this.textCanvas.width,this.textCanvas.height),this.sceneRenderer.resize(re.Expand);let a=Array.from(this.actors.keys()).sort(((t,e)=>{let i=this.actors.get(t),s=this.actors.get(e),n=s.getPositionZ()-i.getPositionZ();return 0==n?i.loadedWhen-s.loadedWhen:n})),r=!0;for(let t of a){let e=this.actors.get(t);if(e.load_perma_failed)continue;if(this.assetManager.isLoadingComplete()&&null==e.skeleton&&this.loadSkeleton(e),!e.loaded){r=!1;continue}let i=this.playerConfig.viewport;if(!e.paused&&e.GetAnimations().length>0){e.time.update();let t=e.time.delta*e.speed,s=e.animationState.getCurrent(0).animation.duration;for(e.playTime+=t;e.playTime>=s&&0!=s;)e.playTime-=s;e.playTime=Math.max(0,Math.min(e.playTime,s)),this.timelineSlider.setValue(e.playTime/s),e.UpdatePhysics(t,i),e.skeleton.setToSetupPose(),e.animationState.update(t),e.animationState.apply(e.skeleton)}if(e.skeleton.updateWorldTransform(),this.updateCameraSettings(e,i),this.sceneRenderer.begin(),e.config.backgroundImage&&e.config.backgroundImage.url){let t=this.assetManager.get(e.config.backgroundImage.url);e.config.backgroundImage.hasOwnProperty("x")&&e.config.backgroundImage.hasOwnProperty("y")&&e.config.backgroundImage.hasOwnProperty("width")&&e.config.backgroundImage.hasOwnProperty("height")?this.sceneRenderer.drawTexture(t,e.config.backgroundImage.x,e.config.backgroundImage.y,e.config.backgroundImage.width,e.config.backgroundImage.height):this.sceneRenderer.drawTexture(t,i.x,i.y,i.width,i.height)}if(this.sceneRenderer.drawSkeleton(e.skeleton,e.config.premultipliedAlpha),this.drawText(e.config.userDisplayName,e.getPositionX(),e.getPositionY()-Math.abs(e.animViewport.y)+e.GetUsernameHeaderHeight()),this.sceneRenderer.end(),this.playerConfig.viewport.debugRender){this.sceneRenderer.begin();let t=e.getPosition();e.scale.x>0?this.sceneRenderer.rect(!1,t.x+e.animViewport.x,t.y+e.animViewport.y,e.animViewport.width,e.animViewport.height,R.BLUE):this.sceneRenderer.rect(!1,t.x-(e.animViewport.width+e.animViewport.x),t.y+e.animViewport.y,e.animViewport.width,e.animViewport.height,R.GREEN),this.sceneRenderer.rect(!1,t.x+e.defaultBB.x,t.y+e.defaultBB.y,e.defaultBB.width,e.defaultBB.height,R.ORANGE),this.sceneRenderer.circle(!0,t.x,t.y,10,R.RED),this.sceneRenderer.end()}}this.broadcastRenderCallback(),r&&(this.assetManager.clearErrors(),this.hideError()),this.windowFpsFrameCount+=1}registerRenderCallback(t){return this.renderCallbacks.push(t),()=>{this.renderCallbacks=this.renderCallbacks.filter((e=>e!==t))}}broadcastRenderCallback(){for(let t=0;t<this.renderCallbacks.length;t++)this.renderCallbacks[t](this.context)}scale(t,e,i,s){let n=s/i>e/t?i/t:s/e,a=new P;return a.x=t*n,a.y=e*n,a}loadSkeleton(t){if(t.loaded||t.load_perma_failed)return;if(this.assetManager.hasErrors())return void this.showError(t,"Error: assets could not be loaded.<br><br>"+Ne(JSON.stringify(this.assetManager.getErrors())));let e,i=this.assetManager.get(t.config.atlasUrl);if(t.config.jsonUrl){let s=this.assetManager.get(t.config.jsonUrl),n=new It(new X(i));try{e=n.readSkeletonData(s)}catch(e){return void this.showError(t,"Error: could not load skeleton .json.<br><br>"+Ne(JSON.stringify(e)))}}else{let s=this.assetManager.get(t.config.skelUrl),n=new Et(new X(i));try{e=n.readSkeletonData(s)}catch(e){return void this.showError(t,"Error: could not load skeleton .skel.<br><br>"+Ne(JSON.stringify(e)))}}if(t.skeleton=new J(e),t.config.skin||e.skins.length>0&&(t.config.skin=e.skins[0].name),t.config.skins&&t.config.skin.length>0&&t.config.skins.forEach((e=>{t.skeleton.data.findSkin(e)||this.showError(t,`Error: skin '${e}' in selectable skin list does not exist in skeleton.`)})),t.config.skin){if(!t.skeleton.data.findSkin(t.config.skin))return void this.showError(t,`Error: skin '${t.config.skin}' does not exist in skeleton.`);t.skeleton.setSkinByName(t.config.skin),t.skeleton.setSlotsToSetupPose()}t.InitAnimationState(),t.config.success(this,t),t.loaded=!0}cancelId=0;setupInput(){let t=this.canvas;new Jt(t).addListener({down:(t,e)=>{},dragged:(t,e)=>{},moved:(t,e)=>{},up:(t,e)=>{this.playerConfig.showControls&&(this.paused?this.play():this.pause())}});var e=!0,i=!1;document.addEventListener("mousemove",(t=>{t instanceof MouseEvent&&s(t.clientX,t.clientY)})),document.addEventListener("touchmove",(t=>{if(t instanceof TouchEvent){var e=t.changedTouches;if(e.length>0){var i=e[0];s(i.clientX,i.clientY)}}}));let s=(t,s)=>{if(!this.playerConfig.showControls)return;let a=ke(this.dom,"spine-player-popup");if(e=n(t,s,this.playerControls.getBoundingClientRect()),i=n(t,s,this.canvas.getBoundingClientRect()),clearTimeout(this.cancelId),0!=a.length||e||i||this.paused?this.playerControls.classList.remove("spine-player-controls-hidden"):this.playerControls.classList.add("spine-player-controls-hidden"),!e&&0==a.length&&!this.paused){let t=()=>{this.paused||this.playerControls.classList.add("spine-player-controls-hidden")};this.cancelId=setTimeout(t,1e3)}},n=(t,e,i)=>{let s=t-i.left,n=e-i.top;return s>=0&&s<=i.width&&n>=0&&n<=i.height}}play(){this.paused=!1,this.cancelId=setTimeout((()=>{this.paused||this.playerControls.classList.add("spine-player-controls-hidden")}),1e3),this.playButton.classList.remove("spine-player-button-icon-play"),this.playButton.classList.add("spine-player-button-icon-pause");for(let[t,e]of this.actors)e.paused=!1,e.animationState&&(e.animationState.getCurrent(0)||e.InitAnimations())}pause(){this.paused=!0,this.playerControls.classList.remove("spine-player-controls-hidden"),clearTimeout(this.cancelId),this.playButton.classList.remove("spine-player-button-icon-pause"),this.playButton.classList.add("spine-player-button-icon-play");for(let[t,e]of this.actors)e.paused=!0}getSceneRenderer(){return this.sceneRenderer}}function Pe(t,e){let i=new Array,s=(t,e,i)=>{for(var n=0;n<t.children.length;n++){let a=t.children[n];a.id===e&&i.push(a),s(a,e,i)}};return s(t,e,i),i}function ke(t,e){let i=new Array,s=(t,e,i)=>{for(var n=0;n<t.children.length;n++){let a=t.children[n];a.classList.contains(e)&&i.push(a),s(a,e,i)}};return s(t,e,i),i}function Ve(t){let e=document.createElement("div");return e.innerHTML=t,e.children[0]}function Ne(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&#34;").replace(/'/g,"&#39;"):""}class Le{socket;spinePlayer;spinePlayerConfig;actorConfig;defaultBackoffTimeMsec;backoffTimeMsec;backOffMaxtimeMsec;channelName;runtimeConfig;constructor(t,e){this.runtimeConfig=e;const{width:i,height:s,debugMode:n,chibiScale:a}=e;let r=new FontFace("lato","url(/public/fonts/Lato/Lato-Black.ttf)");r.load().then((()=>{document.fonts.add(r)})),this.channelName=t,this.socket=null,this.spinePlayer=null,this.defaultBackoffTimeMsec=15e3,this.backoffTimeMsec=15e3,this.backOffMaxtimeMsec=3e5,this.openWebSocket(this.channelName),null==this.spinePlayer&&(this.spinePlayerConfig={backgroundColor:"#00000000",alpha:!0,showControls:!0,viewport:{x:0,y:0,width:i,height:s,padLeft:0,padRight:0,padTop:0,padBottom:0,debugRender:n},fullScreenBackgroundColor:null,backgroundImage:null,textSize:14,textFont:"lato",runtimeDebugInfoDumpIntervalSec:60,cameraPerspectiveNear:1,cameraPerspectiveFar:2e3},console.log("Creating a new spine player"),this.spinePlayer=new Ce("container",this.spinePlayerConfig))}openWebSocket(t){const e=("https:"===window.location.protocol?"wss:":"ws:")+"//"+location.host+`/ws/?channelName=${t}`;console.log("Openning websocket"),this.socket=new WebSocket(e),this.socket.addEventListener("open",(t=>{console.log("Socket opened"),this.backoffTimeMsec=this.defaultBackoffTimeMsec,this.spinePlayer.setWebsocket(this.socket)})),this.socket.addEventListener("message",this.messageHandler.bind(this)),this.socket.addEventListener("close",(t=>{console.log("Close received: ",t),this.spinePlayer.setWebsocket(null),this.backoffTimeMsec*=2,this.backoffTimeMsec<this.backOffMaxtimeMsec&&(console.log("Retrying in "+this.backoffTimeMsec+"ms"),setTimeout((()=>this.openWebSocket(this.channelName)),this.backoffTimeMsec))})),this.socket.addEventListener("error",(t=>{console.log("Error received: ",t)}))}messageHandler(t){let e=JSON.parse(t.data);console.log("Message received: ",e),"SET_OPERATOR"==e.type_name?this.swapCharacter(e):"REMOVE_OPERATOR"==e.type_name&&this.removeCharacter(e)}swapCharacter(t){let e=t.user_name,i=null,s=null;null!=t.start_pos&&(i=t.start_pos.x,s=t.start_pos.y);let n=1,a=1;null!=t.sprite_scale&&(n=t.sprite_scale.x,a=t.sprite_scale.y);let r=350;null!=t.max_sprite_pixel_size&&(r=t.max_sprite_pixel_size);let o=80,l=80;null!=t.movement_speed_px&&(o=t.movement_speed_px),null!=t.movement_speed_py&&(o=t.movement_speed_py),null!=t.movement_speed_pz&&(l=t.movement_speed_pz);let h=null,c=null,d=l;null!=t.movement_speed&&(h=Math.floor(t.movement_speed.x*o),c=Math.floor(80*t.movement_speed.y));let u=o,m=l;this.actorConfig={chibiId:t.operator_id,userDisplayName:t.user_name_display,skelUrl:t.skel_file,atlasUrl:t.atlas_file,startPosX:i,startPosY:s,defaultMovementSpeedPxX:u,defaultMovementSpeedPxY:80,defaultMovementSpeedPxZ:m,movementSpeedPxX:h,movementSpeedPxY:c,movementSpeedPxZ:d,configScaleX:n,configScaleY:a,scaleX:.45*this.runtimeConfig.chibiScale*n,scaleY:.45*this.runtimeConfig.chibiScale*a,maxSizePx:r,premultipliedAlpha:!0,animationPlaySpeed:t.animation_speed?t.animation_speed:1,extraOffsetX:0,extraOffsetY:0,action:t.action,action_data:t.action_data,success:(t,e)=>{},error:(t,e,i)=>{e.load_attempts+=1,e.load_attempts>e.max_load_attempts&&(e.load_perma_failed=!0),console.log(this),console.log(i)}},this.spinePlayer.changeOrAddActor(e,this.actorConfig)}removeCharacter(t){this.spinePlayer&&this.spinePlayer.removeActor(t.user_name)}}},169:(t,e,i)=>{function s(t){const e="true"===t.get("debug"),i=Math.max(Math.min(parseFloat(t.get("scale"))||1,3),.1),[s,n]=function(t){let e=t.has("width")?Number.parseInt(t.get("width")):1920,i=t.has("height")?Number.parseInt(t.get("height")):1080,s=document.getElementById("container");return Number.isInteger(e)||(e=1920),Number.isInteger(i)||(i=1080),e=Math.max(e,0),i=Math.max(i,0),console.log(e,i),s.style.width=`${e}px`,s.style.height=`${i}px`,[e,i]}(t);return{width:s,height:n,debugMode:e,chibiScale:i}}i.d(e,{T:()=>s})}}]);
//# sourceMappingURL=3.33ce260387ac55671d21.js.map